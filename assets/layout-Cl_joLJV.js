import{r,j as e,c as Fn}from"./index-BNCXs9B3.js";import{A as zt,S as Gn,D as Vn,B as Yn}from"./booth_item-D7-h2gHM.js";import{I,E as qe,G as ue,z as Zn,H as f,V as qt,J as F,K as $,T as ve,D as Mt,L as Et,B as Pe,M as je,N as We,k as Jn,n as Un,O as Hn,P as ct,Q as Xn,R as Qn,U as zn,W as qn,A as $n,X as Kn}from"./firestore-DnikGjYO.js";import{F as rt}from"./forward-An_qFV6V.js";import{I as _n,L as el,T as tl}from"./inventory_item_tile-dj6osfPl.js";const $t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE02lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTE2PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmRiZTM1YTM5LWE0MDUtNDM2MC04YzRjLWI3NmJmMTY3Mjc1YjwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5hZGQtaXRlbSAtIDc8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOnBkZj0naHR0cDovL25zLmFkb2JlLmNvbS9wZGYvMS4zLyc+CiAgPHBkZjpBdXRob3I+U2FyYWggS2VtbWVOYXNoPC9wZGY6QXV0aG9yPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczp4bXA9J2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8nPgogIDx4bXA6Q3JlYXRvclRvb2w+Q2FudmEgKFJlbmRlcmVyKSBkb2M9REFHdTJ5dUVOWkEgdXNlcj1VQUZqR1c2eHRDUSBicmFuZD1bQVJDSElWRURdIEZvcnQgV2F5bmUgQ29tbXVuaXR5IFNjaG9vbHMgdGVtcGxhdGU9PC94bXA6Q3JlYXRvclRvb2w+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0ncic/PupmVZwAAAT8SURBVHic7d1PaBxVHMDxX41Wh6DsE1FcweGltiAUpE7Vanm9BGzGqvGgJ9e/bRSliHrwkIueiif/gShkVFRGLCbR4p8ulSBMEEul7+rJF6jgXqQTFSEiK15m4yTZze7MvJn3m5nf95p9+xv4MLOZycxmB1Co2mF6A6iNEQiyCARZBIIsAkEWgSCLQJBFIMgiEGQRCLIIBFkEgiwCGVCDi7GJydnjbOLQEQC4AQBUqAJfeu6nec4lkD41uLjcmWl/AQBTm38WquAd6bnP5jV7LK83LmsRxucA4Pb7ucXs2xgX13ek/1Ue8wkk1jCMXhaz9zMurutI/2vd20AgUQ0udkaHqW0xekV7yrUd6X+jczsIBNYxFgDgSJJ1Eco1Hemf1rUttQeJYdybZr3F7NsZF1d3pN/WsT21BmlwcZkz016ElBi9LGbfwbhgOlBqDXLwpZ8WAeB+He9lMfsA4+KqjvTPZHmfWoMwLpoWsw/rej+L2XcyLq7MglJrkI70f2Bc/KkZ5S7GxXhH+t+mWV9rEIB1lD80oxxkXFzsSP9c0rW1BwEA6Ej/LOPid4vZWy6VpM1i9oFQLb+2tnrh3yTrLtG1AZhrcLFz8sRfLze4sAa9RnruG6EKXtQ4lrEJsTfposqDROcZ8wDwijPT/rLBxRWDXis99/VQBc9rHP930gWVvto74KTvzPm5qenVleW1QetuPXb6OTZx6M2M439Zmh2/Memiyu4hsT1j80nf3c5M+9SQPeWtUAUvZJmf9vBXyQ/12J5x34CX7Go6rf2hWp5fW73Q7feC6IP+osXskS42xgtV8LT03I+TrgOoIEiCa1M3NZ2WMwTlHOPiN4vZ94w6P1TBU9Jz55Jsc7xKgaS4ULh7BJQfR0UJVXBUeu57SbZ5c5UByXDVdnfTae3LihKq4EnpuR8knL2lSoBkvYQOAHsilIUUKN1QBY9Jz/0o5ewNlR5EA0avNCjdUAWPSs/1M85er9QgGjF67Wk6rVsilL6XPGIoh0MVPKz7tqDSnhjGzjMG/WqbpVPn56YeWl1Z/mfQC/jk7K6VpRM/6x5cSpAc9ox+DUXJo9KdqReEAQAw7cy0Tza4uDTnORsq1WdIgRi9bm46rb2hWl5Mehk9baU5ZEU3JMyDpr+BJ2xhaXb8wSIGleKQFWF8BmYwIFTBd0XNQr+HxDCmTcwPVXBceu7bRc1DDVI3DADEIHXEAEAKUlcMAIQgdcYAQAZSdwwARCAIMJ6RnvuuidnxUIAQxv8ZByGMjRkFIYytGQMhjP4ZASGMwRUOQhjbVygIAoxMN7EVUWEghDFahYAQxujlDkIYycoVhDCSlxsIYaQrFxDCSJ92EAQYx7I+EmAyrSAIMI5Kz33fxGxdaQMhDD1pASEMfWUGIQy9ZQIhDP2lBiGMfEoFggBDywOWGEsM0uBiLLoL/YEctmdooQoel577oYnZRZT47nc2IfaBOYwnqowBAJDm6SAjjzBUfc/oVYrnQ+qCAVACkDphACAHqRsGAF6QbqiCR+qGAZDuQz3vel9X8YnpDTERtj2k1hgAuEBqjwGAB4QwojCAEEYs0yCEsSmTv2V1QxW08v43dGXLFEg3+vKvk4bmo83EIYswtinNHvIrALyadmCogu+l5+byPwCrkPGHPqmNEQiyCARZBIIsAkEWgSCLQJBFIMgiEGQRCLIIBFkEgqz/ADvdpRk/dmKqAAAAAElFTkSuQmCC";function nl({inventoryItem:c,addDraggingItem:D,removeItem:P,setSelectedItem:x,tapAndPlaceMode:v,canEditItem:E,onEditItem:N}){const T=r.useRef(null),C=r.useRef(null),[b,R]=r.useState(12),[k,G]=r.useState(c.item),[y,X]=r.useState(!1);function Y(W){const le=C.current,M=window.getComputedStyle(le),Z=document.createElement("span");Z.style.font=M.font,Z.style.fontSize=W+"px",Z.style.fontFamily=M.fontFamily,Z.style.fontWeight=M.fontWeight,Z.style.position="absolute",Z.style.visibility="hidden",Z.style.whiteSpace="nowrap",Z.textContent=le.textContent,document.body.appendChild(Z);const _=Z.offsetWidth;return document.body.removeChild(Z),_}function L(W){if(C.current){const le=C.current;return Y(W-1)>le.offsetWidth&&W-1>8?L(W-1):W-1}return W}r.useEffect(()=>{setTimeout(()=>{C.current&&R(L(b))},100)},[]);const w=r.useCallback(()=>{if(console.log("MOUSE MOVE",y),y){if(X(!1),v)return;c.item.initialElement=T.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",c.item.id,"to initialElement",c.item.initialElement),G(new I({...c.item})),D(c.item),window.removeEventListener("mousemove",w),window.removeEventListener("touchmove",w)}},[y,v]);return r.useEffect(()=>(y?(window.addEventListener("touchmove",w),window.addEventListener("mousemove",w)):(window.removeEventListener("touchmove",w),window.removeEventListener("mousemove",w)),()=>{window.removeEventListener("touchmove",w),window.removeEventListener("mousemove",w)}),[y,w]),e.jsxs("div",{className:"display",children:[e.jsx("div",{ref:T,id:c.item.id,className:c.item.isSectionItem?"display-section":`display-item ${c.item.isSectionModifier?c.item.sectionModifierType.toString():""}`,style:{width:`${c.item.cellsLong*10}px`,height:`${c.item.cellsTall*10}px`},onMouseDown:W=>{X(!0)},onMouseUp:()=>{console.log("MOUSE UP"),X(!1)},onClick:W=>{if(!v){W.preventDefault(),W.stopPropagation();return}console.log("CLICKED ON ITEM",c.item.id,"with tap and place mode"),W.preventDefault(),W.stopPropagation(),c.item.initialElement=T.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),x(c.item)},onTouchStart:W=>{v||(W.preventDefault(),W.stopPropagation(),c.item.initialElement=T.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",c.item.id,"to initialElement",c.item.initialElement),G(new I({...c.item})),D(c.item))},children:c.item.isSectionModifier?c.item.sectionModifierType==="LeftDoor"||c.item.sectionModifierType==="RightDoor"?e.jsx("img",{src:c.item.icon,alt:"icon"}):null:c.item.icon.includes("custom-")?e.jsx("div",{className:c.item.isSectionItem?"custom-section":"custom-icon",children:e.jsx("div",{children:e.jsx("p",{ref:C,style:{fontSize:`${b}px`},children:c.item.icon.split("custom-")[1]})})}):e.jsx("img",{src:c.item.icon,alt:"icon"})}),e.jsx("p",{children:c.item.name}),c.quantity>0&&e.jsxs("p",{className:"quantity",children:["x",c.quantity]}),E&&e.jsx("img",{src:$t,alt:"Edit",className:"edit-icon",onClick:()=>N(c)})]})}const Kt="/assets/plus.circle-Ce3xm00a.png";function ll({inventoryItems:c,addDraggingItem:D,maxHeight:P,removeItem:x,showAddCustomItem:v,isCreatingTemplate:E,isEditingTemplate:N,isViewingDesign:T,tapAndPlaceMode:C,setSelectedItem:b,isModifyingSections:R,canEditItem:k,onEditItem:G}){return e.jsxs("div",{className:"toolbox",style:{maxHeight:P?`${P}px`:"200px"},children:[c.map(y=>e.jsx(nl,{canEditItem:k,onEditItem:G,setSelectedItem:b,tapAndPlaceMode:C,inventoryItem:y,addDraggingItem:D,removeItem:x})),!(E||N||T||R)&&e.jsx("div",{className:"add-item",onClick:()=>{v()},children:e.jsx("img",{src:Kt,alt:"Add Item"})})]})}function ol({dialogRef:c,closeDialog:D,areaPreview:P}){return e.jsx("dialog",{ref:c,className:"layout-dialog",children:e.jsxs("div",{className:"layout-dialog-div",children:[e.jsx("h2",{children:"Layout"}),e.jsx("img",{src:P,alt:"Layout preview",className:"layout-dialog-preview"}),e.jsx("br",{}),e.jsx("button",{className:"layout-dialog-close",onClick:D,children:"Close"})]})})}const sl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE2mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTAzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmE2MmM1Y2UxLTIzNTYtNGE3Ny1hNTAwLTViNWJjMjE1MDU3NzwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5VbnRpdGxlZCBkZXNpZ24gLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogIDxwZGY6QXV0aG9yPlNhcmFoIEtlbW1lTmFzaDwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcikgZG9jPURBR3UyeXVFTlpBIHVzZXI9VUFGakdXNnh0Q1EgYnJhbmQ9W0FSQ0hJVkVEXSBGb3J0IFdheW5lIENvbW11bml0eSBTY2hvb2xzIHRlbXBsYXRlPTwveG1wOkNyZWF0b3JUb29sPgogPC9yZGY6RGVzY3JpcHRpb24+CjwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9J3InPz7fMgZvAAADaElEQVR4nO3dO2gTAQDG8e8ujz6k6FBbUeOjKILV4CAiDgWxLqK4KM4dCuLiIIg6OQgibi5OgjgoDhZB7NIiIr6gCFFThIotaSsVtSJtadI87hykiKSNd/Uu9yX3/cZwyV3yv0fukYth27YNoWEGPQHyNwUhoyBkFISMgpBREDIKQkZByCgImajTAa88XMDTDyU/p8VXjTHg0vEGHNgeCXpSKnK8hNRyDADIFYCXI/zvwfESsujInig6N/i7prv+OO/puO6/LmB82kYtHLRzHSSZMNG9y/XTXFkMsjth4rAH4xpIFzE+XQs5tFGnoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMvwelVujU/iiGJy3s3cp9qNwPlEF6D8aDnoTAaJVFRkHIKAgZBSGjIGQUhIyCkFEQMgpCRkHIKAgZymNZfvkxZ+NtpsqXkxrAtnYTqxoMR4OHKsjQaAlDo9W/vndzq4FbvU2Ohg3FKqtzY7CH8TPfnV/GGoolpKcrhp6uWNXHO5Au4tqjvKvnhGIJqSUKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByFAGsSwgm6+N35V7jTLIubs5nLyRxdg3K+hJqTrKIOlJC7kCMDKlIBQW7yRsUk6dv0L4lrkpCBkFIeP6FO67CQslq1j2+I71Jra0qu//ch2kP1VEf6r88XgU6DvbhMa4s8tdZGmezdJrWwxEwvcbTc+5XkIuHIv7fke5MNNKn4yCkFEQMgpCRkHIUH9dujmYx+1nhbLHkwkT5482wKjDXR7qIDNZYCZbfqLqyWwJZ7pttDTVXxHqIMvdanzdGqMuYwDkQby61Xgt0UadTLhmv2XM5Wxc7lvA1E9vL6xYyYUaCgLg4xcLqQzH+XsFAZDcFMHpQzHML3j7up++Wnjh8k9kFARAxARO7PP+N4gD6aLrINqokwlsCUllSrj3qoBihRmoxLFar6rAgjwYKuLNWOVPfHaJvfR6F1iQnq4Ytrcvvca88/z38avVzfW5N15JYEE62kx0tFUOUo8HD/9FG3UyCkJGQcgoCBnPLiX1w/sJC1aVxuWH4c/ud6QM27Ydfdnvvjrv+sXlj8GLzY6Gc7zK2unzHxLXs2TC+WfneAmR6tBsT0ZByCgIGQUhoyBkFISMgpBREDIKQuYX+jTA4JQOFzkAAAAASUVORK5CYII=",il="/assets/template-Cjj8EPhc.png";function al({dialogRef:c,closeDialog:D,templates:P,isOpen:x,isViewingArea:v,selectTemplate:E,duplicateTemplate:N}){const[T,C]=r.useState(/Mobi|Android/i.test(navigator.userAgent)),[b,R]=r.useState([]),[k,G]=r.useState(!1),[y,X]=r.useState([]);return r.useEffect(()=>{X(P)},[P]),r.useEffect(()=>{if(x&&(console.log("Layout dialog opened, generating cells and sections",y),y.length!==0)){if(y.length==1){R([y[0].name]);return}R(T?[y[0].name]:[y[0].name,y[1].name])}},[x,y]),r.useEffect(()=>{const Y=y.filter(L=>b.includes(L.name));console.log("Viewing templates:",b),Y.sort((L,w)=>b.indexOf(L.name)-b.indexOf(w.name)),console.log("Generating templates for",Y.map(L=>L.name))},[b,y]),e.jsx(e.Fragment,{children:e.jsx("dialog",{ref:c,className:"template-dialog",children:e.jsxs("div",{className:"template-dialog-div",children:[e.jsx("h2",{children:"Templates"}),e.jsxs("div",{className:"templates",children:[y.length>1&&y.filter(Y=>!b.includes(Y.name)).length>0&&e.jsx("img",{src:rt,onClick:()=>{if(T){const L=(y.findIndex(w=>w.name===b[0])-1+y.length)%y.length;R([y[L].name])}else R(Y=>{const w=(y.findIndex(W=>W.name===Y[0])-1+y.length)%y.length;return[y[w].name,Y[0]]})},className:"back-mobile-areas"}),b.length===0&&e.jsx("div",{className:"no-templates",children:"No templates available"}),b.map(Y=>e.jsxs("div",{className:"template",children:[e.jsx("img",{src:y.find(L=>L.name===Y).previewImage,alt:Y,className:"template-preview"}),e.jsx("h3",{children:Y}),e.jsxs("div",{className:"template-actions",children:[e.jsx("button",{className:"template-select-btn",onClick:()=>{if(v){const L=new URLSearchParams(window.location.search),w=L.get("companyId"),W=L.get("areaId");window.location.href=`/Layout/?companyId=${w}&areaId=${W}&type=edit-template&templateId=${y.find(le=>le.name==Y).id}`}else D(),E&&E(y.find(L=>L.name===Y))},children:v?"Edit":"Select"}),v&&e.jsx("button",{className:"action-btn",onClick:()=>{k||(G(!0),N&&N(y.find(L=>L.name===Y)))},children:"Duplicate"}),v&&e.jsx("button",{className:"action-btn",onClick:()=>{if(k)return;G(!0);const L=y.filter(M=>M.name!==Y);X(L),L.length==1?R([L[0].name]):L.length==0?R([]):R(T?[L[0].name]:[L[0].name,L[1].name]);const w=new URLSearchParams(window.location.search),W=w.get("companyId"),le=w.get("areaId");qe(W,le,L).then(()=>{G(!1)})},children:"Delete"})]})]})),y.length>1&&y.filter(Y=>!b.includes(Y.name)).length>0&&e.jsx("img",{src:rt,onClick:()=>{if(T){const L=(y.findIndex(w=>w.name===b[0])+1)%y.length;R([y[L].name])}else R(Y=>{const w=(y.findIndex(W=>W.name===Y[Y.length-1])+1)%y.length;return[Y[1],y[w].name]})},className:"forward-mobile-areas"})]}),v&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"action-btn",onClick:()=>{const Y=new URLSearchParams(window.location.search),L=Y.get("companyId"),w=Y.get("areaId");window.location.href=`/Layout/?companyId=${L}&areaId=${w}&type=create-template`},children:"Create new Template"})," ",e.jsx("br",{})]}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:D,children:"Close"}),k&&x&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"loader"})})]})})})}function cl({dialogRef:c,closeDialog:D,addInventoryItem:P,canBeBooth:x}){const[v,E]=r.useState(""),[N,T]=r.useState(1),[C,b]=r.useState(1),[R,k]=r.useState(1),[G,y]=r.useState(!1);return e.jsx("dialog",{ref:c,className:"custom-item-dialog",children:e.jsxs("div",{className:"custom-item-dialog-div",children:[e.jsx("h2",{children:"Add Custom Item"}),e.jsxs("div",{className:"custom-item-row",children:[e.jsx("label",{htmlFor:"item-name",children:"Name:"}),e.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:X=>E(X.target.value??""),value:v})]}),e.jsxs("div",{className:"custom-item-row",children:[e.jsx("label",{htmlFor:"item-icon",children:"Count:"}),e.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:N,onChange:X=>T(parseInt(X.target.value)??1)})]}),e.jsxs("div",{className:"custom-item-row custom-item-size",children:[e.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),e.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:C,onChange:X=>b(parseFloat(X.target.value)??1)}),e.jsx("span",{children:" x "}),e.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:R,onChange:X=>k(parseFloat(X.target.value)??1)})]}),x?e.jsxs("div",{className:"custom-item-row",children:[e.jsx("label",{htmlFor:"is-booth",children:"Is Booth:"}),e.jsx("input",{type:"checkbox",id:"is-booth",name:"is-booth",checked:G,onChange:X=>y(X.target.checked)})]}):null,e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{if(v.trim()===""){alert("Item name cannot be empty");return}const X=new ue({quantity:N,item:new I({id:v+(Math.random()*1e4).toString(),name:v,icon:`custom-${v}`,cellsLong:Math.ceil(C),cellsTall:Math.ceil(R),moveable:!0,starterItem:!1,displayItem:!0,isBooth:G})});P(X),E(""),T(1),b(1),k(1),y(!1),D()},children:"Add Item"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{D(),E(""),T(1),b(1),k(1),y(!1)},children:"Close"})]})})}function rl({dialogRef:c,closeDialog:D,addSection:P}){const[x,v]=r.useState(""),[E,N]=r.useState(1),[T,C]=r.useState(1);return e.jsx("dialog",{ref:c,className:"section-dialog",children:e.jsxs("div",{className:"section-dialog-div",children:[e.jsx("h2",{children:"Add Section"}),e.jsxs("div",{className:"section-row",children:[e.jsx("label",{htmlFor:"section-name",children:"Name:"}),e.jsx("input",{type:"text",id:"section-name",name:"section-name",onChange:b=>v(b.target.value??""),value:x})]}),e.jsxs("div",{className:"section-row section-size",children:[e.jsx("label",{htmlFor:"section-width",children:"Size (in feet):"}),e.jsx("input",{type:"number",id:"section-width",name:"section-width",min:"1",value:E,onChange:b=>N(parseFloat(b.target.value)??1)}),e.jsx("span",{children:" x "}),e.jsx("input",{type:"number",id:"section-height",name:"section-height",min:"1",value:T,onChange:b=>C(parseFloat(b.target.value)??1)})]}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{if(x.trim()===""){alert("Section name cannot be empty");return}const b=new ue({quantity:1,item:new I({id:x+(Math.random()*1e4).toString(),name:x,icon:`custom-${x}`,cellsLong:Math.ceil(E),cellsTall:Math.ceil(T),moveable:!0,starterItem:!1,displayItem:!0,isSectionItem:!0})});P(b),v(""),N(1),C(1),D()},children:"Add Section"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:D,children:"Close"})]})})}function dl({dialogRef:c,closeDialog:D,addInventoryItem:P}){const[x,v]=r.useState(null),[E,N]=r.useState(""),[T,C]=r.useState(1),[b,R]=r.useState(1),[k,G]=r.useState(1),[y,X]=r.useState(!0),[Y,L]=r.useState([]);return r.useEffect(()=>{Zn(localStorage.getItem("companyId")||"").then(w=>{L(w)})},[]),e.jsx("dialog",{ref:c,className:"inventory-item-dialog",children:e.jsxs("div",{className:"inventory-item-dialog-div",children:[e.jsx("h2",{children:"Add Inventory Item"}),x==null?e.jsxs(e.Fragment,{children:["  ",e.jsx("label",{htmlFor:"",children:"Premade Items:"}),e.jsx("div",{className:"inventory-item-list",children:Y.map(w=>e.jsx(_n,{item:w,onSelect:()=>{const W=new ue({quantity:1,item:new I({id:w.name+(Math.random()*1e4).toString(),name:w.name,icon:w.icon,cellsLong:w.cellsLong,cellsTall:w.cellsTall,moveable:!0,starterItem:!1,displayItem:!0})});v(W)}},w.id))}),e.jsx("label",{htmlFor:"",children:"Or:"}),e.jsx("label",{htmlFor:"",children:"Custom Item:"}),e.jsxs("div",{className:"inventory-item-row",children:[e.jsx("label",{htmlFor:"item-name",children:"Name:"}),e.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:w=>N(w.target.value??""),value:E})]}),e.jsxs("div",{className:"inventory-item-row",children:[e.jsx("label",{htmlFor:"item-icon",children:"Count:"}),e.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:T,onChange:w=>C(parseInt(w.target.value)??1)})]}),e.jsxs("div",{className:"inventory-item-row inventory-item-size",children:[e.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),e.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:b,onChange:w=>R(parseFloat(w.target.value)??1)}),e.jsx("span",{children:" x "}),e.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:k,onChange:w=>G(parseFloat(w.target.value)??1)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),e.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:y,onChange:w=>X(w.target.checked)})]}),e.jsx("br",{})]}):e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:"",children:["Item: ",x.item.name]}),e.jsxs("div",{className:"inventory-item-row",children:[e.jsx("label",{htmlFor:"item-icon",children:"Count:"}),e.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:T,onChange:w=>C(parseInt(w.target.value)??1)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),e.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:y,onChange:w=>X(w.target.checked)})]})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{if(E.trim()===""&&x==null){alert("Item name cannot be empty");return}if(T<=0){alert("Item count must be greater than zero");return}let w=x;w==null?w=new ue({quantity:T,item:new I({id:E+(Math.random()*1e4).toString(),name:E,icon:`custom-${E}`,cellsLong:Math.ceil(b),cellsTall:Math.ceil(k),moveable:y,starterItem:!1,displayItem:!0})}):(w.quantity=T,w.item.moveable=y),P(w),X(!0),v(null),N(""),C(1),R(1),G(1),D()},children:"Add Item"}),e.jsx("button",{className:"action-btn",onClick:()=>{X(!0),v(null),N(""),C(1),R(1),G(1),D()},children:"Close"})]})})}function ml({item:c,setSelectingItem:D,addHighlightedCell:P,canPlaceItem:x,placeItem:v,highlightCells:E,unHighlightCells:N,cellSize:T,placeMultiItem:C}){const[b,R]=r.useState(0),[k,G]=r.useState(0),y=r.useRef(null),[X,Y]=r.useState(0),[L,w]=r.useState(0),[W,le]=r.useState(!1),[M,Z]=r.useState(0),[_,Te]=r.useState(null),[Ct,Ie]=r.useState(!0),[Le,$e]=r.useState(12),Xe=r.useRef(null),[dt,Rt]=r.useState(!0),[Be,mt]=r.useState(!1),[he,K]=r.useState(!1),[Ae,j]=r.useState(0),[fe,Ke]=r.useState(0),Ne=r.useCallback(V=>{const J=V%2===1;return{width:J?c.cellsTall*T:c.cellsLong*T,height:J?c.cellsLong*T:c.cellsTall*T,cellsWide:J?c.cellsTall:c.cellsLong,cellsTall:J?c.cellsLong:c.cellsTall}},[c,T]);function Me(V){const J=y.current,re=window.getComputedStyle(J),B=document.createElement("span");B.style.font=re.font,B.style.fontSize=V+"px",B.style.fontFamily=re.fontFamily,B.style.fontWeight=re.fontWeight,B.style.position="absolute",B.style.visibility="hidden",B.style.whiteSpace="nowrap",B.textContent=J.textContent,document.body.appendChild(B);const de=B.offsetWidth;return document.body.removeChild(B),de}function Oe(V){if(y.current){const J=y.current;return Me(V-1)>J.offsetWidth&&V-1>8?Oe(V-1):V-1}return V}const _e=()=>{mt(!0)},Fe=()=>{mt(!1)};r.useEffect(()=>(setTimeout(()=>{y.current&&$e(Oe(Le))},100),window.addEventListener("mousedown",_e),window.addEventListener("mouseup",Fe),()=>{window.removeEventListener("mousedown",_e),window.removeEventListener("mouseup",Fe)}),[]),r.useEffect(()=>{if(c){le(!0);const V=Xe.current?.getBoundingClientRect();j(V?V.left-b:0),Ke(V?V.top-k:0)}else console.log("No item to place, stopping dragging"),le(!1),R(0),G(0),Y(0),w(0),Z(0),Te(null),Ie(!0),$e(12),Rt(!0),j(0),Ke(0)},[c,b,k]);const ye=V=>{V.preventDefault()},Ge=r.useCallback((V,J,re)=>{if(c==null||!W)return;const B=re.target,de=Ne(M),Q=I.fromDoc(c.toDoc());Q.cellsLong=de.cellsWide,Q.cellsTall=de.cellsTall,Q.initialElement=c.initialElement,Q.rotation=M,Q.hasMoved=c.hasMoved,Q.id=c.id;let we=B;if(!we||!we.classList?.contains("cell")){const Ee=document.elementFromPoint(V,J);Ee?.classList?.contains("cell")&&(we=Ee)}we?.classList?.contains("cell")&&!he?E(f.fromString(we.id),Q):we?.classList?.contains("section-modifier")&&!he?E(f.fromString(we.dataset.cell),Q):he||N(),R(V-Ae),G(J-fe+5),Be&&(he||N(),K(!0),P(f.fromString(we.id)))},[c,W,Ae,fe,he,Be,Ne,M,E,N,P]),Ce=r.useCallback(V=>{if(c==null)return;const J=V.clientX,re=V.clientY;console.log("Drag ended"),N(),document.body.removeEventListener("touchmove",ye);const B=document.elementFromPoint(J,re);if(!B?.classList?.contains("cell")&&!B?.classList?.contains("section-modifier")){const de=Ne(M),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};he?(K(!1),C(Q)):D()}else if(B?.classList?.contains("section-modifier")){if(console.log("Placing item on section modifier cell"),console.log("Target element:",B.dataset.cell),B.dataset.cell=="")return;const de=Ne(M),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};if(he)K(!1),C(Q);else{if(!x(f.fromString(B.dataset.cell),Q))return;v(f.fromString(B.dataset.cell),Q,_!=null?f.fromString(_.id):null)}console.log("Placed item at cell:",B)}else{const de=Ne(M),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};if(he)K(!1),C(Q);else{if(!x(f.fromString(B.id),Q))return;v(f.fromString(B.id),Q,_!=null?f.fromString(_.id):null)}console.log("Placed item at cell:",B)}},[c,M,D,he,x,v,_,N,X,L]),H=r.useCallback(V=>{const J=V.clientX,re=V.clientY;Ge(J,re,V)},[Ge]),oe=r.useCallback(V=>{const J=V.touches[0],re=J.clientX,B=J.clientY;Ge(re,B,V)},[Ge]),A=r.useCallback(V=>{const J=V.changedTouches[0],re=J.clientX,B=J.clientY;Ce({clientX:re,clientY:B}),document.body.removeEventListener("touchmove",ye)},[Ce,ye]);return r.useEffect(()=>{if(W)return document.body.addEventListener("touchmove",ye,{passive:!1}),document.addEventListener("mousemove",H),document.addEventListener("mouseup",Ce),document.addEventListener("touchmove",oe),document.addEventListener("touchend",A),()=>{document.body.removeEventListener("touchmove",ye),document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",Ce),document.removeEventListener("touchmove",oe),document.removeEventListener("touchend",A)}},[W,H,Ce,oe,A,ye]),b==0||k==0||!dt||c==null?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:e.jsx("div",{id:c.id,ref:Xe,className:`draggable-item ${c.isSectionModifier&&!c.moveable?"placed-modifier":""} ${c.isSectionModifier?c.sectionModifierType?.toString():""} ${W?"dragging":""} ${c.moveable?"":"not-moveable"}`,style:{top:`${k}px`,left:`${b}px`,width:`${c.cellsLong*(c.isDisplayItem&&!W&&!c.hasMoved?10:T)-(c.sectionModifierType=="LeftWall"||c.sectionModifierType=="RightWall"||c.sectionModifierType?.includes("Corner")?1:0)}px`,height:`${c.cellsTall*(c.isDisplayItem&&!W&&!c.hasMoved?10:T)-(c.sectionModifierType=="TopWall"||c.sectionModifierType=="BottomWall"||c.sectionModifierType?.includes("Corner")?1:0)}px`,rotate:`${M*90}deg`,transformOrigin:"center center",fontSize:`${Le}px`,zIndex:W?1e3:1},children:c.isSectionModifier?null:c.icon.includes("custom-")?e.jsx("div",{className:c.isSectionItem?"custom-section":"custom-icon",children:e.jsx("div",{children:e.jsx("p",{ref:y,children:c.icon.split("custom-")[1]})})}):e.jsx("img",{src:c.icon,alt:"icon"})})})}function gl({vendor:c,onDelete:D,onEdit:P,boothMap:x}){return e.jsxs("div",{className:"vendor-display-tile",children:[e.jsxs("div",{className:"vendor-info",children:[e.jsx("h3",{className:"vendor-business-name",children:c.businessName}),e.jsxs("p",{className:"vendor-plot-size",children:[c.plotWidth,"ft x ",c.plotHeight,"ft"]})]}),e.jsxs("div",{className:"vendor-actions",children:[e.jsx("img",{src:el,alt:"Share",className:"vendor-link",onClick:async v=>{v.stopPropagation();const E=localStorage.getItem("companyId"),N=window.location.origin+`/Layout/?companyId=${E}&areaId=${x.areaId}&type=pick-booth&boothMapId=${x.id}&boothMapName=${x.name}&vendorId=${c.id}`;await navigator.clipboard.writeText(N),alert("Booth Map link copied to clipboard!")}}),e.jsx("img",{src:$t,alt:"Edit",className:"vendor-edit",onClick:v=>{v.stopPropagation(),P(c.id)}}),e.jsx("img",{src:tl,alt:"Delete",className:"vendor-delete",onClick:v=>{v.stopPropagation(),window.confirm("Are you sure you want to delete this vendor?")&&D(c.id)}})]})]})}function ul({maxHeight:c,vendors:D,onAddVendor:P,boothMap:x,onDeleteVendor:v,onEditVendor:E}){return e.jsxs("div",{className:"vendors-tile",style:{maxHeight:c?`${c}px`:"200px"},children:[e.jsx("h2",{children:"Vendors"}),e.jsx("div",{className:"vendors-divider"}),e.jsxs("div",{className:"vendors-tile-content",children:[D.map(N=>e.jsx(gl,{vendor:N,boothMap:x,onDelete:T=>{v(T)},onEdit:T=>{E(N)}},N.id)),e.jsx("div",{className:"add-vendor",onClick:P,children:e.jsx("img",{src:Kt,alt:"Add vendor"})})]})]})}function fl({dialogRef:c,closeDialog:D,addVendor:P}){const[x,v]=r.useState(""),[E,N]=r.useState(1),[T,C]=r.useState(1),[b,R]=r.useState(!1);return e.jsxs("dialog",{ref:c,className:"add-vendor-dialog",children:[e.jsxs("div",{className:"add-vendor-dialog-div",children:[e.jsx("h2",{children:"Add Vendor"}),e.jsxs("div",{className:"add-vendor-row",children:[e.jsx("label",{htmlFor:"business-name",children:"Business Name:"}),e.jsx("input",{type:"text",id:"business-name",name:"business-name",onChange:k=>v(k.target.value??""),value:x})]}),e.jsxs("div",{className:"add-vendor-row add-vendor-size",children:[e.jsx("label",{htmlFor:"item-width",children:"Booth Size (in feet):"}),e.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:E,onChange:k=>N(parseFloat(k.target.value)??1)}),e.jsx("span",{children:" x "}),e.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:T,onChange:k=>C(parseFloat(k.target.value)??1)})]}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:async()=>{if(x.trim()===""){alert("Business name cannot be empty");return}const k=new qt({id:x+(Math.random()*1e4).toString(),businessName:x,plotWidth:Math.ceil(E),plotHeight:Math.ceil(T)});R(!0),await P(k),v(""),N(1),C(1),R(!1),D()},children:"Add Vendor"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{D(),v(""),N(1),C(1)},children:"Close"})]}),b&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"loader"})})]})}function hl({dialogRef:c,closeDialog:D,editVendor:P,oldVendor:x}){const[v,E]=r.useState(""),[N,T]=r.useState(1),[C,b]=r.useState(1),[R,k]=r.useState(!1);return r.useEffect(()=>{x&&(E(x.businessName),T(x.plotWidth),b(x.plotHeight))},[x]),e.jsxs("dialog",{ref:c,className:"edit-vendor-dialog",children:[e.jsxs("div",{className:"edit-vendor-dialog-div",children:[e.jsx("h2",{children:"Edit Vendor"}),e.jsxs("div",{className:"edit-vendor-row",children:[e.jsx("label",{htmlFor:"business-name",children:"Business Name:"}),e.jsx("input",{type:"text",id:"business-name",name:"business-name",onChange:G=>E(G.target.value??""),value:v})]}),e.jsxs("div",{className:"edit-vendor-row edit-vendor-size",children:[e.jsx("label",{htmlFor:"item-width",children:"Booth Size (in feet):"}),e.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:N,onChange:G=>T(parseFloat(G.target.value)??1)}),e.jsx("span",{children:" x "}),e.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:C,onChange:G=>b(parseFloat(G.target.value)??1)})]}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:async()=>{if(v.trim()===""){alert("Business name cannot be empty");return}const G=new qt({id:x.id,businessName:v,plotWidth:Math.ceil(N),plotHeight:Math.ceil(C)});k(!0),await P(G),E(""),T(1),b(1),k(!1),D()},children:"Save Vendor"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{D(),E(x.businessName),T(x.plotWidth),b(x.plotHeight)},children:"Close"})]}),R&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"loader"})})]})}function pl({maxHeight:c}){return e.jsxs("div",{className:"key-tile",children:[e.jsx("h2",{children:"Key"}),e.jsx("div",{className:"key-divider"}),e.jsxs("div",{className:"key-tile-content",children:[e.jsxs("div",{className:"key-item",children:[e.jsx("div",{className:"cell cell-border"}),e.jsx("p",{children:"1ft x 1ft"})]}),e.jsxs("div",{className:"key-item",children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"wall"})}),e.jsx("p",{children:"Wall"})]}),e.jsxs("div",{className:"key-item",children:[e.jsx("div",{className:"window-container",children:e.jsx("div",{className:"window"})}),e.jsx("p",{children:"Window"})]}),e.jsxs("div",{className:"key-item",children:[e.jsx("div",{className:"container",children:e.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fright_door.png?alt=media&token=8c6f3b4d-5e7a-4b9c-8d2f-0a3b5e6f7c8d",alt:"",className:"door"})}),e.jsx("p",{children:"Door"})]}),e.jsxs("div",{className:"key-item",children:[e.jsx("div",{className:"window-container",children:e.jsx("div",{className:"section-divider"})}),e.jsx("p",{children:"Section Divider"})]})]})]})}function Il({dialogRef:c,closeDialog:D,vendors:P,addVendorToBooth:x}){const[v,E]=r.useState(!1),[N,T]=r.useState(null);return e.jsxs("dialog",{ref:c,className:"add-vendor-dialog",children:[e.jsxs("div",{className:"add-vendor-dialog-div",children:[e.jsx("h2",{children:"Select Vendor"}),e.jsxs("div",{className:"add-vendor-row",children:[e.jsx("label",{htmlFor:"boothMap-area",children:"Vendor:"}),e.jsxs("select",{id:"boothMap-area",name:"boothMap-area",onChange:C=>{const b=C.target.value,R=P.find(k=>k.id===b)||null;T(R)},value:N?.id||"",children:[e.jsx("option",{value:"",children:"Select a Vendor"}),P.map(C=>e.jsx("option",{value:C.id,children:C.businessName},C.id))]})]}),e.jsx("button",{className:"action-btn",onClick:()=>{if(!N){alert("Please select a vendor");return}E(!0),x(N)},children:"Select"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{D(),T(null)},children:"Close"})]}),v&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"loader"})})]})}function yl({dialogRef:c,closeDialog:D,editInventoryItem:P,selectedItem:x,deleteInventoryItem:v}){const[E,N]=r.useState(1),[T,C]=r.useState(!0);return r.useEffect(()=>{x&&(N(x.quantity),C(x.item.moveable))},[x]),e.jsx("dialog",{ref:c,className:"inventory-item-dialog",children:e.jsxs("div",{className:"inventory-item-dialog-div",children:[e.jsx("h2",{children:"Edit Inventory Item"}),e.jsxs("label",{htmlFor:"",children:["Item: ",x?.item.name]}),e.jsxs("div",{className:"inventory-item-row",children:[e.jsx("label",{htmlFor:"item-icon",children:"Count:"}),e.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:E,onChange:b=>N(parseInt(b.target.value)??1)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),e.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:T,onChange:b=>C(b.target.checked)})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{if(E<=0){alert("Item count must be greater than zero");return}if(x){const b=x;b.quantity=E,b.item.moveable=T,P(b),C(!0),D()}},children:"Save"}),e.jsx("button",{className:"action-btn",onClick:()=>{v(x),D()},children:"Delete"}),e.jsx("button",{className:"action-btn",onClick:()=>{D()},children:"Close"})]})})}function wl({dialogRef:c,closeDialog:D}){const[P,x]=r.useState(0),v=[{title:"Welcome to LayItOut!",content:e.jsx("p",{children:"This tutorial will guide you through the basics of designing your layout. Let's get started!"})},{title:"Placing Mode",content:e.jsxs("p",{children:["There are two different placing modes: Drag and Drop and Tap to Place.",e.jsx("br",{}),"In Drag and Drop mode, you can click and drag items from the inventory onto the design area.",e.jsx("br",{}),"In Tap to Place mode, you can select an item from the inventory and then click or drag on the design area to place it.",e.jsx("br",{}),"You can toggle between these modes using the dropdown below the submit button."]})},{title:"Placing Items",content:e.jsx("p",{children:"To place items in your layout, use the inventory panel to select and drag items onto the design area."})},{title:"Moving Items",content:e.jsx("p",{children:"To move an item, simply click and drag it to the desired location within the design area."})},{title:"Deleting Items",content:e.jsx("p",{children:"You can delete an item by clicking it and clicking the x icon "})},{title:"Rotating Items",content:e.jsx("p",{children:"To rotate an item, click on it and use the rotate handle that appears to adjust its orientation."})},{title:"Saving and Submitting",content:e.jsx("p",{children:"Remember to save your work frequently! When you're satisfied with your layout, click the submit button to finalize your design."})}];return e.jsx("dialog",{ref:c,className:"design-tutorial-dialog",children:e.jsxs("div",{className:"design-tutorial-div",children:[e.jsx("h2",{children:v[P].title}),v[P].content,e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:()=>{P<v.length-1?x(P+1):(localStorage.setItem("hasSeenDesignTutorial","true"),D())},children:P<v.length-1?"Next":"Close"})]})})}Fn.createRoot(document.getElementById("root")).render(e.jsx(xl,{}));function xl(){const[c,D]=r.useState(/Mobi|Android/i.test(navigator.userAgent)),[P,x]=r.useState(0),[v,E]=r.useState(0),[N,T]=r.useState(0),[C,b]=r.useState(0),[R,k]=r.useState([]),[G,y]=r.useState([]),[X,Y]=r.useState(0),[L,w]=r.useState(null),[W,le]=r.useState([]),M=/Mobi|Android/i.test(navigator.userAgent)?5:10,[Z,_]=r.useState([]),[Te,Ct]=r.useState(!1),[Ie,Le]=r.useState(null),[$e,Xe]=r.useState(null),[dt,Rt]=r.useState([new I({id:"left-wall",name:"Left Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftWall"}),new I({id:"right-wall",name:"Right Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightWall"}),new I({id:"top-wall",name:"Top Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"TopWall"}),new I({id:"bottom-wall",name:"Bottom Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"BottomWall"}),new I({id:"left-door",name:"Left Door",cellsLong:1,cellsTall:1,icon:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fleft_door.png?alt=media&token=91fde31c-ebc6-4807-9670-f846c8d75cb6",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftDoor"}),new I({id:"right-door",name:"Right Door",cellsLong:1,cellsTall:1,icon:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fright_door.png?alt=media&token=8c6f3b4d-5e7a-4b9c-8d2f-0a3b5e6f7c8d",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightDoor"}),new I({id:"left-window",name:"Left Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftWindow"}),new I({id:"right-window",name:"Right Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightWindow"}),new I({id:"top-window",name:"Top Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"TopWindow"}),new I({id:"bottom-window",name:"Bottom Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"BottomWindow"})]),Be=r.useRef(null),[mt,he]=r.useState(!1),[K,Ae]=r.useState([]),[j,fe]=r.useState([]),[Ke,Ne]=r.useState([]),[Me,Oe]=r.useState([]),[_e,Fe]=r.useState(!1),ye=r.useRef(null),[Ge,Ce]=r.useState([]),[H,oe]=r.useState([]),[A,V]=r.useState(null),[J,re]=r.useState(!1),[B,de]=r.useState(!1),[Q,we]=r.useState(!1),[Ee,_t]=r.useState(!1),[se,en]=r.useState(!1),[ee,gt]=r.useState("placing-sections"),[vl,tn]=r.useState(!1),[et,nn]=r.useState(!1),[be,ln]=r.useState(!1),[tt,on]=r.useState(!1),[Qe,sn]=r.useState(!1),[Ve,an]=r.useState(!1),[Ye,kt]=r.useState(!1),[Ze,ze]=r.useState(""),[nt,cn]=r.useState(null),[Je,Dt]=r.useState(""),[U,rn]=r.useState(""),[dn,mn]=r.useState(null),[q,gn]=r.useState(""),[lt,un]=r.useState(null),[ot,st]=r.useState(""),[Pt,it]=r.useState(""),[ie,Re]=r.useState(null),[ut,z]=r.useState(!0),[Wt,fn]=r.useState(null),[ft,pe]=r.useState(!1),[hn,pn]=r.useState(null),[ht,pt]=r.useState([]),[In,ke]=r.useState(!1),[Se,yn]=r.useState(null),[It,wn]=r.useState(!1),[xn,vn]=r.useState(null),[yt,bn]=r.useState(null),[Bt,Ot]=r.useState(null),[De,Ft]=r.useState(!1),[Sn,jn]=r.useState(null),wt=r.useRef(null),xt=r.useRef(null),vt=r.useRef(null),bt=r.useRef(null),St=r.useRef(null),jt=r.useRef(null),Tt=r.useRef(null),Lt=r.useRef(null);function xe(n,t){for(const s of t)if(n.x>=s.cellId.x&&n.x<s.cellId.x+s.cellsLong&&n.y>=s.cellId.y&&n.y<s.cellId.y+s.cellsTall)return s;return null}function Tn(n,t,s,a){Ae([...n.map(o=>new F({name:o.name,cellId:new f({x:o.cellId.x,y:o.cellId.y}),cellsLong:o.cellsLong,cellsTall:o.cellsTall,modifierItems:o.modifierItems.map(l=>new $({cell:new f({x:l.cell.x,y:l.cell.y}),item:new I({...l.item,starterItem:!0})})),startingItems:[]}))]);let i=P,d=v;if(c){for(const u of n)console.log("Generating cells for section",u.name,"at",u.cellId,"with size",u.cellsLong,"x",u.cellsTall),console.log("Needed section Width:",(u.cellsLong+u.cellId.x)*M,"Current width:",i),(u.cellsLong+u.cellId.x)*M>i&&(console.log("Added section Width:",u.cellsLong*M+u.cellId.x),i+=(u.cellsLong+u.cellId.x)*M-i),console.log("Needed section Height:",(u.cellsTall+u.cellId.y)*M,"Current height:",d),(u.cellsTall+u.cellId.y)*M>d&&(console.log("Added section Height:",u.cellsTall*M+u.cellId.y),d+=(u.cellsTall+u.cellId.y)*M-d);b(d/M*2),T(i/M*2);let o=0;const l=[],g=[];for(const u of n){const h=[],S={width:u.cellsLong*M,height:u.cellsTall*M,sectionName:u.name};S.height>o&&(o=S.height),Ce(O=>[...O,S]),u.cellId.x=0,u.cellId.y=0,[...Array(S.height/M).keys()].map(O=>{const me=[];[...Array(S.width/M).keys()].map(ce=>{me.push({id:new f({x:ce,y:O}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:!0,size:M})}),h.push(me)}),l.push({sectionName:u.name,cells:[...h]}),g.push(u)}oe(l),fe(g),Y(o),V(n[0]?n[0].name:null),setTimeout(()=>{z(!1)},500)}else{const o=[];for(const l of n)console.log("Generating cells for section",l.name,"at",l.cellId,"with size",l.cellsLong,"x",l.cellsTall),console.log("Needed section Width:",l.cellsLong+l.cellId.x,"Current width:",i),l.cellsLong+l.cellId.x>i&&(console.log("Added section Width:",l.cellsLong+l.cellId.x),i+=l.cellsLong+l.cellId.x-i),console.log("Needed section Height:",l.cellsTall+l.cellId.y,"Current height:",d),l.cellsTall+l.cellId.y>d&&(console.log("Added section Height:",l.cellsTall+l.cellId.y),d+=l.cellsTall+l.cellId.y-d);x(t.width),E(t.height),T(t.width),b(t.height),console.log("Final width:",i,"Final height:",d),[...Array(t.height).keys()].map(l=>{const g=[];[...Array(t.width).keys()].map(u=>{console.log("Creating cell at",u,l,"with size",M,s),g.push({id:new f({x:u,y:l}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:s&&a=="placing-sections"?!0:xe(new f({x:u,y:l}),n)!=null,size:M})}),o.push(g)}),k([...o]),setTimeout(()=>{const l=[],g=[...n],u=[];for(const h of g)h.cellElement=document.querySelector(`.App #${h.cellId.toId()}.cell:not(.cell-border)`),l.push(...h.startingItems.map(S=>new $({cell:new f({x:h.cellId.x+S.cell.x,y:h.cellId.y+S.cell.y}),item:new I({...S.item,initialElement:document.querySelector(`.App #${S.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,hasMoved:!0})}))),l.push(...h.modifierItems.map(S=>new $({cell:new f({x:h.cellId.x+S.cell.x,y:h.cellId.y+S.cell.y}),item:new I({...S.item,initialElement:document.querySelector(`.App #${S.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1})}))),u.push(...h.booths.map(S=>new je({...S,cell:new f({x:h.cellId.x+S.cell.x,y:h.cellId.y+S.cell.y}),initialElement:document.querySelector(`.App #${S.cell.toId()}.cell:not(.cell-border)`)})));fe([...g]);for(const h of l){const S=ce=>{const ge=ce%2===1;return{cellsLong:ge?h.item.cellsTall:h.item.cellsLong,cellsTall:ge?h.item.cellsLong:h.item.cellsTall}},O=h.item.rotation||0,me=S(O);for(let ce=0;ce<me.cellsTall;ce++)for(let ge=0;ge<me.cellsLong;ge++)o[h.cell.y+ce][h.cell.x+ge].hasItem=!0,o[h.cell.y+ce][h.cell.x+ge].itemId=h.item.id;h.item.initialElement=document.querySelector(`.App #${h.cell.toId()}.cell:not(.cell-border)`),y(ce=>[...ce,h.item])}for(const h of u){for(let S=0;S<h.cellsTall;S++)for(let O=0;O<h.cellsLong;O++)o[h.cell.y+S][h.cell.x+O].hasItem=!0,o[h.cell.y+S][h.cell.x+O].itemId=h.id;h.initialElement=document.querySelector(`.App #${h.cell.toId()}.cell:not(.cell-border)`),Ne(S=>[...S,h])}k([...o]),setTimeout(()=>{z(!1)},500)},100)}}async function Ln(){const n=new URLSearchParams(window.location.search),t=n.get("companyId"),s=n.get("areaId"),a=n.get("areaId")||"",i=n.get("companyId")||"",d=n.get("templateId")||"",o=await Hn(i,a);if(o===null){window.location.href="/DNF/";return}un(o),pn(o.previewImage||null);const l=n.get("type")||"";let g=!1,u=!1,h="modify-sections",S=!1,O=null;if(l==="public-preview"){kt(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="create-template")re(!0);else if(l==="edit-area")nn(!0);else if(l==="edit-template"){de(!0);const m=o.templates.find(p=>p.id===d);m&&(fn(m),Dt(m.name))}else if(l==="view-design"){g=!0,we(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="view-area")_t(!0);else if(l==="edit-design"){g=!0,tn(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="client-edit-design"){g=!0,an(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p),localStorage.getItem("hasSeenDesignTutorial")||Lt.current?.showModal()}else if(l==="create-area"){u=!0,en(!0);const m=n.get("stage");m==="placing-sections"?(h="placing-sections",gt("placing-sections")):m==="modify-sections"?(gt("modify-sections"),h="modify-sections",_(dt.map(p=>new ue({item:new I({...p,displayItem:!0}),quantity:-1})))):m==="placing-items"&&(gt("placing-items"),h="placing-items",_(o.inventoryItems.map(p=>new ue({item:new I({...p.item,displayItem:!0}),quantity:p.quantity}))))}else if(l==="view-boothMap"){S=!0,ln(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Re(p),O=p}else if(l==="pick-booth"){S=!0,sn(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Re(p),O=p;const ae=n.get("vendorId")||"";if(ae!==""){const ne=p.vendors.find(te=>te.id===ae);if(ne){yn(ne),console.log("Vendor found",ne);let te=!1;O.sections.forEach(Bn=>{Bn.booths.forEach(On=>{On.user?.id===ne.id&&(te=!0)})}),wn(te);const Qt=await Xn(i);if(Qt===null){window.location.href="/DNF/";return}mn(Qt)}else{window.location.href="/DNF/";return}}}else if(l==="create-boothMap"){S=!0,on(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Re(p),O=p}else if(l==="public-preview-boothMap"){S=!0,kt(!0);const m=n.get("boothMapId")||"";it(m);const p=n.get("designName")||"";ze(p);const ae=await ct(i,a,m);if(ae===null){window.location.href="/DNF/";return}Re(ae),O=ae}t&&rn(t),s&&gn(s),u||_(o.inventoryItems.map(m=>new ue({item:new I({...m.item,displayItem:!0}),quantity:m.quantity})));const me=[],ce=[];for(const m of o.templates){const p=[],ae=[];for(const ne of m.sections)p.push(new F({name:ne.name,cellId:new f({x:ne.cellId.x,y:ne.cellId.y}),cellsLong:ne.cellsLong,cellsTall:ne.cellsTall,modifierItems:ne.modifierItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})})),startingItems:ne.startingItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})}))})),ae.push(new F({name:ne.name,cellId:new f({x:ne.cellId.x,y:ne.cellId.y}),cellsLong:ne.cellsLong,cellsTall:ne.cellsTall,modifierItems:ne.modifierItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})})),startingItems:ne.startingItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})}))}));me.push(new ve({name:m.name,sections:p,inventoryItems:m.inventoryItems,id:m.id,previewImage:m.previewImage})),ce.push(new ve({name:m.name,sections:ae,id:m.id,previewImage:m.previewImage,inventoryItems:m.inventoryItems}))}Oe([...me]);const ge=[],He=d===""?void 0:ce.find(m=>m.id===d);if(console.log("TEMPLATE",He,"AREA",o),S&&O)_(O.inventoryItems.map(m=>new ue({item:new I({...m.item,displayItem:!0}),quantity:m.quantity}))),Ae([...O.sections]),fe([...O.sections.map(m=>new F({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,booths:m.booths,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ge.push(...O.sections.map(m=>new F({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,booths:m.booths,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))})));else if(g){const m=await Qn(i,a,n.get("designId")||"");if(m===null){window.location.href="/DNF/";return}Ft(m.submitted),Ot(m.dateSubmitted?new Date(m.dateSubmitted):null),cn(m),_(m.inventoryItems.map(p=>new ue({item:new I({...p.item,displayItem:!0}),quantity:p.quantity}))),Ae([...m.sections]),fe([...m.sections.map(p=>new F({name:p.name,cellId:new f({x:p.cellId.x,y:p.cellId.y}),cellsLong:p.cellsLong,cellsTall:p.cellsTall,startingItems:p.startingItems,modifierItems:p.modifierItems,items:p.startingItems.map(ae=>new I({...ae.item,sectionCell:new f({x:ae.cell.x,y:ae.cell.y})}))}))]),ge.push(...m.sections.map(p=>new F({name:p.name,cellId:new f({x:p.cellId.x,y:p.cellId.y}),cellsLong:p.cellsLong,cellsTall:p.cellsTall,startingItems:p.startingItems,modifierItems:p.modifierItems,items:p.startingItems.map(ae=>new I({...ae.item,sectionCell:new f({x:ae.cell.x,y:ae.cell.y})}))})))}else He!==void 0?(_(He.inventoryItems.map(m=>new ue({item:new I({...m.item,displayItem:!0}),quantity:m.quantity}))),Ae([...He.sections]),fe([...He.sections.map(m=>new F({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ge.push(...He.sections.map(m=>new F({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,modifierItems:m.modifierItems,startingItems:m.startingItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))})))):(Ae([...o.sections]),fe([...o.sections.map(m=>new F({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,modifierItems:m.modifierItems,startingItems:m.startingItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ge.push(...o.sections.map(m=>new F({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))));console.log("SECTIONS TO GENERATE",ge),Tn(ge,o,l==="create-area",h)}r.useEffect(()=>{Ln()},[]);function An(n,t,s){if(!c||n==null)return;const a=[...s],i=[],d=[],o=s.find(l=>l.name==n);console.log("NEW SECTION",o),console.log("Adding section",o.name,o.cellId),console.log("MOBILE CELLS",t),o.cellElement=document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${o.cellId.toId()}.cell:not(.cell-border)`),console.log("Section element found",o.cellElement);for(const l of o.startingItems){console.log("Placing starting item",l.item.name,l.cell);const g=S=>{const O=S%2===1;return{cellsLong:O?l.item.cellsTall:l.item.cellsLong,cellsTall:O?l.item.cellsLong:l.item.cellsTall}},u=l.item.rotation||0,h=g(u);for(let S=0;S<h.cellsTall;S++)for(let O=0;O<h.cellsLong;O++){const me=t.find(ce=>ce.sectionName===o.name);me.cells[l.cell.y+S][l.cell.x+O].hasItem=!0,me.cells[l.cell.y+S][l.cell.x+O].itemId=l.item.id}l.item.initialElement=document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),console.log("Adding item to items",l.item.initialElement),i.push(new I({...l.item,hasMoved:!0}))}for(const l of o.modifierItems){console.log("Placing starting item",l.item.name,l.cell);const g=S=>{const O=S%2===1;return{cellsLong:O?l.item.cellsTall:l.item.cellsLong,cellsTall:O?l.item.cellsLong:l.item.cellsTall}},u=l.item.rotation||0,h=g(u);for(let S=0;S<h.cellsTall;S++)for(let O=0;O<h.cellsLong;O++){const me=t.find(ce=>ce.sectionName===o.name);me.cells[l.cell.y+S][l.cell.x+O].hasItem=!0,me.cells[l.cell.y+S][l.cell.x+O].itemId=l.item.id}console.log("Adding item to items",document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`)),i.push(new I({...l.item,initialElement:document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1}))}console.log("Setting sections",a),fe([...a]),console.log("ITEMS",i),y(l=>[...l.filter(u=>!i.some(h=>h.id===u.id)),...i.map(u=>new I({...u,starterItem:!0}))]),d.push(...o.booths.map(l=>new je({...l,initialElement:document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`)})));for(const l of d){for(let g=0;g<l.cellsTall;g++)for(let u=0;u<l.cellsLong;u++){const h=t.find(S=>S.sectionName===o.name);h.cells[l.cell.y+g][l.cell.x+u].hasItem=!0,h.cells[l.cell.y+g][l.cell.x+u].itemId=l.id}Ne(g=>[...g,l])}}function Gt(n){let t=[];return n.map(s=>t=[...t,...s]),t}function Nn(n,t){let s=!1;return t.sections.forEach(a=>{a.booths.forEach(i=>{i.user?.id===n.id&&(s=!0)})}),s}function At(n,t){const s=c?H.find(o=>o.sectionName===A).cells:R,a=s[n.y].length,i=s.length;if(n.x+t.cellsLong>a||n.y+t.cellsTall>i)return!1;const d=xe(n,j);if(!d&&!c&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;for(let o=0;o<t.cellsTall;o++)for(let l=0;l<t.cellsLong;l++){if(!c){const g=xe(new f({x:n.x+l,y:n.y+o}),j);if(!g&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;if(g?.name!=d?.name&&(ee!=="placing-sections"||!se))return console.log("Item is crossing section boundaries"),!1}if(s[n.y+o][n.x+l].hasItem&&s[n.y+o][n.x+l].itemId!=t.id){console.log("Something is already here single"),console.log("Current ID",s[n.y+o][n.x+l].itemId,"Placing Item ID",t.id);const g=G.find(u=>u.id==s[n.y+o][n.x+l].itemId);if(g&&g.isSectionModifier){if(g.sectionModifierType==="LeftDoor"||g.sectionModifierType==="RightDoor")return console.log("Item is on door of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),!1;if(g.sectionModifierType==="RightWall"){if(console.log("Item is on left wall of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),l==t.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="LeftWall"){if(console.log("Item is on right wall of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopWall"){if(console.log("Item is on bottom wall of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),o==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomWall"){if(console.log("Item is on top wall of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),o==t.cellsTall-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopRightCornerWall"){if(console.log("Item is on bottom left corner of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),o==0&&l==t.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopLeftCornerWall"){if(console.log("Item is on bottom right corner of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),o==0&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomRightCornerWall"){if(console.log("Item is on top left corner of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),o==t.cellsTall-1&&l==t.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomLeftCornerWall"){if(console.log("Item is on top right corner of section modifier, can place item",o,l,t.cellsTall,t.cellsLong),o==t.cellsTall-1&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}}else return!1}}return!0}function Vt(n,t,s){console.log(t),console.log("CELLS",n);const a=n[t.y].length,i=n.length;if(console.log(a,i),t.x+s.cellsLong>a||t.y+s.cellsTall>i)return!1;const d=xe(t,j);if(!d&&!c&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;for(let o=0;o<s.cellsTall;o++)for(let l=0;l<s.cellsLong;l++){if(!c){const g=xe(new f({x:t.x+l,y:t.y+o}),j);if(!g&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;if(g?.name!=d?.name&&(ee!=="placing-sections"||!se))return console.log("Item is crossing section boundaries"),!1}if(n[t.y+o][t.x+l].hasItem&&n[t.y+o][t.x+l].itemId!=s.id){console.log("Something is already here multi");const g=G.find(u=>u.id==n[t.y+o][t.x+l].itemId);if(g&&g.isSectionModifier){if(g.sectionModifierType==="LeftDoor"||g.sectionModifierType==="RightDoor")return console.log("Item is on door of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),!1;if(g.sectionModifierType==="RightWall"){if(console.log("Item is on left wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="LeftWall"){if(console.log("Item is on right wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopWall"){if(console.log("Item is on bottom wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomWall"){if(console.log("Item is on top wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopRightCornerWall"){if(console.log("Item is on bottom left corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0&&l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopLeftCornerWall"){if(console.log("Item is on bottom right corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomRightCornerWall"){if(console.log("Item is on top left corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1&&l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomLeftCornerWall"){if(console.log("Item is on top right corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}}else return!1}console.log("Finished checking placement. Current Item ID:",s.id,"Over: ",n[t.y+o][t.x+l])}return!0}function Yt(n,t,s){const a=Array.from(c?H.find(o=>o.sectionName===A).cells:R);if(ke(!0),s!=null){console.log("Removing item",t.id,"from cell",s.toId());const o=c?j.find(l=>l.name===A):xe(s,j);o.items=o.items.filter(l=>l.id!=t.id);for(let l=0;l<t.cellsTall;l++)for(let g=0;g<t.cellsLong;g++)a[s.y+l][s.x+g].hasItem=!1,a[s.y+l][s.x+g].itemId=""}const i=t.name+Math.floor(Math.random()*1e5).toString();if(ee!=="placing-sections"||!se){const o=c?j.find(g=>g.name===A):xe(n,j),l=new f({x:n.x-o.cellId.x,y:n.y-o.cellId.y});t.sectionCell=l,console.log("Adding item to section",o.name,"at",l,t),o.items.push(Te?new I({...t,id:i}):t)}else t.sectionCell=new f({x:n.x,y:n.y});for(let o=0;o<t.cellsTall;o++)for(let l=0;l<t.cellsLong;l++)a[n.y+o][n.x+l].hasItem=!0,Te?a[n.y+o][n.x+l].itemId=i:a[n.y+o][n.x+l].itemId=t.id;if(console.log(a),c){const o=H.find(l=>l.sectionName===A);o&&(o.cells=a.map(l=>l.map(g=>({...g}))),oe([...H]))}else k(a);console.log("Removing item from inventory",t.name,t.hasMoved,t.starterItem);let d=!1;if(!t.hasMoved){console.log("INVENTORY ITEMs",Z);const o=Z.findIndex(l=>l.item.name==t.name&&!l.item.hasMoved);if(o!==-1){const l=[...Z];console.log("Found item in inventory",l[o]),l[o].quantity>0&&(l[o].quantity-=1,l[o].quantity<=0&&(d=!0,l.splice(o,1)),_(l))}else _(Z)}if(y(o=>(console.log("Placing item",t),console.log("Updating item",t.id),Te&&Ie&&t.id==Ie.id?(console.log("Updating placing item",i),t.hasMoved=!0,t.starterItem=!0,t.isDisplayItem=!1,t.initialElement=document.querySelector(`.App #${n.toId()}.cell:not(.cell-border)`),console.log("New item id",i),[...o,new I({...t,hasMoved:!0,id:i})]):(o.find(l=>l.id==t.id).hasMoved||(o.find(l=>l.id==t.id).hasMoved=!0,o.find(l=>l.id==t.id).sectionCell=t.sectionCell),o))),Te&&Ie&&d){Le(null);return}}function Mn(n){G.find(t=>t.name==n.name&&!t.hasMoved&&!t.starterItem)||y(t=>[...t,n])}r.useEffect(()=>{Ie?(console.log("Adding placing item",Ie.id),Xe(Ie.id)):(console.log("Removing placing item",$e),Xe(""))},[Ie]);function Zt(n){console.log("Removing item",n.id),y(t=>t.filter(s=>s.id!=n.id))}function En(n,t){const s=Array.from(c?H.find(o=>o.sectionName===A).cells:R);ke(!0);const a=o=>{const l=o%2===1;return{cellsWide:l?n.cellsTall:n.cellsLong,cellsTall:l?n.cellsLong:n.cellsTall}},i=n.rotation||0,d=a(i);for(let o=0;o<d.cellsTall;o++)for(let l=0;l<d.cellsWide;l++)s[t.y+o][t.x+l].hasItem=!1,s[t.y+o][t.x+l].itemId="";if(c){const o=H.find(l=>l.sectionName===A);o&&(o.cells=s.map(l=>l.map(g=>({...g}))),oe([...H])),oe(l=>l.map(g=>g.sectionName===A?{...g,cells:s}:g))}else k(s);if(ee!=="placing-sections"||!se){const o=c?j.find(l=>l.name===A):xe(t,j);o.items=o.items.filter(l=>l.id!=n.id),console.log("DELETING ITEM section",n.id),console.log("SECTION ITEMS AFTER DELETE",o.items)}y(o=>(console.log("Removing item new",n.id),console.log("ITEMS AFTER REMOVE",o.filter(l=>l.id!=n.id)),o.filter(l=>l.id!=n.id))),_(o=>{const l=o.findIndex(g=>g.item.name==n.name&&!g.item.hasMoved);if(l!==-1){const g=[...o];return g[l].quantity>0&&(g[l].quantity+=1),g}else return[...o,new ue({item:new I({...n,hasMoved:!1}),quantity:1})]})}function Cn(n,t){const s=Array.from(c?H.find(g=>g.sectionName===A).cells:R);console.log("DELETING ITEM ROTATE",n.id,n.rotation),ke(!0);const a=g=>{const u=g%2===1;return{cellsWide:u?n.cellsTall:n.cellsLong,cellsTall:u?n.cellsLong:n.cellsTall}},i=n.rotation||0,d=a(i);for(let g=0;g<d.cellsTall;g++)for(let u=0;u<d.cellsWide;u++)console.log("Deleting cell",t.y+g,t.x+u),s[t.y+g][t.x+u].hasItem=!1,s[t.y+g][t.x+u].itemId="";if(c){const g=H.find(u=>u.sectionName===A);g&&(g.cells=s.map(u=>u.map(h=>({...h}))),oe([...H])),oe(u=>u.map(h=>h.sectionName===A?{...h,cells:s}:h))}else k(s);console.log("DELETING ITEM",n.id);const o=c?j.find(g=>g.name===A):xe(t,j);o.items=o.items.filter(g=>g.id!=n.id);const l=new f({x:t.x-o.cellId.x,y:t.y-o.cellId.y});n.sectionCell=l,o.items.push(n)}function Jt(n,t){const s=c?H.find(d=>d.sectionName===A).cells:R,a=Array.from(s);if(s[n.y]==null){console.log("Start cell is out of bounds",n),at();return}const i=At(n,t);a.forEach(d=>d.forEach(o=>{o.mouseOver=!1,o.canPlaceItem=!1,o.mouseOverLocation=""}));for(let d=0;d<t.cellsTall;d++)for(let o=0;o<t.cellsLong;o++)n.y+d<a.length&&n.x+o<a[n.y+d].length&&(t.cellsLong===1&&t.cellsTall===1?a[n.y+d][n.x+o].mouseOverLocation="single":t.cellsTall===1?o===0?a[n.y+d][n.x+o].mouseOverLocation="leftFull":o===t.cellsLong-1?a[n.y+d][n.x+o].mouseOverLocation="rightFull":a[n.y+d][n.x+o].mouseOverLocation="middleFull":t.cellsLong===1?d===0?a[n.y+d][n.x+o].mouseOverLocation="topFull":d===t.cellsTall-1?a[n.y+d][n.x+o].mouseOverLocation="bottomFull":a[n.y+d][n.x+o].mouseOverLocation="middleVFull":d===0&&o===0?a[n.y+d][n.x+o].mouseOverLocation="topLeftCorner":d===0&&o===t.cellsLong-1?a[n.y+d][n.x+o].mouseOverLocation="topRightCorner":d===t.cellsTall-1&&o===0?a[n.y+d][n.x+o].mouseOverLocation="bottomLeftCorner":d===t.cellsTall-1&&o===t.cellsLong-1?a[n.y+d][n.x+o].mouseOverLocation="bottomRightCorner":d===0?a[n.y+d][n.x+o].mouseOverLocation="top":d===t.cellsTall-1?a[n.y+d][n.x+o].mouseOverLocation="bottom":o===0?a[n.y+d][n.x+o].mouseOverLocation="left":o===t.cellsLong-1?a[n.y+d][n.x+o].mouseOverLocation="right":a[n.y+d][n.x+o].mouseOverLocation="middle",a[n.y+d][n.x+o].mouseOver=!0,a[n.y+d][n.x+o].canPlaceItem=i);if(c){const d=H.find(o=>o.sectionName===A);d&&(d.cells=a.map(o=>o.map(l=>({...l}))),oe([...H])),oe(o=>o.map(l=>l.sectionName===A?{...l,cells:a}:l))}else k(a)}function at(){const n=Array.from(c?H.find(t=>t.sectionName===A).cells:R);if(n.forEach(t=>t.forEach(s=>{s.mouseOver=!1,s.canPlaceItem=!1,s.mouseOverLocation=""})),c){const t=H.find(s=>s.sectionName===A);t&&(t.cells=n.map(s=>s.map(a=>({...a}))),oe([...H])),oe(s=>s.map(a=>a.sectionName===A?{...a,cells:n}:a))}else k(n)}r.useEffect(()=>{An(A,H,j)},[A]),r.useEffect(()=>{const n=()=>{const t=G.find(s=>s.id===L);console.log("Unselecting item",L),w(null),t&&(le(s=>[...s,t.id]),console.log("Unselecting item",t.id),setTimeout(()=>{le(s=>s.filter(a=>a!==t.id))},300))};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[L,G]);function Ut(n){w(null),le(t=>[...t,n]),console.log("Unselecting item",n),setTimeout(()=>{le(t=>t.filter(s=>s!==n))},300)}function Ht(n){const t=G.find(s=>s.id===L);console.log("Unselecting item",L),w(n),t&&(le(s=>[...s,t.id]),console.log("Unselecting item",t.id),setTimeout(()=>{le(s=>s.filter(a=>a!==t.id))},300))}function Nt(n){_(t=>[...t,n])}const Ue=n=>{console.log("Preventing scroll"),n.preventDefault(),n.stopPropagation(),window.scrollTo(0,0)};r.useEffect(()=>(ft?(window.addEventListener("scroll",Ue),window.addEventListener("touchmove",Ue,{passive:!1})):(window.removeEventListener("scroll",Ue),window.removeEventListener("touchmove",Ue)),()=>{window.removeEventListener("scroll",Ue),window.removeEventListener("touchmove",Ue)}),[ft]);async function Rn(n){const t=[];z(!0);for(const i of n){const d=i.name,o=new f({x:i.sectionCell.x,y:i.sectionCell.y}),l=new F({name:d,cellId:o,cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:[],startingItems:[],items:[]});t.push(l)}let s=0,a=0;for(const i of t)console.log("Generating cells for section",i.name,"at",i.cellId,"with size",i.cellsLong,"x",i.cellsTall),console.log("Needed section Width:",i.cellsLong+i.cellId.x,"Current width:",s),i.cellsLong+i.cellId.x>s&&(console.log("Added section Width:",i.cellsLong+i.cellId.x),s+=i.cellsLong+i.cellId.x-s),console.log("Needed section Height:",i.cellsTall+i.cellId.y,"Current height:",a),i.cellsTall+i.cellId.y>a&&(console.log("Added section Height:",i.cellsTall+i.cellId.y),a+=i.cellsTall+i.cellId.y-a);await zn(U,q,t,s,a),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=create-area&stage=modify-sections`}async function kn(n,t){const s=[];z(!0);for(const a of t){const i=a.name,d=new f({x:a.cellId.x,y:a.cellId.y});console.log("Saving section modifier items for section",i,a.items.map(l=>l.name),"at cell",d);const o=new F({name:i,cellId:d,cellsLong:a.cellsLong,cellsTall:a.cellsTall,startingItems:[],items:[],modifierItems:a.items.map(l=>new $({cell:new f({x:l.sectionCell.x,y:l.sectionCell.y}),item:new I({...l,isSectionModifier:!0})}))});s.push(o)}console.log("Saving section modifier items",s),await qn(U,q,s),console.log("Section modifier items saved successfully"),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=create-area&stage=placing-items`}async function Xt(n,t){z(!0);const s=[];for(const a of n){const i=a.name,d=new f({x:a.cellId.x,y:a.cellId.y}),o=new F({name:i,cellId:d,cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(l=>new $({cell:new f({x:l.sectionCell.x,y:l.sectionCell.y}),item:new I({...l,starterItem:!0})})),items:[]});s.push(o)}console.log("Saving area sections",s),localStorage.setItem("screenshotSections",s.map(a=>JSON.stringify(a.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",s.map(a=>JSON.stringify(a.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async a=>{if(console.log("Storage event",a),a.key==="screenshot"){const i=new $n({id:q,name:lt.name,sections:s,templates:lt?.templates||[],previewImage:a.newValue,width:lt.width,height:lt.height,inventoryItems:t.map(d=>new ue({item:new I({...d.item,starterItem:!0}),quantity:d.quantity}))});await Kn(U,i),console.log("Area saved successfully"),z(!1),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=view-area`}})}function Dn(n){const t=Array.from(c?H.find(s=>s.sectionName===A).cells:R);if(t[n.y]!=null)if(t[n.y][n.x].mouseOver=!0,t[n.y][n.x].canPlaceItem=!0,t[n.y][n.x].mouseOverLocation="single",pt(s=>[...s,n]),c){const s=H.find(a=>a.sectionName===A);s&&(s.cells=t.map(a=>a.map(i=>({...i}))),oe([...H])),oe(a=>a.map(i=>i.sectionName===A?{...i,cells:t}:i))}else k(t)}function Pn(n){const t=Array.from(c?H.find(o=>o.sectionName===A).cells:R);ke(!0);const s=[];ht.forEach(o=>{s.some(l=>l.toId()===o.toId())||s.push(o)}),pt([]),console.log("PLACING HUGHCELLS");const a=[],i=Z.findIndex(o=>o.item.name==n.name&&!o.item.hasMoved);let d=i!==-1?Z[i].quantity:0;s.forEach(o=>{const l=new I({...n});if(l.id=l.name+Math.floor(Math.random()*1e5).toString(),console.log("Placing item",l.name,"at",o.toId(),"CAN PLACE?",Vt(t,o,l)),Vt(t,o,l)&&d!=0){if(i!==-1&&(d-=1),ee!=="placing-sections"||!se){const u=c?j.find(S=>S.name===A):xe(o,j);console.log("Adding item to section",u.name,"at",u.cellId,"with cell",o.toId(),o.x-u.cellId.x,o.y-u.cellId.y);const h=new f({x:o.x-u.cellId.x,y:o.y-u.cellId.y});l.sectionCell=h,console.log("Adding item to section",u.name,"at",h,l),u.items.push(l),console.log("SECTION ITEMS",u.items.map(S=>S.name))}else l.sectionCell=new f({x:o.x,y:o.y});for(let u=0;u<n.cellsTall;u++)for(let h=0;h<n.cellsLong;h++)t[o.y+u][o.x+h].hasItem=!0,t[o.y+u][o.x+h].itemId=l.id;l.hasMoved=!0,l.starterItem=!0,l.isDisplayItem=!1,l.initialElement=document.querySelector(`.App #${o.toId()}.cell:not(.cell-border)`);const g=new I({...l});a.push(g)}});for(const o of a)console.log("Adding item to items",o.id),y(l=>[...l,o]);if(i!==-1&&_(o=>{const l=[...o];return l[i].quantity>0&&(l[i].quantity=d,l[i].quantity==0&&l.splice(i,1)),l}),d==0&&Le(null),c){const o=H.find(l=>l.sectionName===A);o&&(o.cells=t.map(l=>l.map(g=>({...g}))),oe([...H])),oe(l=>l.map(g=>g.sectionName===A?{...g,cells:t}:g))}else k(t);fe(j)}function Wn(n,t,s){z(!0);const a=[];for(const i of n){const d=i.name,o=new f({x:i.cellId.x,y:i.cellId.y}),l=i.items.filter(h=>h.isBooth),g=i.items.filter(h=>!h.isBooth),u=new F({name:d,cellId:o,cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:g.map(h=>new $({cell:new f({x:h.sectionCell.x,y:h.sectionCell.y}),item:new I({...h,displayItem:!0})})),booths:l.map(h=>new je({id:h.name+Math.floor(Math.random()*1e5).toString(),name:h.name,cell:new f({x:h.sectionCell.x,y:h.sectionCell.y}),cellsLong:h.cellsLong,cellsTall:h.cellsTall,user:h.boothUser})),items:[]});a.push(u)}console.log("Saving area sections",a),localStorage.setItem("screenshotSections",a.map(i=>JSON.stringify(i.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",a.map(i=>JSON.stringify(i.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async i=>{if(console.log("Storage event",i),i.key==="screenshot"){const d=new Pe({id:s.id,name:s.name,sections:a,areaId:q,previewImage:i.newValue,inventoryItems:t.map(o=>new ue({item:new I({...o.item,starterItem:!0}),quantity:o.quantity}))});await We(U,d),console.log("Booth Map saved successfully"),z(!1),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=view-boothMap&boothMapId=${Pt}`}})}return r.useEffect(()=>{const n=t=>{t.key==="Escape"&&(console.log("Escape key pressed"),ht.length>0?(console.log("There are highlighted cells"),pt([]),at()):Le(null))};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[ht]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"App",children:[e.jsx("h1",{className:"title",children:"LayItOut"}),e.jsx("br",{}),Qe&&e.jsxs("div",{className:"area-creation",children:[It?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"area-creation-title",children:"You have already picked a booth"}),e.jsxs("label",{htmlFor:"",children:["Contact ",dn?.supportEmail," to change booths"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"area-creation-title",children:"Picking Booth"}),e.jsx("label",{htmlFor:"",children:"Tap on an open booth then click on the checkmark to pick a booth"})," "]}),e.jsxs("label",{htmlFor:"",children:["Booth Size: ",Se?.plotWidth,"ft x ",Se?.plotHeight,"ft"]}),e.jsx("br",{})]}),tt&&e.jsxs("div",{className:"area-creation",children:[e.jsx("h2",{className:"area-creation-title",children:"Create Booth Map"}),e.jsx("label",{htmlFor:"",children:"Create a booth map by placing items and then creating and placing booths, same way you create and place items"})]}),se&&e.jsxs("div",{className:"area-creation",children:[e.jsx("h2",{className:"area-creation-title",children:"Create Area"}),e.jsx("label",{htmlFor:"",children:ee=="placing-sections"?"Create new sections and place them":ee=="modify-sections"?"Add walls and doors to sections":"Add items to the inventory and place items"})]}),(J||B)&&e.jsxs("div",{className:"template-name-row",children:[e.jsx("label",{htmlFor:"template-name",children:"Template Name:"}),e.jsx("input",{type:"text",id:"template-name",name:"template-name",onChange:n=>Dt(n.target.value),value:Je})]}),(Q||Ye)&&e.jsxs("div",{className:"design-name-row",children:[e.jsxs("label",{htmlFor:"design-name",children:["Design Name: ",Ze]}),Q&&De&&e.jsxs("p",{children:["Design was submitted on ",Bt?.toLocaleDateString()]})]}),(J||B)&&e.jsxs("div",{className:"template-creation",children:[e.jsxs("button",{className:"action-btn",onClick:()=>{if(Je.trim()==""){alert("Please enter a template name");return}if(Me.some(n=>n.name===Je&&(B?n.id!==Wt.id:!0))){alert("Template with this name already exists");return}B?(z(!0),setTimeout(async()=>{const n=j.map(t=>new F({name:t.name,cellId:new f({x:K.find(s=>s.name==t.name).cellId.x,y:K.find(s=>s.name==t.name).cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,modifierItems:t.modifierItems,startingItems:t.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async t=>{if(console.log("Storage event",t),t.key==="screenshot"){pe(!1);const s=Me.map(a=>a.id===Wt.id?(console.log("SECTION",j),new ve({name:Je,inventoryItems:Z,previewImage:t.newValue,sections:j.map(i=>new F({name:i.name,cellId:new f({x:a.sections.find(d=>d.name==i.name).cellId.x,y:a.sections.find(d=>d.name==i.name).cellId.y}),cellsLong:i.cellsLong,modifierItems:i.modifierItems,cellsTall:i.cellsTall,startingItems:i.items.map(d=>new $({cell:new f({x:d.sectionCell.x,y:d.sectionCell.y}),item:new I({...d,starterItem:!0})}))})),id:a.id})):new ve({name:a.name,previewImage:a.previewImage,inventoryItems:a.inventoryItems,sections:a.sections.map(i=>new F({name:i.name,cellId:new f({x:i.cellId.x,y:i.cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(d=>new $({cell:new f({x:d.cell.x,y:d.cell.y}),item:new I({...d.item})}))})),id:a.id}));qe(U,q,s).then(()=>{console.log("Template updated successfully"),z(!1);const a=new URLSearchParams(window.location.search),i=a.get("companyId"),d=a.get("areaId");window.location.href=`/Layout/?companyId=${i}&areaId=${d}&type=view-area`})}})},500)):(z(!0),setTimeout(async()=>{const n=j.map(t=>new F({name:t.name,cellId:new f({x:K.find(s=>s.name==t.name).cellId.x,y:K.find(s=>s.name==t.name).cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,modifierItems:t.modifierItems,startingItems:t.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async t=>{if(console.log("Storage event",t),t.key==="screenshot"){pe(!1);const s=new ve({name:Je,previewImage:t.newValue,inventoryItems:Z,sections:j.map(i=>new F({name:i.name,cellId:new f({x:K.find(d=>d.name==i.name).cellId.x,y:K.find(d=>d.name==i.name).cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.items.map(d=>new $({cell:new f({x:d.sectionCell.x,y:d.sectionCell.y}),item:new I({...d,starterItem:!0})}))})),id:Je+(Math.random()*1e4).toString()}),a=[...Me.map(i=>new ve({name:i.name,previewImage:i.previewImage,inventoryItems:i.inventoryItems,sections:i.sections.map(d=>new F({name:d.name,cellId:new f({x:d.cellId.x,y:d.cellId.y}),cellsLong:d.cellsLong,cellsTall:d.cellsTall,modifierItems:d.modifierItems,startingItems:d.startingItems.map(o=>new $({cell:new f({x:o.cell.x,y:o.cell.y}),item:new I({...o.item})}))})),id:i.id})),s];qe(U,q,a).then(()=>{console.log("Template updated successfully"),z(!1);const i=new URLSearchParams(window.location.search),d=i.get("companyId"),o=i.get("areaId");window.location.href=`/Layout/?companyId=${d}&areaId=${o}&type=view-area`})}})},500))},children:[J?"Create":"Save"," Template"]}),e.jsx("button",{className:"action-btn",onClick:()=>{const n=new URLSearchParams(window.location.search),t=n.get("companyId"),s=n.get("areaId");window.location.href=`/Layout/?companyId=${t}&areaId=${s}&type=view-area`},children:"Cancel"})]}),Ve&&!De&&e.jsxs("div",{className:"template-creation",children:[In&&e.jsx("button",{className:"action-btn",onClick:()=>{z(!0),setTimeout(async()=>{const n=j.map(t=>new F({name:t.name,cellId:new f({x:K.find(s=>s.name==t.name).cellId.x,y:K.find(s=>s.name==t.name).cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,modifierItems:t.modifierItems,startingItems:t.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async t=>{if(console.log("Storage event",t),t.key==="screenshot"){pe(!1);const s=new Mt({name:Ze,previewImage:t.newValue,submitted:!1,dateSubmitted:null,areaId:q,inventoryItems:Z,sections:j.map(a=>new F({name:a.name,cellId:new f({x:K.find(i=>i.name==a.name).cellId.x,y:K.find(i=>i.name==a.name).cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(i=>new $({cell:new f({x:i.sectionCell.x,y:i.sectionCell.y}),item:new I({...i,starterItem:!0})}))})),id:ot});Et(U,q,s).then(()=>{console.log("Design updated successfully"),ke(!1),z(!1)})}})},500)},children:"Save"}),e.jsx("button",{className:"action-btn",onClick:()=>{z(!0),setTimeout(async()=>{const n=j.map(t=>new F({name:t.name,cellId:new f({x:K.find(s=>s.name==t.name).cellId.x,y:K.find(s=>s.name==t.name).cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,modifierItems:t.modifierItems,startingItems:t.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async t=>{if(console.log("Storage event",t),t.key==="screenshot"){pe(!1);const s=new Mt({name:Ze,previewImage:t.newValue,submitted:!0,dateSubmitted:new Date,areaId:q,inventoryItems:Z,sections:j.map(a=>new F({name:a.name,cellId:new f({x:K.find(i=>i.name==a.name).cellId.x,y:K.find(i=>i.name==a.name).cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(i=>new $({cell:new f({x:i.sectionCell.x,y:i.sectionCell.y}),item:new I({...i,starterItem:!0})}))})),id:ot});Et(U,q,s).then(()=>{console.log("Design updated successfully"),ke(!1),z(!1),Ft(!0),Ot(new Date)})}})},500)},children:"Submit"})]}),Ve&&De&&e.jsxs("div",{className:"area-creation",children:[e.jsxs("label",{htmlFor:"",children:["Design was submitted on ",Bt?.toLocaleDateString()]}),e.jsx("br",{})]}),!Q&&!Ee&&!be&&!Qe&&!Ye&&!(De&&Ve)&&e.jsxs("div",{className:"place-mode-row",children:[e.jsx("label",{htmlFor:"tap-and-place-mode",children:"Place Mode: "}),e.jsxs("select",{id:"tap-and-place-mode",name:"tap-and-place-mode",value:Te?"tap":"drag",onChange:n=>Ct(n.target.value==="tap"),className:"place-mode-select",children:[e.jsx("option",{value:"drag",children:"Drag and Drop"}),e.jsx("option",{value:"tap",children:"Tap and Place"})]})]}),ut&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"loader-backdrop",children:e.jsx("div",{className:"loader"})})})," ",e.jsxs("div",{className:"layout",children:[!Q&&!Ee&&!be&&!Qe&&!Ye&&!(De&&Ve)&&e.jsx(ll,{canEditItem:se&&ee=="placing-items"||et,onEditItem:n=>{jn(n),Tt.current?.showModal()},setSelectedItem:Le,tapAndPlaceMode:Te,isModifyingSections:se&&ee=="modify-sections",isViewingDesign:Q,isEditingTemplate:B,isCreatingTemplate:J,maxHeight:c?200:v*M,showAddCustomItem:()=>{ee=="placing-sections"&&se?xt.current?.showModal():ee=="placing-items"&&se||et?vt.current?.showModal():wt.current?.showModal()},addDraggingItem:Mn,removeItem:Zt,inventoryItems:Z.map(n=>new ue({item:new I({...n.item,displayItem:!0}),quantity:n.quantity}))}),be&&ie?e.jsx(ul,{onDeleteVendor:async n=>{z(!0);const t=new Pe({...ie,vendors:ie.vendors.filter(s=>s.id!==n),sections:ie.sections.map(s=>new F({...s,booths:s.booths.map(a=>a.user?.id===n?new je({...a,user:null,initialElement:a.initialElement??void 0}):a)}))});await We(U,t),Re(t),window.location.reload()},onEditVendor:n=>{vn(n),St.current?.showModal()},boothMap:ie,vendors:ie?.vendors??[],maxHeight:c?void 0:v*M,onAddVendor:()=>{bt.current?.showModal()}}):null,c?e.jsxs("div",{className:"mobile-areas",style:{height:X+"px"},children:[j.length>1&&e.jsx("img",{src:rt,onClick:()=>{const n=j.findIndex(s=>s.name==A);if(n===-1)return;const t=(n-1+j.length)%j.length;V(j[t].name),console.log("Changing viewing section to",j[t].name)},className:"back-mobile-areas"}),Ge.map((n,t)=>e.jsx(zt,{width:n.width,height:n.height,cells:Gt(H.find(s=>s.sectionName==n.sectionName).cells),id:n.sectionName,visibile:A==null?!0:n.sectionName==A,section:n.sectionName},t)),j.length>1&&e.jsx("img",{src:rt,onClick:()=>{const n=j.findIndex(s=>s.name==A);if(n===-1)return;const t=(n+1)%j.length;V(j[t].name),console.log("Changing viewing section to",j[t].name)},className:"forward-mobile-areas"})]}):e.jsx(zt,{width:P*M,height:v*M,cells:Gt(R)}),(ee=="placing-items"||!se)&&e.jsx(pl,{maxHeight:c?void 0:v*M})]}),be&&e.jsx("div",{className:"design-view",children:e.jsx("button",{className:"action-btn",onClick:()=>{const n=j.map(t=>new F({name:t.name,cellId:new f({x:K.find(s=>s.name==t.name).cellId.x,y:K.find(s=>s.name==t.name).cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,modifierItems:t.modifierItems,booths:t.booths,startingItems:t.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("printSections",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),window.open(window.location.origin+`/Print/?companyId=${U}&areaId=${q}&designName=${ie?.name}`,"_blank")},children:"Print"})}),Q&&e.jsxs("div",{className:"design-view",children:[e.jsx("button",{className:"action-btn",onClick:()=>{const n=j.map(t=>new F({name:t.name,cellId:new f({x:K.find(s=>s.name==t.name).cellId.x,y:K.find(s=>s.name==t.name).cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,modifierItems:t.modifierItems,booths:t.booths,startingItems:t.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("printSections",n.map(t=>JSON.stringify(t.toJSON())).join("LAYOUTSEPARATOR")),window.open(window.location.origin+`/Print/?companyId=${U}&areaId=${q}&designName=${Ze}&designId=${ot}`,"_blank")},children:"Print"}),e.jsx("button",{className:"action-btn",onClick:()=>{const n=new ve({name:Ze,previewImage:nt.previewImage,inventoryItems:nt.inventoryItems,sections:nt.sections,id:nt.name+(Math.random()*1e4).toString()}),t=[...Me.map(s=>new ve({name:s.name,previewImage:s.previewImage,inventoryItems:s.inventoryItems,sections:s.sections.map(a=>new F({name:a.name,cellId:new f({x:a.cellId.x,y:a.cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.startingItems.map(i=>new $({cell:new f({x:i.cell.x,y:i.cell.y}),item:new I({...i.item})}))})),id:s.id})),n];qe(U,q,t).then(()=>{console.log("Template updated successfully"),Oe(t),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=edit-template&templateId=${n.id}`})},children:"Turn into a Template"}),e.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=desings"},children:"Back"})]}),be&&e.jsx("div",{className:"design-view",children:e.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=boothmaps"},children:"Back"})}),Ee&&e.jsxs("div",{className:"design-view",children:[e.jsx("button",{className:"action-btn",onClick:()=>{window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=edit-area`},children:"Edit Area"}),e.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=areas"},children:"Back"})]}),et&&e.jsxs("div",{className:"design-view",children:[e.jsx("button",{className:"action-btn",onClick:async()=>{await Xt(j,Z)},children:"Save Area"}),e.jsx("button",{className:"action-btn",onClick:async()=>{z(!0),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=view-area`},children:"Back"})]}),se&&e.jsxs("div",{className:"design-view",children:[e.jsx("button",{className:"action-btn",onClick:()=>{ee=="placing-sections"?Rn(G.filter(n=>n.isSectionItem)):ee=="modify-sections"?kn(G.filter(n=>n.isSectionModifier),j):ee=="placing-items"&&Xt(j,Z)},children:ee=="placing-items"?"Create Area":"Next"}),e.jsx("button",{className:"action-btn",onClick:async()=>{z(!0),await Jn(U,q),window.location.href="/"},children:"Cancel"})]}),tt&&e.jsxs("div",{className:"design-view",children:[e.jsx("button",{className:"action-btn",onClick:()=>{console.log("Creating booth map with sections",j,"and inventory items",Z,"and boothMap",ie),Wn(j,Z,ie)},children:"Create Booth Map"}),e.jsx("button",{className:"action-btn",onClick:async()=>{z(!0),await Un(U,q,Pt),window.location.href="/?view=boothmaps"},children:"Cancel"})]})]}),e.jsxs("div",{children:[j.map(n=>e.jsx(Gn,{takingPhoto:!1,section:n,visible:A==null?!0:n.name==A,cellSize:M},n.cellId.toId())),G.map(n=>e.jsx(Vn,{isPlacingItem:Ie!=null,isCreatingArea:se,isCreatingTemplate:J||B,cellSize:M,isViewingDesign:Q||Ee||be||Qe||Ye||De&&Ve,removeItem:Zt,visible:c?!n.hasMoved&&!n.starterItem?!0:A==null?!1:n.isSectionModifier?j.find(t=>t.name==A)?.modifierItems.some(t=>t.item.id===n.id):n.starterItem?j.find(t=>t.name==A)?.startingItems.some(t=>t.item.id===n.id):j.find(t=>t.name==A)?.items.some(t=>t.id===n.id):!0,item:n,canPlaceItem:At,placeItem:Yt,deleteItemRotate:Cn,highlightCells:Jt,unHighlightCells:at,deleteItem:En,isSelected:L===n.id,onSelect:Ht,isUnselecting:W.includes(n.id),onDeselect:()=>Ut(n.id)},n.id)),Ke.map(n=>(console.log("CAN PICK BOOTH",n.cellsLong==Se?.plotWidth&&n.cellsTall==Se.plotHeight,"BOOTH",n,"VENDOR",Se),e.jsx(Yn,{canPick:be||It||n.cellsLong==Se?.plotWidth&&n.cellsTall==Se.plotHeight,visible:c?A==null?!1:j.find(t=>t.name==A)?.booths.some(t=>t.id===n.id)??!1:!0,booth:n,isViewingBooth:be,isPublicViewingBooth:Ye,hasPickedBooth:It,isSelected:L==n.id,cellSize:M,onSelect:Ht,isUnselecting:W.includes(n.id),onDeselect:()=>Ut(n.id),onPickBooth:async t=>{z(!0);const s=j.map(i=>i.name===A?new F({...i,booths:i.booths.map(d=>d.id===t?new je({...d,user:Se,initialElement:d.initialElement??void 0}):d)}):i.booths.some(d=>d.id===t)?new F({...i,booths:i.booths.map(d=>d.id===t?new je({...d,user:Se,initialElement:d.initialElement??void 0}):d)}):i);console.log("Updated sections",s),fe(s);const a=new Pe({...ie,sections:s});await We(U,a),window.location.reload(),z(!1)},onRemoveVendorFromBooth:()=>{z(!0);const t=j.map(a=>new F({...a,booths:a.booths.map(i=>i.user?.id===n.user?.id?new je({...i,user:null,initialElement:i.initialElement??void 0}):i)})),s=new Pe({...ie,sections:t});We(U,s).then(()=>{window.location.reload()})},onAddVendorToBooth:()=>{bn(n),jt.current?.showModal()}},n.id)))]}),c&&!ut&&e.jsx("div",{className:"layout-icon",onClick:()=>{Be.current?.showModal(),he(!0),console.log("Showing layout dialog")},children:e.jsx("img",{src:sl,alt:""})}),!ut&&!(J||et||B||Q||tt||se||be||Qe||Ye||De&&Ve)&&e.jsx("div",{className:"template-icon",onClick:()=>{ye.current?.showModal(),Fe(!0),console.log("Showing template dialog")},children:e.jsx("img",{src:il,alt:""})}),e.jsx(al,{isViewingArea:Ee,dialogRef:ye,isOpen:_e,closeDialog:()=>{ye.current?.close(),Fe(!1)},duplicateTemplate:n=>{const t=new ve({name:n.name+" Copy",previewImage:n.previewImage,inventoryItems:n.inventoryItems,sections:n.sections,id:n.name+"Copy"+(Math.random()*1e4).toString()}),s=[...Me.map(a=>new ve({name:a.name,previewImage:a.previewImage,inventoryItems:a.inventoryItems,sections:a.sections.map(i=>new F({name:i.name,cellId:new f({x:i.cellId.x,y:i.cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(d=>new $({cell:new f({x:d.cell.x,y:d.cell.y}),item:new I({...d.item})}))})),id:a.id})),t];qe(U,q,s).then(()=>{ye.current?.close(),console.log("Template updated successfully"),Oe(s),Fe(!1),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=edit-template&templateId=${t.id}`})},templates:Me,selectTemplate:n=>{z(!0),setTimeout(async()=>{const t=n.sections.map(s=>new F({name:s.name,cellId:new f({x:n.sections.find(a=>a.name==s.name).cellId.x,y:n.sections.find(a=>a.name==s.name).cellId.y}),cellsLong:s.cellsLong,cellsTall:s.cellsTall,modifierItems:s.modifierItems,startingItems:s.startingItems.map(a=>new $({cell:new f({x:a.cell.x,y:a.cell.y}),item:new I({...a.item,starterItem:!0})}))}));localStorage.setItem("screenshotSections",t.map(s=>JSON.stringify(s.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",t.map(s=>JSON.stringify(s.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async s=>{if(console.log("Storage event",s),s.key==="screenshot"){pe(!1);const a=new Mt({name:Ze,previewImage:s.newValue,areaId:q,submitted:!1,dateSubmitted:null,inventoryItems:n.inventoryItems,sections:n.sections.map(i=>new F({name:i.name,cellId:new f({x:n.sections.find(d=>d.name==i.name).cellId.x,y:n.sections.find(d=>d.name==i.name).cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(d=>new $({cell:new f({x:d.cell.x,y:d.cell.y}),item:new I({...d.item,starterItem:!0})}))})),id:ot});console.log("UPDATED DESIGN",a),Et(U,q,a).then(()=>{console.log("Design updated successfully"),ke(!1),z(!1),window.location.reload()})}})},500)}}),e.jsx(ol,{dialogRef:Be,closeDialog:()=>{Be.current?.close(),he(!1)},areaPreview:hn||""}),e.jsx(cl,{canBeBooth:tt,dialogRef:wt,addInventoryItem:Nt,closeDialog:()=>{wt.current?.close()}}),e.jsx(rl,{dialogRef:xt,closeDialog:()=>{xt.current?.close()},addSection:Nt}),e.jsx(dl,{dialogRef:vt,closeDialog:()=>{vt.current?.close()},addInventoryItem:Nt}),e.jsx(ml,{placeMultiItem:Pn,addHighlightedCell:Dn,item:Ie,setSelectingItem:()=>{Le(null)},canPlaceItem:At,placeItem:Yt,highlightCells:Jt,unHighlightCells:at,cellSize:M}),e.jsx(fl,{dialogRef:bt,closeDialog:()=>{bt.current?.close()},addVendor:async n=>{const t=new Pe({...ie,vendors:[...ie.vendors,n]});Re(t),await We(U,t)}}),e.jsx(hl,{oldVendor:xn,dialogRef:St,closeDialog:()=>{St.current?.close()},editVendor:async n=>{const t=new Pe({...ie,vendors:ie.vendors.map(s=>s.id===n.id?n:s)});Re(t),await We(U,t)}}),e.jsx(yl,{dialogRef:Tt,closeDialog:()=>{Tt.current?.close()},deleteInventoryItem:n=>{_(t=>t.filter(s=>s.item.id!==n.item.id))},editInventoryItem:n=>{_(t=>t.map(s=>s.item.id===n.item.id?n:s))},selectedItem:Sn}),e.jsx(Il,{dialogRef:jt,vendors:ie?.vendors.filter(n=>!Nn(n,ie))??[],closeDialog:()=>{jt.current?.close()},addVendorToBooth:async n=>{z(!0);const t=j.map(a=>a.name===A?new F({...a,booths:a.booths.map(i=>i.id===yt.id?new je({...i,user:n,initialElement:i.initialElement??void 0}):i)}):a.booths.some(i=>i.id===yt.id)?new F({...a,booths:a.booths.map(i=>i.id===yt.id?new je({...i,user:n,initialElement:i.initialElement??void 0}):i)}):a);console.log("Updated sections",t),fe(t);const s=new Pe({...ie,sections:t});await We(U,s),window.location.reload(),z(!1)}}),ft&&e.jsx("iframe",{id:"screenshot-iframe",title:"Screenshot Iframe",src:window.location.origin+"/Preview/",width:N*M+20,height:C*M+20}),e.jsx(wl,{dialogRef:Lt,closeDialog:()=>{Lt.current?.close()}})]})}

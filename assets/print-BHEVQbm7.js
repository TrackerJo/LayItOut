import{c as W,j as i,r}from"./index-QIV6qY6h.js";import{A as k,S as M,D as q}from"./section-Bl4_lSg3.js";import{S as h,C as f,I as p,a1 as z,m as F,f as $}from"./firestore-Bko8voo4.js";W.createRoot(document.getElementById("root")).render(i.jsx(B,{}));function B(){const[G,J]=r.useState(/Mobi|Android/i.test(navigator.userAgent)),[S,L]=r.useState(0),[x,T]=r.useState(0),[A,y]=r.useState([]),[C,v]=r.useState([]),u=10,[j,w]=r.useState([]),[V,b]=r.useState(""),[X,N]=r.useState(""),[E,R]=r.useState(""),[D,Y]=r.useState(!0);function O(t,a){for(const o of a)if(t.x>=o.cellId.x&&t.x<o.cellId.x+o.cellsLong&&t.y>=o.cellId.y&&t.y<o.cellId.y+o.cellsTall)return o;return null}function P(t){let a=S,o=x;const d=[];for(const e of t)console.log("Generating cells for section",e.name,"at",e.cellId,"with size",e.cellsLong,"x",e.cellsTall),console.log("Needed section Width:",e.cellsLong+e.cellId.x,"Current width:",a),e.cellsLong+e.cellId.x>a&&(console.log("Added section Width:",e.cellsLong+e.cellId.x),a+=e.cellsLong+e.cellId.x-a),console.log("Needed section Height:",e.cellsTall+e.cellId.y,"Current height:",o),e.cellsTall+e.cellId.y>o&&(console.log("Added section Height:",e.cellsTall+e.cellId.y),o+=e.cellsTall+e.cellId.y-o);L(a),T(o),[...Array(o).keys()].map(e=>{const m=[];[...Array(a).keys()].map(l=>{m.push({id:new f({x:l,y:e}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:O(new f({x:l,y:e}),t)!=null,size:u})}),d.push(m)}),y([...d]),setTimeout(()=>{const e=[],m=[...t];for(const l of m)l.cellElement=document.querySelector(`.App #${l.cellId.toId()}.cell:not(.cell-border)`),e.push(...l.startingItems.map(c=>new $({cell:new f({x:l.cellId.x+c.cell.x,y:l.cellId.y+c.cell.y}),item:new p({id:c.item.id,name:c.item.name,cellsLong:c.item.cellsLong,cellsTall:c.item.cellsTall,icon:c.item.icon,initialElement:document.querySelector(`.App #${c.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:c.item.moveable,rotation:c.item.rotation||0})})));w([...m]);for(const l of e){const c=g=>{const I=g%2===1;return{cellsLong:I?l.item.cellsTall:l.item.cellsLong,cellsTall:I?l.item.cellsLong:l.item.cellsTall}},s=l.item.rotation||0,n=c(s);for(let g=0;g<n.cellsTall;g++)for(let I=0;I<n.cellsLong;I++)d[l.cell.y+g][l.cell.x+I].hasItem=!0,d[l.cell.y+g][l.cell.x+I].itemId=l.item.id;l.item.initialElement=document.querySelector(`.App #${l.cell.toId()}.cell:not(.cell-border)`),v(g=>[...g,l.item])}y([...d]),setTimeout(()=>{window.print(),window.close()},500)},100)}async function H(){const t=new URLSearchParams(window.location.search),a=t.get("companyId"),o=t.get("areaId"),d=t.get("designName"),e=t.get("designId");if(!a||!o||!d||!e){alert("Invalid URL parameters");return}b(a),N(o),R(d);const m=[];let l=localStorage.getItem("printSections");console.log("Screenshot sections from localStorage",l),l=l?.split("LAYOUTSEPARATOR")||"";const c=[];for(const s of l)console.log("Section string",s),c.push(h.fromJSON(s));w([...c.map(s=>new h({name:s.name,cellId:new f({x:s.cellId.x,y:s.cellId.y}),cellsLong:s.cellsLong,cellsTall:s.cellsTall,startingItems:s.startingItems,modifierItems:s.modifierItems,items:s.startingItems.map(n=>new p({id:n.item.id,name:n.item.name,sectionCell:n.cell,cellsLong:n.item.cellsLong,cellsTall:n.item.cellsTall,icon:n.item.icon,moveable:n.item.moveable,starterItem:n.item.starterItem,rotation:n.item.rotation}))}))]),m.push(...c.map(s=>new h({name:s.name,cellId:new f({x:s.cellId.x,y:s.cellId.y}),cellsLong:s.cellsLong,cellsTall:s.cellsTall,startingItems:s.startingItems,modifierItems:s.modifierItems,items:s.startingItems.map(n=>new p({id:n.item.id,name:n.item.name,sectionCell:n.cell,cellsLong:n.item.cellsLong,cellsTall:n.item.cellsTall,icon:n.item.icon,moveable:n.item.moveable,starterItem:n.item.starterItem,rotation:n.item.rotation}))}))),console.log("SECTIONS TO GENERATE",m),P(m)}r.useEffect(()=>{H();async function t(){const a=z();F("dMjfwNN0XFes0WxUH8h1",a)}t()},[]);function U(t){let a=[];return t.map(o=>a=[...a,...o]),a}return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"App",children:[D&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"loader-backdrop"}),i.jsx("div",{className:"loader"})]}),i.jsx("div",{className:"layout",children:i.jsx(k,{width:S*u,height:x*u,cells:U(A)})})]}),j.map(t=>i.jsx(M,{takingPhoto:!1,section:t,visible:!0,cellSize:u},t.cellId.toId())),C.map(t=>i.jsx(q,{isCreatingArea:!1,isCreatingTemplate:!1,cellSize:u,isViewingDesign:!0,removeItem:()=>{},visible:!0,item:t,canPlaceItem:()=>!1,placeItem:()=>{},deleteItemRotate:()=>{},highlightCells:()=>{},unHighlightCells:()=>{},deleteItem:()=>{},isSelected:!1,onSelect:()=>{},isUnselecting:!1,onDeselect:()=>{}},t.id)),i.jsxs("div",{className:"print-footer",children:[i.jsx("p",{children:"Printed Layout from LayItOut.com"}),i.jsxs("p",{children:["Design Name: ",E]}),i.jsxs("p",{children:["Generated on: ",new Date().toLocaleString()]})]})]})}

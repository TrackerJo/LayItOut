import{c as k,j as e,r as s}from"./index-_mSZXrjJ.js";import{Y as E,Z as U,$ as R,a0 as B}from"./firestore-CT4Y-ESF.js";k.createRoot(document.getElementById("root")).render(e.jsx(O,{}));function O(){const[g,r]=s.useState("select"),[l,p]=s.useState(""),[h,y]=s.useState(""),[n,x]=s.useState(""),[w,v]=s.useState(""),[c,C]=s.useState(""),[j,b]=s.useState([]),[f,N]=s.useState(!0),[P,d]=s.useState(!1),[S,o]=s.useState(!1);s.useEffect(()=>{async function a(){const t=await E();b(t),console.log(t),N(!1)}a()},[]);async function I(){if(l.trim()===""){alert("Please enter an email address");return}if(n.trim()===""){alert("Please enter a password");return}if(o(!0),!await U(l,n)){alert("Invalid email or password. Please try again."),o(!1);return}const t=j.find(i=>i.users.includes(localStorage.getItem("userId")));if(!t){alert("You are not part of any company. Please contact your administrator."),o(!1);return}localStorage.setItem("companyId",t.id),o(!1);const u=new URLSearchParams(window.location.search).get("redirect");u?window.location.href=u.replace(/~/g,"&"):window.location.href="/"}async function F(){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)){alert("Please enter a valid email address");return}if(n.length<6){alert("Password must be at least 6 characters long");return}if(n!==w){alert("Passwords do not match");return}if(c.trim()===""){alert("Please enter a company code");return}const t=j.find(L=>L.code===c);if(!t){alert("Invalid company code");return}d(!0);const m=await R(l,n,h);if(m===!1){alert("Error registering user. Please try again."),d(!1);return}t.users.push(m.id),await B(t),localStorage.setItem("companyId",t.id),d(!1);const i=new URLSearchParams(window.location.search).get("redirect");i?window.location.href=i.replace(/~/g,"&"):window.location.href="/"}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"App",children:[e.jsx("h1",{className:"title",children:"LayItOut"}),e.jsx("div",{className:"login-container",children:g=="select"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Welcome to LayItOut"}),e.jsx("p",{children:"Please select an option to continue"}),e.jsx("button",{className:"action-btn",onClick:()=>r("login"),children:"Login"}),e.jsx("button",{className:"action-btn",onClick:()=>r("signup"),children:"Sign Up"})]}):g=="login"?f?e.jsx("div",{className:"loader"}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Welcome back!"}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"text",id:"email",name:"email",value:l,onChange:a=>p(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"password",children:"Password:"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n,onChange:a=>x(a.target.value)})]}),S?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"action-btn",onClick:I,children:"Login"}),e.jsx("label",{className:"label-btn",onClick:()=>r("select"),children:"Back"})]}):f?e.jsx("div",{className:"loader"}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Sign Up"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"name",children:"Full Name:"}),e.jsx("input",{type:"text",id:"name",name:"name",value:h,onChange:a=>y(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"text",id:"email",name:"email",value:l,onChange:a=>p(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"password",children:"Password:"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n,onChange:a=>x(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"confirm-password",children:"Confirm Password:"}),e.jsx("input",{type:"password",id:"confirm-password",name:"confirm-password",value:w,onChange:a=>v(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"company-code",children:"Company Code:"}),e.jsx("input",{type:"text",id:"company-code",name:"company-code",value:c,onChange:a=>C(a.target.value)})]}),P?e.jsx("div",{className:"loader",children:" "}):e.jsx("button",{className:"action-btn",onClick:F,children:"Sign Up"}),e.jsx("label",{className:"label-btn",onClick:()=>r("select"),children:"Back"})]})})]})})}

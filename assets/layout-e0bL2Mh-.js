import{r as d,j as t,c as On}from"./index-BNCXs9B3.js";import{A as Qt,S as Fn,D as Gn,B as Vn}from"./booth_item-D7-h2gHM.js";import{I,E as qe,G as ge,z as Zn,H as f,V as zt,J as O,K as $,T as ve,D as Nt,L as Mt,B as Pe,M as je,N as Be,k as Yn,n as Jn,O as Un,P as ct,Q as Hn,R as Xn,U as Qn,W as zn,A as qn,X as $n}from"./firestore-DnikGjYO.js";import{F as rt}from"./forward-An_qFV6V.js";import{I as Kn,L as _n,T as el}from"./inventory_item_tile-dj6osfPl.js";const qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE02lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTE2PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmRiZTM1YTM5LWE0MDUtNDM2MC04YzRjLWI3NmJmMTY3Mjc1YjwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5hZGQtaXRlbSAtIDc8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOnBkZj0naHR0cDovL25zLmFkb2JlLmNvbS9wZGYvMS4zLyc+CiAgPHBkZjpBdXRob3I+U2FyYWggS2VtbWVOYXNoPC9wZGY6QXV0aG9yPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczp4bXA9J2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8nPgogIDx4bXA6Q3JlYXRvclRvb2w+Q2FudmEgKFJlbmRlcmVyKSBkb2M9REFHdTJ5dUVOWkEgdXNlcj1VQUZqR1c2eHRDUSBicmFuZD1bQVJDSElWRURdIEZvcnQgV2F5bmUgQ29tbXVuaXR5IFNjaG9vbHMgdGVtcGxhdGU9PC94bXA6Q3JlYXRvclRvb2w+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0ncic/PupmVZwAAAT8SURBVHic7d1PaBxVHMDxX41Wh6DsE1FcweGltiAUpE7Vanm9BGzGqvGgJ9e/bRSliHrwkIueiif/gShkVFRGLCbR4p8ulSBMEEul7+rJF6jgXqQTFSEiK15m4yTZze7MvJn3m5nf95p9+xv4MLOZycxmB1Co2mF6A6iNEQiyCARZBIIsAkEWgSCLQJBFIMgiEGQRCLIIBFkEgiwCGVCDi7GJydnjbOLQEQC4AQBUqAJfeu6nec4lkD41uLjcmWl/AQBTm38WquAd6bnP5jV7LK83LmsRxucA4Pb7ucXs2xgX13ek/1Ue8wkk1jCMXhaz9zMurutI/2vd20AgUQ0udkaHqW0xekV7yrUd6X+jczsIBNYxFgDgSJJ1Eco1Hemf1rUttQeJYdybZr3F7NsZF1d3pN/WsT21BmlwcZkz016ElBi9LGbfwbhgOlBqDXLwpZ8WAeB+He9lMfsA4+KqjvTPZHmfWoMwLpoWsw/rej+L2XcyLq7MglJrkI70f2Bc/KkZ5S7GxXhH+t+mWV9rEIB1lD80oxxkXFzsSP9c0rW1BwEA6Ej/LOPid4vZWy6VpM1i9oFQLb+2tnrh3yTrLtG1AZhrcLFz8sRfLze4sAa9RnruG6EKXtQ4lrEJsTfposqDROcZ8wDwijPT/rLBxRWDXis99/VQBc9rHP930gWVvto74KTvzPm5qenVleW1QetuPXb6OTZx6M2M439Zmh2/Memiyu4hsT1j80nf3c5M+9SQPeWtUAUvZJmf9vBXyQ/12J5x34CX7Go6rf2hWp5fW73Q7feC6IP+osXskS42xgtV8LT03I+TrgOoIEiCa1M3NZ2WMwTlHOPiN4vZ94w6P1TBU9Jz55Jsc7xKgaS4ULh7BJQfR0UJVXBUeu57SbZ5c5UByXDVdnfTae3LihKq4EnpuR8knL2lSoBkvYQOAHsilIUUKN1QBY9Jz/0o5ewNlR5EA0avNCjdUAWPSs/1M85er9QgGjF67Wk6rVsilL6XPGIoh0MVPKz7tqDSnhjGzjMG/WqbpVPn56YeWl1Z/mfQC/jk7K6VpRM/6x5cSpAc9ox+DUXJo9KdqReEAQAw7cy0Tza4uDTnORsq1WdIgRi9bm46rb2hWl5Mehk9baU5ZEU3JMyDpr+BJ2xhaXb8wSIGleKQFWF8BmYwIFTBd0XNQr+HxDCmTcwPVXBceu7bRc1DDVI3DADEIHXEAEAKUlcMAIQgdcYAQAZSdwwARCAIMJ6RnvuuidnxUIAQxv8ZByGMjRkFIYytGQMhjP4ZASGMwRUOQhjbVygIAoxMN7EVUWEghDFahYAQxujlDkIYycoVhDCSlxsIYaQrFxDCSJ92EAQYx7I+EmAyrSAIMI5Kz33fxGxdaQMhDD1pASEMfWUGIQy9ZQIhDP2lBiGMfEoFggBDywOWGEsM0uBiLLoL/YEctmdooQoel577oYnZRZT47nc2IfaBOYwnqowBAJDm6SAjjzBUfc/oVYrnQ+qCAVACkDphACAHqRsGAF6QbqiCR+qGAZDuQz3vel9X8YnpDTERtj2k1hgAuEBqjwGAB4QwojCAEEYs0yCEsSmTv2V1QxW08v43dGXLFEg3+vKvk4bmo83EIYswtinNHvIrALyadmCogu+l5+byPwCrkPGHPqmNEQiyCARZBIIsAkEWgSCLQJBFIMgiEGQRCLIIBFkEgqz/ADvdpRk/dmKqAAAAAElFTkSuQmCC";function tl({inventoryItem:c,addDraggingItem:D,removeItem:Z,setSelectedItem:x,tapAndPlaceMode:b,canEditItem:E,onEditItem:N}){const T=d.useRef(null),C=d.useRef(null),[v,R]=d.useState(12),[k,F]=d.useState(c.item),[y,X]=d.useState(!1);function V(P){const le=C.current,M=window.getComputedStyle(le),Y=document.createElement("span");Y.style.font=M.font,Y.style.fontSize=P+"px",Y.style.fontFamily=M.fontFamily,Y.style.fontWeight=M.fontWeight,Y.style.position="absolute",Y.style.visibility="hidden",Y.style.whiteSpace="nowrap",Y.textContent=le.textContent,document.body.appendChild(Y);const _=Y.offsetWidth;return document.body.removeChild(Y),_}function L(P){if(C.current){const le=C.current;return V(P-1)>le.offsetWidth&&P-1>8?L(P-1):P-1}return P}d.useEffect(()=>{setTimeout(()=>{C.current&&R(L(v))},100)},[]);const w=d.useCallback(()=>{if(console.log("MOUSE MOVE",y),y){if(X(!1),b)return;c.item.initialElement=T.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",c.item.id,"to initialElement",c.item.initialElement),F(new I({...c.item})),D(c.item),window.removeEventListener("mousemove",w),window.removeEventListener("touchmove",w)}},[y,b]);return d.useEffect(()=>(y?(window.addEventListener("touchmove",w),window.addEventListener("mousemove",w)):(window.removeEventListener("touchmove",w),window.removeEventListener("mousemove",w)),()=>{window.removeEventListener("touchmove",w),window.removeEventListener("mousemove",w)}),[y,w]),t.jsxs("div",{className:"display",children:[t.jsx("div",{ref:T,id:c.item.id,className:c.item.isSectionItem?"display-section":`display-item ${c.item.isSectionModifier?c.item.sectionModifierType.toString():""}`,style:{width:`${c.item.cellsLong*10}px`,height:`${c.item.cellsTall*10}px`},onMouseDown:P=>{X(!0)},onMouseUp:()=>{console.log("MOUSE UP"),X(!1)},onClick:P=>{if(!b){P.preventDefault(),P.stopPropagation();return}console.log("CLICKED ON ITEM",c.item.id,"with tap and place mode"),P.preventDefault(),P.stopPropagation(),c.item.initialElement=T.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),x(c.item)},onTouchStart:P=>{b||(P.preventDefault(),P.stopPropagation(),c.item.initialElement=T.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",c.item.id,"to initialElement",c.item.initialElement),F(new I({...c.item})),D(c.item))},children:c.item.isSectionModifier?c.item.sectionModifierType==="LeftDoor"||c.item.sectionModifierType==="RightDoor"?t.jsx("img",{src:c.item.icon,alt:"icon"}):null:c.item.icon.includes("custom-")?t.jsx("div",{className:c.item.isSectionItem?"custom-section":"custom-icon",children:t.jsx("div",{children:t.jsx("p",{ref:C,style:{fontSize:`${v}px`},children:c.item.icon.split("custom-")[1]})})}):t.jsx("img",{src:c.item.icon,alt:"icon"})}),t.jsx("p",{children:c.item.name}),c.quantity>0&&t.jsxs("p",{className:"quantity",children:["x",c.quantity]}),E&&t.jsx("img",{src:qt,alt:"Edit",className:"edit-icon",onClick:()=>N(c)})]})}const $t="/assets/plus.circle-Ce3xm00a.png";function nl({inventoryItems:c,addDraggingItem:D,maxHeight:Z,removeItem:x,showAddCustomItem:b,isCreatingTemplate:E,isEditingTemplate:N,isViewingDesign:T,tapAndPlaceMode:C,setSelectedItem:v,isModifyingSections:R,canEditItem:k,onEditItem:F}){return t.jsxs("div",{className:"toolbox",style:{maxHeight:Z?`${Z}px`:"200px"},children:[c.map(y=>t.jsx(tl,{canEditItem:k,onEditItem:F,setSelectedItem:v,tapAndPlaceMode:C,inventoryItem:y,addDraggingItem:D,removeItem:x})),!(E||N||T||R)&&t.jsx("div",{className:"add-item",onClick:()=>{b()},children:t.jsx("img",{src:$t,alt:"Add Item"})})]})}function ll({dialogRef:c,closeDialog:D,areaPreview:Z}){return t.jsx("dialog",{ref:c,className:"layout-dialog",children:t.jsxs("div",{className:"layout-dialog-div",children:[t.jsx("h2",{children:"Layout"}),t.jsx("img",{src:Z,alt:"Layout preview",className:"layout-dialog-preview"}),t.jsx("br",{}),t.jsx("button",{className:"layout-dialog-close",onClick:D,children:"Close"})]})})}const ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE2mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTAzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmE2MmM1Y2UxLTIzNTYtNGE3Ny1hNTAwLTViNWJjMjE1MDU3NzwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5VbnRpdGxlZCBkZXNpZ24gLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogIDxwZGY6QXV0aG9yPlNhcmFoIEtlbW1lTmFzaDwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcikgZG9jPURBR3UyeXVFTlpBIHVzZXI9VUFGakdXNnh0Q1EgYnJhbmQ9W0FSQ0hJVkVEXSBGb3J0IFdheW5lIENvbW11bml0eSBTY2hvb2xzIHRlbXBsYXRlPTwveG1wOkNyZWF0b3JUb29sPgogPC9yZGY6RGVzY3JpcHRpb24+CjwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9J3InPz7fMgZvAAADaElEQVR4nO3dO2gTAQDG8e8ujz6k6FBbUeOjKILV4CAiDgWxLqK4KM4dCuLiIIg6OQgibi5OgjgoDhZB7NIiIr6gCFFThIotaSsVtSJtadI87hykiKSNd/Uu9yX3/cZwyV3yv0fukYth27YNoWEGPQHyNwUhoyBkFISMgpBREDIKQkZByCgImajTAa88XMDTDyU/p8VXjTHg0vEGHNgeCXpSKnK8hNRyDADIFYCXI/zvwfESsujInig6N/i7prv+OO/puO6/LmB82kYtHLRzHSSZMNG9y/XTXFkMsjth4rAH4xpIFzE+XQs5tFGnoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMvwelVujU/iiGJy3s3cp9qNwPlEF6D8aDnoTAaJVFRkHIKAgZBSGjIGQUhIyCkFEQMgpCRkHIKAgZymNZfvkxZ+NtpsqXkxrAtnYTqxoMR4OHKsjQaAlDo9W/vndzq4FbvU2Ohg3FKqtzY7CH8TPfnV/GGoolpKcrhp6uWNXHO5Au4tqjvKvnhGIJqSUKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByFAGsSwgm6+N35V7jTLIubs5nLyRxdg3K+hJqTrKIOlJC7kCMDKlIBQW7yRsUk6dv0L4lrkpCBkFIeP6FO67CQslq1j2+I71Jra0qu//ch2kP1VEf6r88XgU6DvbhMa4s8tdZGmezdJrWwxEwvcbTc+5XkIuHIv7fke5MNNKn4yCkFEQMgpCRkHIUH9dujmYx+1nhbLHkwkT5482wKjDXR7qIDNZYCZbfqLqyWwJZ7pttDTVXxHqIMvdanzdGqMuYwDkQby61Xgt0UadTLhmv2XM5Wxc7lvA1E9vL6xYyYUaCgLg4xcLqQzH+XsFAZDcFMHpQzHML3j7up++Wnjh8k9kFARAxARO7PP+N4gD6aLrINqokwlsCUllSrj3qoBihRmoxLFar6rAgjwYKuLNWOVPfHaJvfR6F1iQnq4Ytrcvvca88/z38avVzfW5N15JYEE62kx0tFUOUo8HD/9FG3UyCkJGQcgoCBnPLiX1w/sJC1aVxuWH4c/ud6QM27Ydfdnvvjrv+sXlj8GLzY6Gc7zK2unzHxLXs2TC+WfneAmR6tBsT0ZByCgIGQUhoyBkFISMgpBREDIKQuYX+jTA4JQOFzkAAAAASUVORK5CYII=",sl="/assets/template-Cjj8EPhc.png";function il({dialogRef:c,closeDialog:D,templates:Z,isOpen:x,isViewingArea:b,selectTemplate:E,duplicateTemplate:N}){const[T,C]=d.useState(/Mobi|Android/i.test(navigator.userAgent)),[v,R]=d.useState([]),[k,F]=d.useState(!1),[y,X]=d.useState([]);return d.useEffect(()=>{X(Z)},[Z]),d.useEffect(()=>{if(x&&(console.log("Layout dialog opened, generating cells and sections",y),y.length!==0)){if(y.length==1){R([y[0].name]);return}R(T?[y[0].name]:[y[0].name,y[1].name])}},[x,y]),d.useEffect(()=>{const V=y.filter(L=>v.includes(L.name));console.log("Viewing templates:",v),V.sort((L,w)=>v.indexOf(L.name)-v.indexOf(w.name)),console.log("Generating templates for",V.map(L=>L.name))},[v,y]),t.jsx(t.Fragment,{children:t.jsx("dialog",{ref:c,className:"template-dialog",children:t.jsxs("div",{className:"template-dialog-div",children:[t.jsx("h2",{children:"Templates"}),t.jsxs("div",{className:"templates",children:[y.length>1&&y.filter(V=>!v.includes(V.name)).length>0&&t.jsx("img",{src:rt,onClick:()=>{if(T){const L=(y.findIndex(w=>w.name===v[0])-1+y.length)%y.length;R([y[L].name])}else R(V=>{const w=(y.findIndex(P=>P.name===V[0])-1+y.length)%y.length;return[y[w].name,V[0]]})},className:"back-mobile-areas"}),v.length===0&&t.jsx("div",{className:"no-templates",children:"No templates available"}),v.map(V=>t.jsxs("div",{className:"template",children:[t.jsx("img",{src:y.find(L=>L.name===V).previewImage,alt:V,className:"template-preview"}),t.jsx("h3",{children:V}),t.jsxs("div",{className:"template-actions",children:[t.jsx("button",{className:"template-select-btn",onClick:()=>{if(b){const L=new URLSearchParams(window.location.search),w=L.get("companyId"),P=L.get("areaId");window.location.href=`/Layout/?companyId=${w}&areaId=${P}&type=edit-template&templateId=${y.find(le=>le.name==V).id}`}else D(),E&&E(y.find(L=>L.name===V))},children:b?"Edit":"Select"}),b&&t.jsx("button",{className:"action-btn",onClick:()=>{k||(F(!0),N&&N(y.find(L=>L.name===V)))},children:"Duplicate"}),b&&t.jsx("button",{className:"action-btn",onClick:()=>{if(k)return;F(!0);const L=y.filter(M=>M.name!==V);X(L),L.length==1?R([L[0].name]):L.length==0?R([]):R(T?[L[0].name]:[L[0].name,L[1].name]);const w=new URLSearchParams(window.location.search),P=w.get("companyId"),le=w.get("areaId");qe(P,le,L).then(()=>{F(!1)})},children:"Delete"})]})]})),y.length>1&&y.filter(V=>!v.includes(V.name)).length>0&&t.jsx("img",{src:rt,onClick:()=>{if(T){const L=(y.findIndex(w=>w.name===v[0])+1)%y.length;R([y[L].name])}else R(V=>{const w=(y.findIndex(P=>P.name===V[V.length-1])+1)%y.length;return[V[1],y[w].name]})},className:"forward-mobile-areas"})]}),b&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"action-btn",onClick:()=>{const V=new URLSearchParams(window.location.search),L=V.get("companyId"),w=V.get("areaId");window.location.href=`/Layout/?companyId=${L}&areaId=${w}&type=create-template`},children:"Create new Template"})," ",t.jsx("br",{})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:D,children:"Close"}),k&&x&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})})})}function al({dialogRef:c,closeDialog:D,addInventoryItem:Z,canBeBooth:x}){const[b,E]=d.useState(""),[N,T]=d.useState(1),[C,v]=d.useState(1),[R,k]=d.useState(1),[F,y]=d.useState(!1);return t.jsx("dialog",{ref:c,className:"custom-item-dialog",children:t.jsxs("div",{className:"custom-item-dialog-div",children:[t.jsx("h2",{children:"Add Custom Item"}),t.jsxs("div",{className:"custom-item-row",children:[t.jsx("label",{htmlFor:"item-name",children:"Name:"}),t.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:X=>E(X.target.value??""),value:b})]}),t.jsxs("div",{className:"custom-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:N,onChange:X=>T(parseInt(X.target.value)??1)})]}),t.jsxs("div",{className:"custom-item-row custom-item-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:C,onChange:X=>v(parseFloat(X.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:R,onChange:X=>k(parseFloat(X.target.value)??1)})]}),x?t.jsxs("div",{className:"custom-item-row",children:[t.jsx("label",{htmlFor:"is-booth",children:"Is Booth:"}),t.jsx("input",{type:"checkbox",id:"is-booth",name:"is-booth",checked:F,onChange:X=>y(X.target.checked)})]}):null,t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(b.trim()===""){alert("Item name cannot be empty");return}const X=new ge({quantity:N,item:new I({id:b+(Math.random()*1e4).toString(),name:b,icon:`custom-${b}`,cellsLong:Math.ceil(C),cellsTall:Math.ceil(R),moveable:!0,starterItem:!1,displayItem:!0,isBooth:F})});Z(X),E(""),T(1),v(1),k(1),y(!1),D()},children:"Add Item"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{D(),E(""),T(1),v(1),k(1),y(!1)},children:"Close"})]})})}function cl({dialogRef:c,closeDialog:D,addSection:Z}){const[x,b]=d.useState(""),[E,N]=d.useState(1),[T,C]=d.useState(1);return t.jsx("dialog",{ref:c,className:"section-dialog",children:t.jsxs("div",{className:"section-dialog-div",children:[t.jsx("h2",{children:"Add Section"}),t.jsxs("div",{className:"section-row",children:[t.jsx("label",{htmlFor:"section-name",children:"Name:"}),t.jsx("input",{type:"text",id:"section-name",name:"section-name",onChange:v=>b(v.target.value??""),value:x})]}),t.jsxs("div",{className:"section-row section-size",children:[t.jsx("label",{htmlFor:"section-width",children:"Size (in feet):"}),t.jsx("input",{type:"number",id:"section-width",name:"section-width",min:"1",value:E,onChange:v=>N(parseFloat(v.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"section-height",name:"section-height",min:"1",value:T,onChange:v=>C(parseFloat(v.target.value)??1)})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(x.trim()===""){alert("Section name cannot be empty");return}const v=new ge({quantity:1,item:new I({id:x+(Math.random()*1e4).toString(),name:x,icon:`custom-${x}`,cellsLong:Math.ceil(E),cellsTall:Math.ceil(T),moveable:!0,starterItem:!1,displayItem:!0,isSectionItem:!0})});Z(v),b(""),N(1),C(1),D()},children:"Add Section"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:D,children:"Close"})]})})}function rl({dialogRef:c,closeDialog:D,addInventoryItem:Z}){const[x,b]=d.useState(null),[E,N]=d.useState(""),[T,C]=d.useState(1),[v,R]=d.useState(1),[k,F]=d.useState(1),[y,X]=d.useState(!0),[V,L]=d.useState([]);return d.useEffect(()=>{Zn(localStorage.getItem("companyId")||"").then(w=>{L(w)})},[]),t.jsx("dialog",{ref:c,className:"inventory-item-dialog",children:t.jsxs("div",{className:"inventory-item-dialog-div",children:[t.jsx("h2",{children:"Add Inventory Item"}),x==null?t.jsxs(t.Fragment,{children:["  ",t.jsx("label",{htmlFor:"",children:"Premade Items:"}),t.jsx("div",{className:"inventory-item-list",children:V.map(w=>t.jsx(Kn,{item:w,onSelect:()=>{const P=new ge({quantity:1,item:new I({id:w.name+(Math.random()*1e4).toString(),name:w.name,icon:w.icon,cellsLong:w.cellsLong,cellsTall:w.cellsTall,moveable:!0,starterItem:!1,displayItem:!0})});b(P)}},w.id))}),t.jsx("label",{htmlFor:"",children:"Or:"}),t.jsx("label",{htmlFor:"",children:"Custom Item:"}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-name",children:"Name:"}),t.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:w=>N(w.target.value??""),value:E})]}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:T,onChange:w=>C(parseInt(w.target.value)??1)})]}),t.jsxs("div",{className:"inventory-item-row inventory-item-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:v,onChange:w=>R(parseFloat(w.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:k,onChange:w=>F(parseFloat(w.target.value)??1)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),t.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:y,onChange:w=>X(w.target.checked)})]}),t.jsx("br",{})]}):t.jsxs(t.Fragment,{children:[t.jsxs("label",{htmlFor:"",children:["Item: ",x.item.name]}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:T,onChange:w=>C(parseInt(w.target.value)??1)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),t.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:y,onChange:w=>X(w.target.checked)})]})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(E.trim()===""&&x==null){alert("Item name cannot be empty");return}if(T<=0){alert("Item count must be greater than zero");return}let w=x;w==null?w=new ge({quantity:T,item:new I({id:E+(Math.random()*1e4).toString(),name:E,icon:`custom-${E}`,cellsLong:Math.ceil(v),cellsTall:Math.ceil(k),moveable:y,starterItem:!1,displayItem:!0})}):(w.quantity=T,w.item.moveable=y),Z(w),X(!0),b(null),N(""),C(1),R(1),F(1),D()},children:"Add Item"}),t.jsx("button",{className:"action-btn",onClick:()=>{X(!0),b(null),N(""),C(1),R(1),F(1),D()},children:"Close"})]})})}function dl({item:c,setSelectingItem:D,addHighlightedCell:Z,canPlaceItem:x,placeItem:b,highlightCells:E,unHighlightCells:N,cellSize:T,placeMultiItem:C}){const[v,R]=d.useState(0),[k,F]=d.useState(0),y=d.useRef(null),[X,V]=d.useState(0),[L,w]=d.useState(0),[P,le]=d.useState(!1),[M,Y]=d.useState(0),[_,Te]=d.useState(null),[Et,Ie]=d.useState(!0),[Le,$e]=d.useState(12),Xe=d.useRef(null),[dt,Ct]=d.useState(!0),[We,mt]=d.useState(!1),[he,K]=d.useState(!1),[Ae,j]=d.useState(0),[fe,Ke]=d.useState(0),Ne=d.useCallback(G=>{const J=G%2===1;return{width:J?c.cellsTall*T:c.cellsLong*T,height:J?c.cellsLong*T:c.cellsTall*T,cellsWide:J?c.cellsTall:c.cellsLong,cellsTall:J?c.cellsLong:c.cellsTall}},[c,T]);function Me(G){const J=y.current,re=window.getComputedStyle(J),B=document.createElement("span");B.style.font=re.font,B.style.fontSize=G+"px",B.style.fontFamily=re.fontFamily,B.style.fontWeight=re.fontWeight,B.style.position="absolute",B.style.visibility="hidden",B.style.whiteSpace="nowrap",B.textContent=J.textContent,document.body.appendChild(B);const de=B.offsetWidth;return document.body.removeChild(B),de}function Oe(G){if(y.current){const J=y.current;return Me(G-1)>J.offsetWidth&&G-1>8?Oe(G-1):G-1}return G}const _e=()=>{mt(!0)},Fe=()=>{mt(!1)};d.useEffect(()=>(setTimeout(()=>{y.current&&$e(Oe(Le))},100),window.addEventListener("mousedown",_e),window.addEventListener("mouseup",Fe),()=>{window.removeEventListener("mousedown",_e),window.removeEventListener("mouseup",Fe)}),[]),d.useEffect(()=>{if(c){le(!0);const G=Xe.current?.getBoundingClientRect();j(G?G.left-v:0),Ke(G?G.top-k:0)}else console.log("No item to place, stopping dragging"),le(!1),R(0),F(0),V(0),w(0),Y(0),Te(null),Ie(!0),$e(12),Ct(!0),j(0),Ke(0)},[c,v,k]);const ye=G=>{G.preventDefault()},Ge=d.useCallback((G,J,re)=>{if(c==null||!P)return;const B=re.target,de=Ne(M),Q=I.fromDoc(c.toDoc());Q.cellsLong=de.cellsWide,Q.cellsTall=de.cellsTall,Q.initialElement=c.initialElement,Q.rotation=M,Q.hasMoved=c.hasMoved,Q.id=c.id;let we=B;if(!we||!we.classList?.contains("cell")){const Ee=document.elementFromPoint(G,J);Ee?.classList?.contains("cell")&&(we=Ee)}we?.classList?.contains("cell")&&!he?E(f.fromString(we.id),Q):we?.classList?.contains("section-modifier")&&!he?E(f.fromString(we.dataset.cell),Q):he||N(),R(G-Ae),F(J-fe+5),We&&(he||N(),K(!0),Z(f.fromString(we.id)))},[c,P,Ae,fe,he,We,Ne,M,E,N,Z]),Ce=d.useCallback(G=>{if(c==null)return;const J=G.clientX,re=G.clientY;console.log("Drag ended"),N(),document.body.removeEventListener("touchmove",ye);const B=document.elementFromPoint(J,re);if(!B?.classList?.contains("cell")&&!B?.classList?.contains("section-modifier")){const de=Ne(M),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};he?(K(!1),C(Q)):D()}else if(B?.classList?.contains("section-modifier")){if(console.log("Placing item on section modifier cell"),console.log("Target element:",B.dataset.cell),B.dataset.cell=="")return;const de=Ne(M),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};if(he)K(!1),C(Q);else{if(!x(f.fromString(B.dataset.cell),Q))return;b(f.fromString(B.dataset.cell),Q,_!=null?f.fromString(_.id):null)}console.log("Placed item at cell:",B)}else{const de=Ne(M),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};if(he)K(!1),C(Q);else{if(!x(f.fromString(B.id),Q))return;b(f.fromString(B.id),Q,_!=null?f.fromString(_.id):null)}console.log("Placed item at cell:",B)}},[c,M,D,he,x,b,_,N,X,L]),H=d.useCallback(G=>{const J=G.clientX,re=G.clientY;Ge(J,re,G)},[Ge]),oe=d.useCallback(G=>{const J=G.touches[0],re=J.clientX,B=J.clientY;Ge(re,B,G)},[Ge]),A=d.useCallback(G=>{const J=G.changedTouches[0],re=J.clientX,B=J.clientY;Ce({clientX:re,clientY:B}),document.body.removeEventListener("touchmove",ye)},[Ce,ye]);return d.useEffect(()=>{if(P)return document.body.addEventListener("touchmove",ye,{passive:!1}),document.addEventListener("mousemove",H),document.addEventListener("mouseup",Ce),document.addEventListener("touchmove",oe),document.addEventListener("touchend",A),()=>{document.body.removeEventListener("touchmove",ye),document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",Ce),document.removeEventListener("touchmove",oe),document.removeEventListener("touchend",A)}},[P,H,Ce,oe,A,ye]),v==0||k==0||!dt||c==null?t.jsx(t.Fragment,{}):t.jsx(t.Fragment,{children:t.jsx("div",{id:c.id,ref:Xe,className:`draggable-item ${c.isSectionModifier&&!c.moveable?"placed-modifier":""} ${c.isSectionModifier?c.sectionModifierType?.toString():""} ${P?"dragging":""} ${c.moveable?"":"not-moveable"}`,style:{top:`${k}px`,left:`${v}px`,width:`${c.cellsLong*(c.isDisplayItem&&!P&&!c.hasMoved?10:T)-(c.sectionModifierType=="LeftWall"||c.sectionModifierType=="RightWall"||c.sectionModifierType?.includes("Corner")?1:0)}px`,height:`${c.cellsTall*(c.isDisplayItem&&!P&&!c.hasMoved?10:T)-(c.sectionModifierType=="TopWall"||c.sectionModifierType=="BottomWall"||c.sectionModifierType?.includes("Corner")?1:0)}px`,rotate:`${M*90}deg`,transformOrigin:"center center",fontSize:`${Le}px`,zIndex:P?1e3:1},children:c.isSectionModifier?null:c.icon.includes("custom-")?t.jsx("div",{className:c.isSectionItem?"custom-section":"custom-icon",children:t.jsx("div",{children:t.jsx("p",{ref:y,children:c.icon.split("custom-")[1]})})}):t.jsx("img",{src:c.icon,alt:"icon"})})})}function ml({vendor:c,onDelete:D,onEdit:Z,boothMap:x}){return t.jsxs("div",{className:"vendor-display-tile",children:[t.jsxs("div",{className:"vendor-info",children:[t.jsx("h3",{className:"vendor-business-name",children:c.businessName}),t.jsxs("p",{className:"vendor-plot-size",children:[c.plotWidth,"ft x ",c.plotHeight,"ft"]})]}),t.jsxs("div",{className:"vendor-actions",children:[t.jsx("img",{src:_n,alt:"Share",className:"vendor-link",onClick:async b=>{b.stopPropagation();const E=localStorage.getItem("companyId"),N=window.location.origin+`/Layout/?companyId=${E}&areaId=${x.areaId}&type=pick-booth&boothMapId=${x.id}&boothMapName=${x.name}&vendorId=${c.id}`;await navigator.clipboard.writeText(N),alert("BoothMap link copied to clipboard!")}}),t.jsx("img",{src:qt,alt:"Edit",className:"vendor-edit",onClick:b=>{b.stopPropagation(),Z(c.id)}}),t.jsx("img",{src:el,alt:"Delete",className:"vendor-delete",onClick:b=>{b.stopPropagation(),window.confirm("Are you sure you want to delete this vendor?")&&D(c.id)}})]})]})}function ul({maxHeight:c,vendors:D,onAddVendor:Z,boothMap:x,onDeleteVendor:b,onEditVendor:E}){return t.jsxs("div",{className:"vendors-tile",style:{maxHeight:c?`${c}px`:"200px"},children:[t.jsx("h2",{children:"Vendors"}),t.jsx("div",{className:"vendors-divider"}),t.jsxs("div",{className:"vendors-tile-content",children:[D.map(N=>t.jsx(ml,{vendor:N,boothMap:x,onDelete:T=>{b(T)},onEdit:T=>{E(N)}},N.id)),t.jsx("div",{className:"add-vendor",onClick:Z,children:t.jsx("img",{src:$t,alt:"Add vendor"})})]})]})}function gl({dialogRef:c,closeDialog:D,addVendor:Z}){const[x,b]=d.useState(""),[E,N]=d.useState(1),[T,C]=d.useState(1),[v,R]=d.useState(!1);return t.jsxs("dialog",{ref:c,className:"add-vendor-dialog",children:[t.jsxs("div",{className:"add-vendor-dialog-div",children:[t.jsx("h2",{children:"Add Vendor"}),t.jsxs("div",{className:"add-vendor-row",children:[t.jsx("label",{htmlFor:"business-name",children:"Business Name:"}),t.jsx("input",{type:"text",id:"business-name",name:"business-name",onChange:k=>b(k.target.value??""),value:x})]}),t.jsxs("div",{className:"add-vendor-row add-vendor-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Booth Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:E,onChange:k=>N(parseFloat(k.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:T,onChange:k=>C(parseFloat(k.target.value)??1)})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:async()=>{if(x.trim()===""){alert("Business name cannot be empty");return}const k=new zt({id:x+(Math.random()*1e4).toString(),businessName:x,plotWidth:Math.ceil(E),plotHeight:Math.ceil(T)});R(!0),await Z(k),b(""),N(1),C(1),R(!1),D()},children:"Add Vendor"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{D(),b(""),N(1),C(1)},children:"Close"})]}),v&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})}function fl({dialogRef:c,closeDialog:D,editVendor:Z,oldVendor:x}){const[b,E]=d.useState(""),[N,T]=d.useState(1),[C,v]=d.useState(1),[R,k]=d.useState(!1);return d.useEffect(()=>{x&&(E(x.businessName),T(x.plotWidth),v(x.plotHeight))},[x]),t.jsxs("dialog",{ref:c,className:"edit-vendor-dialog",children:[t.jsxs("div",{className:"edit-vendor-dialog-div",children:[t.jsx("h2",{children:"Edit Vendor"}),t.jsxs("div",{className:"edit-vendor-row",children:[t.jsx("label",{htmlFor:"business-name",children:"Business Name:"}),t.jsx("input",{type:"text",id:"business-name",name:"business-name",onChange:F=>E(F.target.value??""),value:b})]}),t.jsxs("div",{className:"edit-vendor-row edit-vendor-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Booth Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:N,onChange:F=>T(parseFloat(F.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:C,onChange:F=>v(parseFloat(F.target.value)??1)})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:async()=>{if(b.trim()===""){alert("Business name cannot be empty");return}const F=new zt({id:x.id,businessName:b,plotWidth:Math.ceil(N),plotHeight:Math.ceil(C)});k(!0),await Z(F),E(""),T(1),v(1),k(!1),D()},children:"Save Vendor"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{D(),E(x.businessName),T(x.plotWidth),v(x.plotHeight)},children:"Close"})]}),R&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})}function hl({maxHeight:c}){return t.jsxs("div",{className:"key-tile",children:[t.jsx("h2",{children:"Key"}),t.jsx("div",{className:"key-divider"}),t.jsxs("div",{className:"key-tile-content",children:[t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"cell cell-border"}),t.jsx("p",{children:"1ft x 1ft"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"container",children:t.jsx("div",{className:"wall"})}),t.jsx("p",{children:"Wall"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"window-container",children:t.jsx("div",{className:"window"})}),t.jsx("p",{children:"Window"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"container",children:t.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fright_door.png?alt=media&token=8c6f3b4d-5e7a-4b9c-8d2f-0a3b5e6f7c8d",alt:"",className:"door"})}),t.jsx("p",{children:"Door"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"window-container",children:t.jsx("div",{className:"section-divider"})}),t.jsx("p",{children:"Section Divider"})]})]})]})}function pl({dialogRef:c,closeDialog:D,vendors:Z,addVendorToBooth:x}){const[b,E]=d.useState(!1),[N,T]=d.useState(null);return t.jsxs("dialog",{ref:c,className:"add-vendor-dialog",children:[t.jsxs("div",{className:"add-vendor-dialog-div",children:[t.jsx("h2",{children:"Select Vendor"}),t.jsxs("div",{className:"add-vendor-row",children:[t.jsx("label",{htmlFor:"boothMap-area",children:"Vendor:"}),t.jsxs("select",{id:"boothMap-area",name:"boothMap-area",onChange:C=>{const v=C.target.value,R=Z.find(k=>k.id===v)||null;T(R)},value:N?.id||"",children:[t.jsx("option",{value:"",children:"Select a Vendor"}),Z.map(C=>t.jsx("option",{value:C.id,children:C.businessName},C.id))]})]}),t.jsx("button",{className:"action-btn",onClick:()=>{if(!N){alert("Please select a vendor");return}E(!0),x(N)},children:"Select"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{D(),T(null)},children:"Close"})]}),b&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})}function Il({dialogRef:c,closeDialog:D,editInventoryItem:Z,selectedItem:x,deleteInventoryItem:b}){const[E,N]=d.useState(1),[T,C]=d.useState(!0);return d.useEffect(()=>{x&&(N(x.quantity),C(x.item.moveable))},[x]),t.jsx("dialog",{ref:c,className:"inventory-item-dialog",children:t.jsxs("div",{className:"inventory-item-dialog-div",children:[t.jsx("h2",{children:"Edit Inventory Item"}),t.jsxs("label",{htmlFor:"",children:["Item: ",x?.item.name]}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:E,onChange:v=>N(parseInt(v.target.value)??1)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),t.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:T,onChange:v=>C(v.target.checked)})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(E<=0){alert("Item count must be greater than zero");return}if(x){const v=x;v.quantity=E,v.item.moveable=T,Z(v),C(!0),D()}},children:"Save"}),t.jsx("button",{className:"action-btn",onClick:()=>{b(x),D()},children:"Delete"}),t.jsx("button",{className:"action-btn",onClick:()=>{D()},children:"Close"})]})})}On.createRoot(document.getElementById("root")).render(t.jsx(yl,{}));function yl(){const[c,D]=d.useState(/Mobi|Android/i.test(navigator.userAgent)),[Z,x]=d.useState(0),[b,E]=d.useState(0),[N,T]=d.useState(0),[C,v]=d.useState(0),[R,k]=d.useState([]),[F,y]=d.useState([]),[X,V]=d.useState(0),[L,w]=d.useState(null),[P,le]=d.useState([]),M=/Mobi|Android/i.test(navigator.userAgent)?5:10,[Y,_]=d.useState([]),[Te,Et]=d.useState(!1),[Ie,Le]=d.useState(null),[$e,Xe]=d.useState(null),[dt,Ct]=d.useState([new I({id:"left-wall",name:"Left Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftWall"}),new I({id:"right-wall",name:"Right Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightWall"}),new I({id:"top-wall",name:"Top Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"TopWall"}),new I({id:"bottom-wall",name:"Bottom Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"BottomWall"}),new I({id:"left-door",name:"Left Door",cellsLong:1,cellsTall:1,icon:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fleft_door.png?alt=media&token=91fde31c-ebc6-4807-9670-f846c8d75cb6",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftDoor"}),new I({id:"right-door",name:"Right Door",cellsLong:1,cellsTall:1,icon:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fright_door.png?alt=media&token=8c6f3b4d-5e7a-4b9c-8d2f-0a3b5e6f7c8d",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightDoor"}),new I({id:"left-window",name:"Left Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftWindow"}),new I({id:"right-window",name:"Right Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightWindow"}),new I({id:"top-window",name:"Top Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"TopWindow"}),new I({id:"bottom-window",name:"Bottom Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"BottomWindow"})]),We=d.useRef(null),[mt,he]=d.useState(!1),[K,Ae]=d.useState([]),[j,fe]=d.useState([]),[Ke,Ne]=d.useState([]),[Me,Oe]=d.useState([]),[_e,Fe]=d.useState(!1),ye=d.useRef(null),[Ge,Ce]=d.useState([]),[H,oe]=d.useState([]),[A,G]=d.useState(null),[J,re]=d.useState(!1),[B,de]=d.useState(!1),[Q,we]=d.useState(!1),[Ee,Kt]=d.useState(!1),[se,_t]=d.useState(!1),[ee,ut]=d.useState("placing-sections"),[wl,en]=d.useState(!1),[et,tn]=d.useState(!1),[be,nn]=d.useState(!1),[tt,ln]=d.useState(!1),[Qe,on]=d.useState(!1),[Ve,sn]=d.useState(!1),[Ze,Rt]=d.useState(!1),[Ye,ze]=d.useState(""),[nt,an]=d.useState(null),[Je,kt]=d.useState(""),[U,cn]=d.useState(""),[rn,dn]=d.useState(null),[q,mn]=d.useState(""),[lt,un]=d.useState(null),[ot,st]=d.useState(""),[Dt,it]=d.useState(""),[ie,Re]=d.useState(null),[gt,z]=d.useState(!0),[Pt,gn]=d.useState(null),[ft,pe]=d.useState(!1),[fn,hn]=d.useState(null),[ht,pt]=d.useState([]),[pn,ke]=d.useState(!1),[Se,In]=d.useState(null),[It,yn]=d.useState(!1),[wn,xn]=d.useState(null),[yt,vn]=d.useState(null),[Bt,Wt]=d.useState(null),[De,Ot]=d.useState(!1),[bn,Sn]=d.useState(null),wt=d.useRef(null),xt=d.useRef(null),vt=d.useRef(null),bt=d.useRef(null),St=d.useRef(null),jt=d.useRef(null),Tt=d.useRef(null);function xe(n,e){for(const s of e)if(n.x>=s.cellId.x&&n.x<s.cellId.x+s.cellsLong&&n.y>=s.cellId.y&&n.y<s.cellId.y+s.cellsTall)return s;return null}function jn(n,e,s,a){Ae([...n.map(o=>new O({name:o.name,cellId:new f({x:o.cellId.x,y:o.cellId.y}),cellsLong:o.cellsLong,cellsTall:o.cellsTall,modifierItems:o.modifierItems.map(l=>new $({cell:new f({x:l.cell.x,y:l.cell.y}),item:new I({...l.item,starterItem:!0})})),startingItems:[]}))]);let i=Z,r=b;if(c){for(const g of n)console.log("Generating cells for section",g.name,"at",g.cellId,"with size",g.cellsLong,"x",g.cellsTall),console.log("Needed section Width:",(g.cellsLong+g.cellId.x)*M,"Current width:",i),(g.cellsLong+g.cellId.x)*M>i&&(console.log("Added section Width:",g.cellsLong*M+g.cellId.x),i+=(g.cellsLong+g.cellId.x)*M-i),console.log("Needed section Height:",(g.cellsTall+g.cellId.y)*M,"Current height:",r),(g.cellsTall+g.cellId.y)*M>r&&(console.log("Added section Height:",g.cellsTall*M+g.cellId.y),r+=(g.cellsTall+g.cellId.y)*M-r);v(r/M*2),T(i/M*2);let o=0;const l=[],u=[];for(const g of n){const h=[],S={width:g.cellsLong*M,height:g.cellsTall*M,sectionName:g.name};S.height>o&&(o=S.height),Ce(W=>[...W,S]),g.cellId.x=0,g.cellId.y=0,[...Array(S.height/M).keys()].map(W=>{const me=[];[...Array(S.width/M).keys()].map(ae=>{me.push({id:new f({x:ae,y:W}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:!0,size:M})}),h.push(me)}),l.push({sectionName:g.name,cells:[...h]}),u.push(g)}oe(l),fe(u),V(o),G(n[0]?n[0].name:null),setTimeout(()=>{z(!1)},500)}else{const o=[];for(const l of n)console.log("Generating cells for section",l.name,"at",l.cellId,"with size",l.cellsLong,"x",l.cellsTall),console.log("Needed section Width:",l.cellsLong+l.cellId.x,"Current width:",i),l.cellsLong+l.cellId.x>i&&(console.log("Added section Width:",l.cellsLong+l.cellId.x),i+=l.cellsLong+l.cellId.x-i),console.log("Needed section Height:",l.cellsTall+l.cellId.y,"Current height:",r),l.cellsTall+l.cellId.y>r&&(console.log("Added section Height:",l.cellsTall+l.cellId.y),r+=l.cellsTall+l.cellId.y-r);x(e.width),E(e.height),T(e.width),v(e.height),console.log("Final width:",i,"Final height:",r),[...Array(e.height).keys()].map(l=>{const u=[];[...Array(e.width).keys()].map(g=>{console.log("Creating cell at",g,l,"with size",M,s),u.push({id:new f({x:g,y:l}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:s&&a=="placing-sections"?!0:xe(new f({x:g,y:l}),n)!=null,size:M})}),o.push(u)}),k([...o]),setTimeout(()=>{const l=[],u=[...n],g=[];for(const h of u)h.cellElement=document.querySelector(`.App #${h.cellId.toId()}.cell:not(.cell-border)`),l.push(...h.startingItems.map(S=>new $({cell:new f({x:h.cellId.x+S.cell.x,y:h.cellId.y+S.cell.y}),item:new I({...S.item,initialElement:document.querySelector(`.App #${S.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,hasMoved:!0})}))),l.push(...h.modifierItems.map(S=>new $({cell:new f({x:h.cellId.x+S.cell.x,y:h.cellId.y+S.cell.y}),item:new I({...S.item,initialElement:document.querySelector(`.App #${S.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1})}))),g.push(...h.booths.map(S=>new je({...S,cell:new f({x:h.cellId.x+S.cell.x,y:h.cellId.y+S.cell.y}),initialElement:document.querySelector(`.App #${S.cell.toId()}.cell:not(.cell-border)`)})));fe([...u]);for(const h of l){const S=ae=>{const ue=ae%2===1;return{cellsLong:ue?h.item.cellsTall:h.item.cellsLong,cellsTall:ue?h.item.cellsLong:h.item.cellsTall}},W=h.item.rotation||0,me=S(W);for(let ae=0;ae<me.cellsTall;ae++)for(let ue=0;ue<me.cellsLong;ue++)o[h.cell.y+ae][h.cell.x+ue].hasItem=!0,o[h.cell.y+ae][h.cell.x+ue].itemId=h.item.id;h.item.initialElement=document.querySelector(`.App #${h.cell.toId()}.cell:not(.cell-border)`),y(ae=>[...ae,h.item])}for(const h of g){for(let S=0;S<h.cellsTall;S++)for(let W=0;W<h.cellsLong;W++)o[h.cell.y+S][h.cell.x+W].hasItem=!0,o[h.cell.y+S][h.cell.x+W].itemId=h.id;h.initialElement=document.querySelector(`.App #${h.cell.toId()}.cell:not(.cell-border)`),Ne(S=>[...S,h])}k([...o]),setTimeout(()=>{z(!1)},500)},100)}}async function Tn(){const n=new URLSearchParams(window.location.search),e=n.get("companyId"),s=n.get("areaId"),a=n.get("areaId")||"",i=n.get("companyId")||"",r=n.get("templateId")||"",o=await Un(i,a);if(o===null){window.location.href="/DNF/";return}un(o),hn(o.previewImage||null);const l=n.get("type")||"";let u=!1,g=!1,h="modify-sections",S=!1,W=null;if(l==="public-preview"){Rt(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="create-template")re(!0);else if(l==="edit-area")tn(!0);else if(l==="edit-template"){de(!0);const m=o.templates.find(p=>p.id===r);m&&(gn(m),kt(m.name))}else if(l==="view-design"){u=!0,we(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="view-area")Kt(!0);else if(l==="edit-design"){u=!0,en(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="client-edit-design"){u=!0,sn(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="create-area"){g=!0,_t(!0);const m=n.get("stage");m==="placing-sections"?(h="placing-sections",ut("placing-sections")):m==="modify-sections"?(ut("modify-sections"),h="modify-sections",_(dt.map(p=>new ge({item:new I({...p,displayItem:!0}),quantity:-1})))):m==="placing-items"&&(ut("placing-items"),h="placing-items",_(o.inventoryItems.map(p=>new ge({item:new I({...p.item,displayItem:!0}),quantity:p.quantity}))))}else if(l==="view-boothMap"){S=!0,nn(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Re(p),W=p}else if(l==="pick-booth"){S=!0,on(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Re(p),W=p;const ce=n.get("vendorId")||"";if(ce!==""){const ne=p.vendors.find(te=>te.id===ce);if(ne){In(ne),console.log("Vendor found",ne);let te=!1;W.sections.forEach(Bn=>{Bn.booths.forEach(Wn=>{Wn.user?.id===ne.id&&(te=!0)})}),yn(te);const Xt=await Hn(i);if(Xt===null){window.location.href="/DNF/";return}dn(Xt)}else{window.location.href="/DNF/";return}}}else if(l==="create-boothMap"){S=!0,ln(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Re(p),W=p}else if(l==="public-preview-boothMap"){S=!0,Rt(!0);const m=n.get("boothMapId")||"";it(m);const p=n.get("designName")||"";ze(p);const ce=await ct(i,a,m);if(ce===null){window.location.href="/DNF/";return}Re(ce),W=ce}e&&cn(e),s&&mn(s),g||_(o.inventoryItems.map(m=>new ge({item:new I({...m.item,displayItem:!0}),quantity:m.quantity})));const me=[],ae=[];for(const m of o.templates){const p=[],ce=[];for(const ne of m.sections)p.push(new O({name:ne.name,cellId:new f({x:ne.cellId.x,y:ne.cellId.y}),cellsLong:ne.cellsLong,cellsTall:ne.cellsTall,modifierItems:ne.modifierItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})})),startingItems:ne.startingItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})}))})),ce.push(new O({name:ne.name,cellId:new f({x:ne.cellId.x,y:ne.cellId.y}),cellsLong:ne.cellsLong,cellsTall:ne.cellsTall,modifierItems:ne.modifierItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})})),startingItems:ne.startingItems.map(te=>new $({cell:new f({x:te.cell.x,y:te.cell.y}),item:new I({...te.item,starterItem:!0})}))}));me.push(new ve({name:m.name,sections:p,inventoryItems:m.inventoryItems,id:m.id,previewImage:m.previewImage})),ae.push(new ve({name:m.name,sections:ce,id:m.id,previewImage:m.previewImage,inventoryItems:m.inventoryItems}))}Oe([...me]);const ue=[],He=r===""?void 0:ae.find(m=>m.id===r);if(console.log("TEMPLATE",He,"AREA",o),S&&W)_(W.inventoryItems.map(m=>new ge({item:new I({...m.item,displayItem:!0}),quantity:m.quantity}))),Ae([...W.sections]),fe([...W.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,booths:m.booths,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ue.push(...W.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,booths:m.booths,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))})));else if(u){const m=await Xn(i,a,n.get("designId")||"");if(m===null){window.location.href="/DNF/";return}Ot(m.submitted),Wt(m.dateSubmitted?new Date(m.dateSubmitted):null),an(m),_(m.inventoryItems.map(p=>new ge({item:new I({...p.item,displayItem:!0}),quantity:p.quantity}))),Ae([...m.sections]),fe([...m.sections.map(p=>new O({name:p.name,cellId:new f({x:p.cellId.x,y:p.cellId.y}),cellsLong:p.cellsLong,cellsTall:p.cellsTall,startingItems:p.startingItems,modifierItems:p.modifierItems,items:p.startingItems.map(ce=>new I({...ce.item,sectionCell:new f({x:ce.cell.x,y:ce.cell.y})}))}))]),ue.push(...m.sections.map(p=>new O({name:p.name,cellId:new f({x:p.cellId.x,y:p.cellId.y}),cellsLong:p.cellsLong,cellsTall:p.cellsTall,startingItems:p.startingItems,modifierItems:p.modifierItems,items:p.startingItems.map(ce=>new I({...ce.item,sectionCell:new f({x:ce.cell.x,y:ce.cell.y})}))})))}else He!==void 0?(_(He.inventoryItems.map(m=>new ge({item:new I({...m.item,displayItem:!0}),quantity:m.quantity}))),Ae([...He.sections]),fe([...He.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ue.push(...He.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,modifierItems:m.modifierItems,startingItems:m.startingItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))})))):(Ae([...o.sections]),fe([...o.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,modifierItems:m.modifierItems,startingItems:m.startingItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ue.push(...o.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))));console.log("SECTIONS TO GENERATE",ue),jn(ue,o,l==="create-area",h)}d.useEffect(()=>{Tn()},[]);function Ln(n,e,s){if(!c||n==null)return;const a=[...s],i=[],r=[],o=s.find(l=>l.name==n);console.log("NEW SECTION",o),console.log("Adding section",o.name,o.cellId),console.log("MOBILE CELLS",e),o.cellElement=document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${o.cellId.toId()}.cell:not(.cell-border)`),console.log("Section element found",o.cellElement);for(const l of o.startingItems){console.log("Placing starting item",l.item.name,l.cell);const u=S=>{const W=S%2===1;return{cellsLong:W?l.item.cellsTall:l.item.cellsLong,cellsTall:W?l.item.cellsLong:l.item.cellsTall}},g=l.item.rotation||0,h=u(g);for(let S=0;S<h.cellsTall;S++)for(let W=0;W<h.cellsLong;W++){const me=e.find(ae=>ae.sectionName===o.name);me.cells[l.cell.y+S][l.cell.x+W].hasItem=!0,me.cells[l.cell.y+S][l.cell.x+W].itemId=l.item.id}l.item.initialElement=document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),console.log("Adding item to items",l.item.initialElement),i.push(new I({...l.item,hasMoved:!0}))}for(const l of o.modifierItems){console.log("Placing starting item",l.item.name,l.cell);const u=S=>{const W=S%2===1;return{cellsLong:W?l.item.cellsTall:l.item.cellsLong,cellsTall:W?l.item.cellsLong:l.item.cellsTall}},g=l.item.rotation||0,h=u(g);for(let S=0;S<h.cellsTall;S++)for(let W=0;W<h.cellsLong;W++){const me=e.find(ae=>ae.sectionName===o.name);me.cells[l.cell.y+S][l.cell.x+W].hasItem=!0,me.cells[l.cell.y+S][l.cell.x+W].itemId=l.item.id}console.log("Adding item to items",document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`)),i.push(new I({...l.item,initialElement:document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1}))}console.log("Setting sections",a),fe([...a]),console.log("ITEMS",i),y(l=>[...l.filter(g=>!i.some(h=>h.id===g.id)),...i.map(g=>new I({...g,starterItem:!0}))]),r.push(...o.booths.map(l=>new je({...l,initialElement:document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`)})));for(const l of r){for(let u=0;u<l.cellsTall;u++)for(let g=0;g<l.cellsLong;g++){const h=e.find(S=>S.sectionName===o.name);h.cells[l.cell.y+u][l.cell.x+g].hasItem=!0,h.cells[l.cell.y+u][l.cell.x+g].itemId=l.id}Ne(u=>[...u,l])}}function Ft(n){let e=[];return n.map(s=>e=[...e,...s]),e}function An(n,e){let s=!1;return e.sections.forEach(a=>{a.booths.forEach(i=>{i.user?.id===n.id&&(s=!0)})}),s}function Lt(n,e){const s=c?H.find(o=>o.sectionName===A).cells:R,a=s[n.y].length,i=s.length;if(n.x+e.cellsLong>a||n.y+e.cellsTall>i)return!1;const r=xe(n,j);if(!r&&!c&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;for(let o=0;o<e.cellsTall;o++)for(let l=0;l<e.cellsLong;l++){if(!c){const u=xe(new f({x:n.x+l,y:n.y+o}),j);if(!u&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;if(u?.name!=r?.name&&(ee!=="placing-sections"||!se))return console.log("Item is crossing section boundaries"),!1}if(s[n.y+o][n.x+l].hasItem&&s[n.y+o][n.x+l].itemId!=e.id){console.log("Something is already here single"),console.log("Current ID",s[n.y+o][n.x+l].itemId,"Placing Item ID",e.id);const u=F.find(g=>g.id==s[n.y+o][n.x+l].itemId);if(u&&u.isSectionModifier){if(u.sectionModifierType==="LeftDoor"||u.sectionModifierType==="RightDoor")return console.log("Item is on door of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),!1;if(u.sectionModifierType==="RightWall"){if(console.log("Item is on left wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),l==e.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="LeftWall"){if(console.log("Item is on right wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="TopWall"){if(console.log("Item is on bottom wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="BottomWall"){if(console.log("Item is on top wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==e.cellsTall-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="TopRightCornerWall"){if(console.log("Item is on bottom left corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==0&&l==e.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="TopLeftCornerWall"){if(console.log("Item is on bottom right corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==0&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="BottomRightCornerWall"){if(console.log("Item is on top left corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==e.cellsTall-1&&l==e.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="BottomLeftCornerWall"){if(console.log("Item is on top right corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==e.cellsTall-1&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}}else return!1}}return!0}function Gt(n,e,s){console.log(e),console.log("CELLS",n);const a=n[e.y].length,i=n.length;if(console.log(a,i),e.x+s.cellsLong>a||e.y+s.cellsTall>i)return!1;const r=xe(e,j);if(!r&&!c&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;for(let o=0;o<s.cellsTall;o++)for(let l=0;l<s.cellsLong;l++){if(!c){const u=xe(new f({x:e.x+l,y:e.y+o}),j);if(!u&&(ee!=="placing-sections"||!se))return console.log("Item is out of bounds of any section"),!1;if(u?.name!=r?.name&&(ee!=="placing-sections"||!se))return console.log("Item is crossing section boundaries"),!1}if(n[e.y+o][e.x+l].hasItem&&n[e.y+o][e.x+l].itemId!=s.id){console.log("Something is already here multi");const u=F.find(g=>g.id==n[e.y+o][e.x+l].itemId);if(u&&u.isSectionModifier){if(u.sectionModifierType==="LeftDoor"||u.sectionModifierType==="RightDoor")return console.log("Item is on door of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),!1;if(u.sectionModifierType==="RightWall"){if(console.log("Item is on left wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="LeftWall"){if(console.log("Item is on right wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="TopWall"){if(console.log("Item is on bottom wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="BottomWall"){if(console.log("Item is on top wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="TopRightCornerWall"){if(console.log("Item is on bottom left corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0&&l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="TopLeftCornerWall"){if(console.log("Item is on bottom right corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="BottomRightCornerWall"){if(console.log("Item is on top left corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1&&l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(u.sectionModifierType==="BottomLeftCornerWall"){if(console.log("Item is on top right corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}}else return!1}console.log("Finished checking placement. Current Item ID:",s.id,"Over: ",n[e.y+o][e.x+l])}return!0}function Vt(n,e,s){const a=Array.from(c?H.find(o=>o.sectionName===A).cells:R);if(ke(!0),s!=null){console.log("Removing item",e.id,"from cell",s.toId());const o=c?j.find(l=>l.name===A):xe(s,j);o.items=o.items.filter(l=>l.id!=e.id);for(let l=0;l<e.cellsTall;l++)for(let u=0;u<e.cellsLong;u++)a[s.y+l][s.x+u].hasItem=!1,a[s.y+l][s.x+u].itemId=""}const i=e.name+Math.floor(Math.random()*1e5).toString();if(ee!=="placing-sections"||!se){const o=c?j.find(u=>u.name===A):xe(n,j),l=new f({x:n.x-o.cellId.x,y:n.y-o.cellId.y});e.sectionCell=l,console.log("Adding item to section",o.name,"at",l,e),o.items.push(Te?new I({...e,id:i}):e)}else e.sectionCell=new f({x:n.x,y:n.y});for(let o=0;o<e.cellsTall;o++)for(let l=0;l<e.cellsLong;l++)a[n.y+o][n.x+l].hasItem=!0,Te?a[n.y+o][n.x+l].itemId=i:a[n.y+o][n.x+l].itemId=e.id;if(console.log(a),c){const o=H.find(l=>l.sectionName===A);o&&(o.cells=a.map(l=>l.map(u=>({...u}))),oe([...H]))}else k(a);console.log("Removing item from inventory",e.name,e.hasMoved,e.starterItem);let r=!1;if(!e.hasMoved){console.log("INVENTORY ITEMs",Y);const o=Y.findIndex(l=>l.item.name==e.name&&!l.item.hasMoved);if(o!==-1){const l=[...Y];console.log("Found item in inventory",l[o]),l[o].quantity>0&&(l[o].quantity-=1,l[o].quantity<=0&&(r=!0,l.splice(o,1)),_(l))}else _(Y)}if(y(o=>(console.log("Placing item",e),console.log("Updating item",e.id),Te&&Ie&&e.id==Ie.id?(console.log("Updating placing item",i),e.hasMoved=!0,e.starterItem=!0,e.isDisplayItem=!1,e.initialElement=document.querySelector(`.App #${n.toId()}.cell:not(.cell-border)`),console.log("New item id",i),[...o,new I({...e,hasMoved:!0,id:i})]):(o.find(l=>l.id==e.id).hasMoved||(o.find(l=>l.id==e.id).hasMoved=!0,o.find(l=>l.id==e.id).sectionCell=e.sectionCell),o))),Te&&Ie&&r){Le(null);return}}function Nn(n){F.find(e=>e.name==n.name&&!e.hasMoved&&!e.starterItem)||y(e=>[...e,n])}d.useEffect(()=>{Ie?(console.log("Adding placing item",Ie.id),Xe(Ie.id)):(console.log("Removing placing item",$e),Xe(""))},[Ie]);function Zt(n){console.log("Removing item",n.id),y(e=>e.filter(s=>s.id!=n.id))}function Mn(n,e){const s=Array.from(c?H.find(o=>o.sectionName===A).cells:R);ke(!0);const a=o=>{const l=o%2===1;return{cellsWide:l?n.cellsTall:n.cellsLong,cellsTall:l?n.cellsLong:n.cellsTall}},i=n.rotation||0,r=a(i);for(let o=0;o<r.cellsTall;o++)for(let l=0;l<r.cellsWide;l++)s[e.y+o][e.x+l].hasItem=!1,s[e.y+o][e.x+l].itemId="";if(c){const o=H.find(l=>l.sectionName===A);o&&(o.cells=s.map(l=>l.map(u=>({...u}))),oe([...H])),oe(l=>l.map(u=>u.sectionName===A?{...u,cells:s}:u))}else k(s);if(ee!=="placing-sections"||!se){const o=c?j.find(l=>l.name===A):xe(e,j);o.items=o.items.filter(l=>l.id!=n.id),console.log("DELETING ITEM section",n.id),console.log("SECTION ITEMS AFTER DELETE",o.items)}y(o=>(console.log("Removing item new",n.id),console.log("ITEMS AFTER REMOVE",o.filter(l=>l.id!=n.id)),o.filter(l=>l.id!=n.id))),_(o=>{const l=o.findIndex(u=>u.item.name==n.name&&!u.item.hasMoved);if(l!==-1){const u=[...o];return u[l].quantity>0&&(u[l].quantity+=1),u}else return[...o,new ge({item:new I({...n,hasMoved:!1}),quantity:1})]})}function En(n,e){const s=Array.from(c?H.find(u=>u.sectionName===A).cells:R);console.log("DELETING ITEM ROTATE",n.id,n.rotation),ke(!0);const a=u=>{const g=u%2===1;return{cellsWide:g?n.cellsTall:n.cellsLong,cellsTall:g?n.cellsLong:n.cellsTall}},i=n.rotation||0,r=a(i);for(let u=0;u<r.cellsTall;u++)for(let g=0;g<r.cellsWide;g++)console.log("Deleting cell",e.y+u,e.x+g),s[e.y+u][e.x+g].hasItem=!1,s[e.y+u][e.x+g].itemId="";if(c){const u=H.find(g=>g.sectionName===A);u&&(u.cells=s.map(g=>g.map(h=>({...h}))),oe([...H])),oe(g=>g.map(h=>h.sectionName===A?{...h,cells:s}:h))}else k(s);console.log("DELETING ITEM",n.id);const o=c?j.find(u=>u.name===A):xe(e,j);o.items=o.items.filter(u=>u.id!=n.id);const l=new f({x:e.x-o.cellId.x,y:e.y-o.cellId.y});n.sectionCell=l,o.items.push(n)}function Yt(n,e){const s=c?H.find(r=>r.sectionName===A).cells:R,a=Array.from(s);if(s[n.y]==null){console.log("Start cell is out of bounds",n),at();return}const i=Lt(n,e);a.forEach(r=>r.forEach(o=>{o.mouseOver=!1,o.canPlaceItem=!1,o.mouseOverLocation=""}));for(let r=0;r<e.cellsTall;r++)for(let o=0;o<e.cellsLong;o++)n.y+r<a.length&&n.x+o<a[n.y+r].length&&(e.cellsLong===1&&e.cellsTall===1?a[n.y+r][n.x+o].mouseOverLocation="single":e.cellsTall===1?o===0?a[n.y+r][n.x+o].mouseOverLocation="leftFull":o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="rightFull":a[n.y+r][n.x+o].mouseOverLocation="middleFull":e.cellsLong===1?r===0?a[n.y+r][n.x+o].mouseOverLocation="topFull":r===e.cellsTall-1?a[n.y+r][n.x+o].mouseOverLocation="bottomFull":a[n.y+r][n.x+o].mouseOverLocation="middleVFull":r===0&&o===0?a[n.y+r][n.x+o].mouseOverLocation="topLeftCorner":r===0&&o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="topRightCorner":r===e.cellsTall-1&&o===0?a[n.y+r][n.x+o].mouseOverLocation="bottomLeftCorner":r===e.cellsTall-1&&o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="bottomRightCorner":r===0?a[n.y+r][n.x+o].mouseOverLocation="top":r===e.cellsTall-1?a[n.y+r][n.x+o].mouseOverLocation="bottom":o===0?a[n.y+r][n.x+o].mouseOverLocation="left":o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="right":a[n.y+r][n.x+o].mouseOverLocation="middle",a[n.y+r][n.x+o].mouseOver=!0,a[n.y+r][n.x+o].canPlaceItem=i);if(c){const r=H.find(o=>o.sectionName===A);r&&(r.cells=a.map(o=>o.map(l=>({...l}))),oe([...H])),oe(o=>o.map(l=>l.sectionName===A?{...l,cells:a}:l))}else k(a)}function at(){const n=Array.from(c?H.find(e=>e.sectionName===A).cells:R);if(n.forEach(e=>e.forEach(s=>{s.mouseOver=!1,s.canPlaceItem=!1,s.mouseOverLocation=""})),c){const e=H.find(s=>s.sectionName===A);e&&(e.cells=n.map(s=>s.map(a=>({...a}))),oe([...H])),oe(s=>s.map(a=>a.sectionName===A?{...a,cells:n}:a))}else k(n)}d.useEffect(()=>{Ln(A,H,j)},[A]),d.useEffect(()=>{const n=()=>{const e=F.find(s=>s.id===L);console.log("Unselecting item",L),w(null),e&&(le(s=>[...s,e.id]),console.log("Unselecting item",e.id),setTimeout(()=>{le(s=>s.filter(a=>a!==e.id))},300))};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[L,F]);function Jt(n){w(null),le(e=>[...e,n]),console.log("Unselecting item",n),setTimeout(()=>{le(e=>e.filter(s=>s!==n))},300)}function Ut(n){const e=F.find(s=>s.id===L);console.log("Unselecting item",L),w(n),e&&(le(s=>[...s,e.id]),console.log("Unselecting item",e.id),setTimeout(()=>{le(s=>s.filter(a=>a!==e.id))},300))}function At(n){_(e=>[...e,n])}const Ue=n=>{console.log("Preventing scroll"),n.preventDefault(),n.stopPropagation(),window.scrollTo(0,0)};d.useEffect(()=>(ft?(window.addEventListener("scroll",Ue),window.addEventListener("touchmove",Ue,{passive:!1})):(window.removeEventListener("scroll",Ue),window.removeEventListener("touchmove",Ue)),()=>{window.removeEventListener("scroll",Ue),window.removeEventListener("touchmove",Ue)}),[ft]);async function Cn(n){const e=[];z(!0);for(const i of n){const r=i.name,o=new f({x:i.sectionCell.x,y:i.sectionCell.y}),l=new O({name:r,cellId:o,cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:[],startingItems:[],items:[]});e.push(l)}let s=0,a=0;for(const i of e)console.log("Generating cells for section",i.name,"at",i.cellId,"with size",i.cellsLong,"x",i.cellsTall),console.log("Needed section Width:",i.cellsLong+i.cellId.x,"Current width:",s),i.cellsLong+i.cellId.x>s&&(console.log("Added section Width:",i.cellsLong+i.cellId.x),s+=i.cellsLong+i.cellId.x-s),console.log("Needed section Height:",i.cellsTall+i.cellId.y,"Current height:",a),i.cellsTall+i.cellId.y>a&&(console.log("Added section Height:",i.cellsTall+i.cellId.y),a+=i.cellsTall+i.cellId.y-a);await Qn(U,q,e,s,a),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=create-area&stage=modify-sections`}async function Rn(n,e){const s=[];z(!0);for(const a of e){const i=a.name,r=new f({x:a.cellId.x,y:a.cellId.y});console.log("Saving section modifier items for section",i,a.items.map(l=>l.name),"at cell",r);const o=new O({name:i,cellId:r,cellsLong:a.cellsLong,cellsTall:a.cellsTall,startingItems:[],items:[],modifierItems:a.items.map(l=>new $({cell:new f({x:l.sectionCell.x,y:l.sectionCell.y}),item:new I({...l,isSectionModifier:!0})}))});s.push(o)}console.log("Saving section modifier items",s),await zn(U,q,s),console.log("Section modifier items saved successfully"),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=create-area&stage=placing-items`}async function Ht(n,e){z(!0);const s=[];for(const a of n){const i=a.name,r=new f({x:a.cellId.x,y:a.cellId.y}),o=new O({name:i,cellId:r,cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(l=>new $({cell:new f({x:l.sectionCell.x,y:l.sectionCell.y}),item:new I({...l,starterItem:!0})})),items:[]});s.push(o)}console.log("Saving area sections",s),localStorage.setItem("screenshotSections",s.map(a=>JSON.stringify(a.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",s.map(a=>JSON.stringify(a.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async a=>{if(console.log("Storage event",a),a.key==="screenshot"){const i=new qn({id:q,name:lt.name,sections:s,templates:lt?.templates||[],previewImage:a.newValue,width:lt.width,height:lt.height,inventoryItems:e.map(r=>new ge({item:new I({...r.item,starterItem:!0}),quantity:r.quantity}))});await $n(U,i),console.log("Area saved successfully"),z(!1),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=view-area`}})}function kn(n){const e=Array.from(c?H.find(s=>s.sectionName===A).cells:R);if(e[n.y]!=null)if(e[n.y][n.x].mouseOver=!0,e[n.y][n.x].canPlaceItem=!0,e[n.y][n.x].mouseOverLocation="single",pt(s=>[...s,n]),c){const s=H.find(a=>a.sectionName===A);s&&(s.cells=e.map(a=>a.map(i=>({...i}))),oe([...H])),oe(a=>a.map(i=>i.sectionName===A?{...i,cells:e}:i))}else k(e)}function Dn(n){const e=Array.from(c?H.find(o=>o.sectionName===A).cells:R);ke(!0);const s=[];ht.forEach(o=>{s.some(l=>l.toId()===o.toId())||s.push(o)}),pt([]),console.log("PLACING HUGHCELLS");const a=[],i=Y.findIndex(o=>o.item.name==n.name&&!o.item.hasMoved);let r=i!==-1?Y[i].quantity:0;s.forEach(o=>{const l=new I({...n});if(l.id=l.name+Math.floor(Math.random()*1e5).toString(),console.log("Placing item",l.name,"at",o.toId(),"CAN PLACE?",Gt(e,o,l)),Gt(e,o,l)&&r!=0){if(i!==-1&&(r-=1),ee!=="placing-sections"||!se){const g=c?j.find(S=>S.name===A):xe(o,j);console.log("Adding item to section",g.name,"at",g.cellId,"with cell",o.toId(),o.x-g.cellId.x,o.y-g.cellId.y);const h=new f({x:o.x-g.cellId.x,y:o.y-g.cellId.y});l.sectionCell=h,console.log("Adding item to section",g.name,"at",h,l),g.items.push(l),console.log("SECTION ITEMS",g.items.map(S=>S.name))}else l.sectionCell=new f({x:o.x,y:o.y});for(let g=0;g<n.cellsTall;g++)for(let h=0;h<n.cellsLong;h++)e[o.y+g][o.x+h].hasItem=!0,e[o.y+g][o.x+h].itemId=l.id;l.hasMoved=!0,l.starterItem=!0,l.isDisplayItem=!1,l.initialElement=document.querySelector(`.App #${o.toId()}.cell:not(.cell-border)`);const u=new I({...l});a.push(u)}});for(const o of a)console.log("Adding item to items",o.id),y(l=>[...l,o]);if(i!==-1&&_(o=>{const l=[...o];return l[i].quantity>0&&(l[i].quantity=r,l[i].quantity==0&&l.splice(i,1)),l}),r==0&&Le(null),c){const o=H.find(l=>l.sectionName===A);o&&(o.cells=e.map(l=>l.map(u=>({...u}))),oe([...H])),oe(l=>l.map(u=>u.sectionName===A?{...u,cells:e}:u))}else k(e);fe(j)}function Pn(n,e,s){z(!0);const a=[];for(const i of n){const r=i.name,o=new f({x:i.cellId.x,y:i.cellId.y}),l=i.items.filter(h=>h.isBooth),u=i.items.filter(h=>!h.isBooth),g=new O({name:r,cellId:o,cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:u.map(h=>new $({cell:new f({x:h.sectionCell.x,y:h.sectionCell.y}),item:new I({...h,displayItem:!0})})),booths:l.map(h=>new je({id:h.name+Math.floor(Math.random()*1e5).toString(),name:h.name,cell:new f({x:h.sectionCell.x,y:h.sectionCell.y}),cellsLong:h.cellsLong,cellsTall:h.cellsTall,user:h.boothUser})),items:[]});a.push(g)}console.log("Saving area sections",a),localStorage.setItem("screenshotSections",a.map(i=>JSON.stringify(i.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",a.map(i=>JSON.stringify(i.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async i=>{if(console.log("Storage event",i),i.key==="screenshot"){const r=new Pe({id:s.id,name:s.name,sections:a,areaId:q,previewImage:i.newValue,inventoryItems:e.map(o=>new ge({item:new I({...o.item,starterItem:!0}),quantity:o.quantity}))});await Be(U,r),console.log("Booth Map saved successfully"),z(!1),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=view-boothMap&boothMapId=${Dt}`}})}return d.useEffect(()=>{const n=e=>{e.key==="Escape"&&(console.log("Escape key pressed"),ht.length>0?(console.log("There are highlighted cells"),pt([]),at()):Le(null))};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[ht]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"App",children:[t.jsx("h1",{className:"title",children:"LayItOut"}),t.jsx("br",{}),Qe&&t.jsxs("div",{className:"area-creation",children:[It?t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"area-creation-title",children:"You have already picked a booth"}),t.jsxs("label",{htmlFor:"",children:["Contact ",rn?.supportEmail," to change booths"]})]}):t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"area-creation-title",children:"Picking Booth"}),t.jsx("label",{htmlFor:"",children:"Tap on an open booth then click on the checkmark to pick a booth"})," "]}),t.jsxs("label",{htmlFor:"",children:["Booth Size: ",Se?.plotWidth,"ft x ",Se?.plotHeight,"ft"]}),t.jsx("br",{})]}),tt&&t.jsxs("div",{className:"area-creation",children:[t.jsx("h2",{className:"area-creation-title",children:"Create Booth Map"}),t.jsx("label",{htmlFor:"",children:"Create a booth map by placing items and then creating and placing booths, same way you create and place items"})]}),se&&t.jsxs("div",{className:"area-creation",children:[t.jsx("h2",{className:"area-creation-title",children:"Create Area"}),t.jsx("label",{htmlFor:"",children:ee=="placing-sections"?"Create new sections and place them":ee=="modify-sections"?"Add walls and doors to sections":"Add items to the inventory and place items"})]}),(J||B)&&t.jsxs("div",{className:"template-name-row",children:[t.jsx("label",{htmlFor:"template-name",children:"Template Name:"}),t.jsx("input",{type:"text",id:"template-name",name:"template-name",onChange:n=>kt(n.target.value),value:Je})]}),(Q||Ze)&&t.jsxs("div",{className:"design-name-row",children:[t.jsxs("label",{htmlFor:"design-name",children:["Design Name: ",Ye]}),Q&&De&&t.jsxs("p",{children:["Design was submitted on ",Bt?.toLocaleDateString()]})]}),(J||B)&&t.jsxs("div",{className:"template-creation",children:[t.jsxs("button",{className:"action-btn",onClick:()=>{if(Je.trim()==""){alert("Please enter a template name");return}if(Me.some(n=>n.name===Je&&(B?n.id!==Pt.id:!0))){alert("Template with this name already exists");return}B?(z(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){pe(!1);const s=Me.map(a=>a.id===Pt.id?(console.log("SECTION",j),new ve({name:Je,inventoryItems:Y,previewImage:e.newValue,sections:j.map(i=>new O({name:i.name,cellId:new f({x:a.sections.find(r=>r.name==i.name).cellId.x,y:a.sections.find(r=>r.name==i.name).cellId.y}),cellsLong:i.cellsLong,modifierItems:i.modifierItems,cellsTall:i.cellsTall,startingItems:i.items.map(r=>new $({cell:new f({x:r.sectionCell.x,y:r.sectionCell.y}),item:new I({...r,starterItem:!0})}))})),id:a.id})):new ve({name:a.name,previewImage:a.previewImage,inventoryItems:a.inventoryItems,sections:a.sections.map(i=>new O({name:i.name,cellId:new f({x:i.cellId.x,y:i.cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(r=>new $({cell:new f({x:r.cell.x,y:r.cell.y}),item:new I({...r.item})}))})),id:a.id}));qe(U,q,s).then(()=>{console.log("Template updated successfully"),z(!1);const a=new URLSearchParams(window.location.search),i=a.get("companyId"),r=a.get("areaId");window.location.href=`/Layout/?companyId=${i}&areaId=${r}&type=view-area`})}})},500)):(z(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){pe(!1);const s=new ve({name:Je,previewImage:e.newValue,inventoryItems:Y,sections:j.map(i=>new O({name:i.name,cellId:new f({x:K.find(r=>r.name==i.name).cellId.x,y:K.find(r=>r.name==i.name).cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.items.map(r=>new $({cell:new f({x:r.sectionCell.x,y:r.sectionCell.y}),item:new I({...r,starterItem:!0})}))})),id:Je+(Math.random()*1e4).toString()}),a=[...Me.map(i=>new ve({name:i.name,previewImage:i.previewImage,inventoryItems:i.inventoryItems,sections:i.sections.map(r=>new O({name:r.name,cellId:new f({x:r.cellId.x,y:r.cellId.y}),cellsLong:r.cellsLong,cellsTall:r.cellsTall,modifierItems:r.modifierItems,startingItems:r.startingItems.map(o=>new $({cell:new f({x:o.cell.x,y:o.cell.y}),item:new I({...o.item})}))})),id:i.id})),s];qe(U,q,a).then(()=>{console.log("Template updated successfully"),z(!1);const i=new URLSearchParams(window.location.search),r=i.get("companyId"),o=i.get("areaId");window.location.href=`/Layout/?companyId=${r}&areaId=${o}&type=view-area`})}})},500))},children:[J?"Create":"Save"," Template"]}),t.jsx("button",{className:"action-btn",onClick:()=>{const n=new URLSearchParams(window.location.search),e=n.get("companyId"),s=n.get("areaId");window.location.href=`/Layout/?companyId=${e}&areaId=${s}&type=view-area`},children:"Cancel"})]}),Ve&&!De&&t.jsxs("div",{className:"template-creation",children:[pn&&t.jsx("button",{className:"action-btn",onClick:()=>{z(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){pe(!1);const s=new Nt({name:Ye,previewImage:e.newValue,submitted:!1,dateSubmitted:null,areaId:q,inventoryItems:Y,sections:j.map(a=>new O({name:a.name,cellId:new f({x:K.find(i=>i.name==a.name).cellId.x,y:K.find(i=>i.name==a.name).cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(i=>new $({cell:new f({x:i.sectionCell.x,y:i.sectionCell.y}),item:new I({...i,starterItem:!0})}))})),id:ot});Mt(U,q,s).then(()=>{console.log("Design updated successfully"),ke(!1),z(!1)})}})},500)},children:"Save"}),t.jsx("button",{className:"action-btn",onClick:()=>{z(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){pe(!1);const s=new Nt({name:Ye,previewImage:e.newValue,submitted:!0,dateSubmitted:new Date,areaId:q,inventoryItems:Y,sections:j.map(a=>new O({name:a.name,cellId:new f({x:K.find(i=>i.name==a.name).cellId.x,y:K.find(i=>i.name==a.name).cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(i=>new $({cell:new f({x:i.sectionCell.x,y:i.sectionCell.y}),item:new I({...i,starterItem:!0})}))})),id:ot});Mt(U,q,s).then(()=>{console.log("Design updated successfully"),ke(!1),z(!1),Ot(!0),Wt(new Date)})}})},500)},children:"Submit"})]}),Ve&&De&&t.jsxs("div",{className:"area-creation",children:[t.jsxs("label",{htmlFor:"",children:["Design was submitted on ",Bt?.toLocaleDateString()]}),t.jsx("br",{})]}),!Q&&!Ee&&!be&&!Qe&&!Ze&&!(De&&Ve)&&t.jsxs("div",{className:"place-mode-row",children:[t.jsx("label",{htmlFor:"tap-and-place-mode",children:"Place Mode: "}),t.jsxs("select",{id:"tap-and-place-mode",name:"tap-and-place-mode",value:Te?"tap":"drag",onChange:n=>Et(n.target.value==="tap"),className:"place-mode-select",children:[t.jsx("option",{value:"drag",children:"Drag and Drop"}),t.jsx("option",{value:"tap",children:"Tap and Place"})]})]}),gt&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader-backdrop",children:t.jsx("div",{className:"loader"})})})," ",t.jsxs("div",{className:"layout",children:[!Q&&!Ee&&!be&&!Qe&&!Ze&&!(De&&Ve)&&t.jsx(nl,{canEditItem:se&&ee=="placing-items"||et,onEditItem:n=>{Sn(n),Tt.current?.showModal()},setSelectedItem:Le,tapAndPlaceMode:Te,isModifyingSections:se&&ee=="modify-sections",isViewingDesign:Q,isEditingTemplate:B,isCreatingTemplate:J,maxHeight:c?200:b*M,showAddCustomItem:()=>{ee=="placing-sections"&&se?xt.current?.showModal():ee=="placing-items"&&se||et?vt.current?.showModal():wt.current?.showModal()},addDraggingItem:Nn,removeItem:Zt,inventoryItems:Y.map(n=>new ge({item:new I({...n.item,displayItem:!0}),quantity:n.quantity}))}),be&&ie?t.jsx(ul,{onDeleteVendor:async n=>{z(!0);const e=new Pe({...ie,vendors:ie.vendors.filter(s=>s.id!==n),sections:ie.sections.map(s=>new O({...s,booths:s.booths.map(a=>a.user?.id===n?new je({...a,user:null,initialElement:a.initialElement??void 0}):a)}))});await Be(U,e),Re(e),window.location.reload()},onEditVendor:n=>{xn(n),St.current?.showModal()},boothMap:ie,vendors:ie?.vendors??[],maxHeight:c?void 0:b*M,onAddVendor:()=>{bt.current?.showModal()}}):null,c?t.jsxs("div",{className:"mobile-areas",style:{height:X+"px"},children:[j.length>1&&t.jsx("img",{src:rt,onClick:()=>{const n=j.findIndex(s=>s.name==A);if(n===-1)return;const e=(n-1+j.length)%j.length;G(j[e].name),console.log("Changing viewing section to",j[e].name)},className:"back-mobile-areas"}),Ge.map((n,e)=>t.jsx(Qt,{width:n.width,height:n.height,cells:Ft(H.find(s=>s.sectionName==n.sectionName).cells),id:n.sectionName,visibile:A==null?!0:n.sectionName==A,section:n.sectionName},e)),j.length>1&&t.jsx("img",{src:rt,onClick:()=>{const n=j.findIndex(s=>s.name==A);if(n===-1)return;const e=(n+1)%j.length;G(j[e].name),console.log("Changing viewing section to",j[e].name)},className:"forward-mobile-areas"})]}):t.jsx(Qt,{width:Z*M,height:b*M,cells:Ft(R)}),(ee=="placing-items"||!se)&&t.jsx(hl,{maxHeight:c?void 0:b*M})]}),be&&t.jsx("div",{className:"design-view",children:t.jsx("button",{className:"action-btn",onClick:()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,booths:e.booths,startingItems:e.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("printSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),window.open(window.location.origin+`/Print/?companyId=${U}&areaId=${q}&designName=${ie?.name}`,"_blank")},children:"Print"})}),Q&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,booths:e.booths,startingItems:e.items.map(s=>new $({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("printSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),window.open(window.location.origin+`/Print/?companyId=${U}&areaId=${q}&designName=${Ye}&designId=${ot}`,"_blank")},children:"Print"}),t.jsx("button",{className:"action-btn",onClick:()=>{const n=new ve({name:Ye,previewImage:nt.previewImage,inventoryItems:nt.inventoryItems,sections:nt.sections,id:nt.name+(Math.random()*1e4).toString()}),e=[...Me.map(s=>new ve({name:s.name,previewImage:s.previewImage,inventoryItems:s.inventoryItems,sections:s.sections.map(a=>new O({name:a.name,cellId:new f({x:a.cellId.x,y:a.cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.startingItems.map(i=>new $({cell:new f({x:i.cell.x,y:i.cell.y}),item:new I({...i.item})}))})),id:s.id})),n];qe(U,q,e).then(()=>{console.log("Template updated successfully"),Oe(e),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=edit-template&templateId=${n.id}`})},children:"Turn into a Template"}),t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=desings"},children:"Back"})]}),be&&t.jsx("div",{className:"design-view",children:t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=boothmaps"},children:"Back"})}),Ee&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=edit-area`},children:"Edit Area"}),t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=areas"},children:"Back"})]}),et&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:async()=>{await Ht(j,Y)},children:"Save Area"}),t.jsx("button",{className:"action-btn",onClick:async()=>{z(!0),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=view-area`},children:"Back"})]}),se&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{ee=="placing-sections"?Cn(F.filter(n=>n.isSectionItem)):ee=="modify-sections"?Rn(F.filter(n=>n.isSectionModifier),j):ee=="placing-items"&&Ht(j,Y)},children:ee=="placing-items"?"Create Area":"Next"}),t.jsx("button",{className:"action-btn",onClick:async()=>{z(!0),await Yn(U,q),window.location.href="/"},children:"Cancel"})]}),tt&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{console.log("Creating booth map with sections",j,"and inventory items",Y,"and boothMap",ie),Pn(j,Y,ie)},children:"Create Booth Map"}),t.jsx("button",{className:"action-btn",onClick:async()=>{z(!0),await Jn(U,q,Dt),window.location.href="/?view=boothmaps"},children:"Cancel"})]})]}),t.jsxs("div",{children:[j.map(n=>t.jsx(Fn,{takingPhoto:!1,section:n,visible:A==null?!0:n.name==A,cellSize:M},n.cellId.toId())),F.map(n=>t.jsx(Gn,{isPlacingItem:Ie!=null,isCreatingArea:se,isCreatingTemplate:J||B,cellSize:M,isViewingDesign:Q||Ee||be||Qe||Ze||De&&Ve,removeItem:Zt,visible:c?!n.hasMoved&&!n.starterItem?!0:A==null?!1:n.isSectionModifier?j.find(e=>e.name==A)?.modifierItems.some(e=>e.item.id===n.id):n.starterItem?j.find(e=>e.name==A)?.startingItems.some(e=>e.item.id===n.id):j.find(e=>e.name==A)?.items.some(e=>e.id===n.id):!0,item:n,canPlaceItem:Lt,placeItem:Vt,deleteItemRotate:En,highlightCells:Yt,unHighlightCells:at,deleteItem:Mn,isSelected:L===n.id,onSelect:Ut,isUnselecting:P.includes(n.id),onDeselect:()=>Jt(n.id)},n.id)),Ke.map(n=>(console.log("CAN PICK BOOTH",n.cellsLong==Se?.plotWidth&&n.cellsTall==Se.plotHeight,"BOOTH",n,"VENDOR",Se),t.jsx(Vn,{canPick:be||It||n.cellsLong==Se?.plotWidth&&n.cellsTall==Se.plotHeight,visible:c?A==null?!1:j.find(e=>e.name==A)?.booths.some(e=>e.id===n.id)??!1:!0,booth:n,isViewingBooth:be,isPublicViewingBooth:Ze,hasPickedBooth:It,isSelected:L==n.id,cellSize:M,onSelect:Ut,isUnselecting:P.includes(n.id),onDeselect:()=>Jt(n.id),onPickBooth:async e=>{z(!0);const s=j.map(i=>i.name===A?new O({...i,booths:i.booths.map(r=>r.id===e?new je({...r,user:Se,initialElement:r.initialElement??void 0}):r)}):i.booths.some(r=>r.id===e)?new O({...i,booths:i.booths.map(r=>r.id===e?new je({...r,user:Se,initialElement:r.initialElement??void 0}):r)}):i);console.log("Updated sections",s),fe(s);const a=new Pe({...ie,sections:s});await Be(U,a),window.location.reload(),z(!1)},onRemoveVendorFromBooth:()=>{z(!0);const e=j.map(a=>new O({...a,booths:a.booths.map(i=>i.user?.id===n.user?.id?new je({...i,user:null,initialElement:i.initialElement??void 0}):i)})),s=new Pe({...ie,sections:e});Be(U,s).then(()=>{window.location.reload()})},onAddVendorToBooth:()=>{vn(n),jt.current?.showModal()}},n.id)))]}),c&&!gt&&t.jsx("div",{className:"layout-icon",onClick:()=>{We.current?.showModal(),he(!0),console.log("Showing layout dialog")},children:t.jsx("img",{src:ol,alt:""})}),!gt&&!(J||et||B||Q||tt||se||be||Qe||Ze||De&&Ve)&&t.jsx("div",{className:"template-icon",onClick:()=>{ye.current?.showModal(),Fe(!0),console.log("Showing template dialog")},children:t.jsx("img",{src:sl,alt:""})}),t.jsx(il,{isViewingArea:Ee,dialogRef:ye,isOpen:_e,closeDialog:()=>{ye.current?.close(),Fe(!1)},duplicateTemplate:n=>{const e=new ve({name:n.name+" Copy",previewImage:n.previewImage,inventoryItems:n.inventoryItems,sections:n.sections,id:n.name+"Copy"+(Math.random()*1e4).toString()}),s=[...Me.map(a=>new ve({name:a.name,previewImage:a.previewImage,inventoryItems:a.inventoryItems,sections:a.sections.map(i=>new O({name:i.name,cellId:new f({x:i.cellId.x,y:i.cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(r=>new $({cell:new f({x:r.cell.x,y:r.cell.y}),item:new I({...r.item})}))})),id:a.id})),e];qe(U,q,s).then(()=>{ye.current?.close(),console.log("Template updated successfully"),Oe(s),Fe(!1),window.location.href=`/Layout/?companyId=${U}&areaId=${q}&type=edit-template&templateId=${e.id}`})},templates:Me,selectTemplate:n=>{z(!0),setTimeout(async()=>{const e=n.sections.map(s=>new O({name:s.name,cellId:new f({x:n.sections.find(a=>a.name==s.name).cellId.x,y:n.sections.find(a=>a.name==s.name).cellId.y}),cellsLong:s.cellsLong,cellsTall:s.cellsTall,modifierItems:s.modifierItems,startingItems:s.startingItems.map(a=>new $({cell:new f({x:a.cell.x,y:a.cell.y}),item:new I({...a.item,starterItem:!0})}))}));localStorage.setItem("screenshotSections",e.map(s=>JSON.stringify(s.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",e.map(s=>JSON.stringify(s.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),pe(!0),window.addEventListener("storage",async s=>{if(console.log("Storage event",s),s.key==="screenshot"){pe(!1);const a=new Nt({name:Ye,previewImage:s.newValue,areaId:q,submitted:!1,dateSubmitted:null,inventoryItems:n.inventoryItems,sections:n.sections.map(i=>new O({name:i.name,cellId:new f({x:n.sections.find(r=>r.name==i.name).cellId.x,y:n.sections.find(r=>r.name==i.name).cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(r=>new $({cell:new f({x:r.cell.x,y:r.cell.y}),item:new I({...r.item,starterItem:!0})}))})),id:ot});console.log("UPDATED DESIGN",a),Mt(U,q,a).then(()=>{console.log("Design updated successfully"),ke(!1),z(!1),window.location.reload()})}})},500)}}),t.jsx(ll,{dialogRef:We,closeDialog:()=>{We.current?.close(),he(!1)},areaPreview:fn||""}),t.jsx(al,{canBeBooth:tt,dialogRef:wt,addInventoryItem:At,closeDialog:()=>{wt.current?.close()}}),t.jsx(cl,{dialogRef:xt,closeDialog:()=>{xt.current?.close()},addSection:At}),t.jsx(rl,{dialogRef:vt,closeDialog:()=>{vt.current?.close()},addInventoryItem:At}),t.jsx(dl,{placeMultiItem:Dn,addHighlightedCell:kn,item:Ie,setSelectingItem:()=>{Le(null)},canPlaceItem:Lt,placeItem:Vt,highlightCells:Yt,unHighlightCells:at,cellSize:M}),t.jsx(gl,{dialogRef:bt,closeDialog:()=>{bt.current?.close()},addVendor:async n=>{const e=new Pe({...ie,vendors:[...ie.vendors,n]});Re(e),await Be(U,e)}}),t.jsx(fl,{oldVendor:wn,dialogRef:St,closeDialog:()=>{St.current?.close()},editVendor:async n=>{const e=new Pe({...ie,vendors:ie.vendors.map(s=>s.id===n.id?n:s)});Re(e),await Be(U,e)}}),t.jsx(Il,{dialogRef:Tt,closeDialog:()=>{Tt.current?.close()},deleteInventoryItem:n=>{_(e=>e.filter(s=>s.item.id!==n.item.id))},editInventoryItem:n=>{_(e=>e.map(s=>s.item.id===n.item.id?n:s))},selectedItem:bn}),t.jsx(pl,{dialogRef:jt,vendors:ie?.vendors.filter(n=>!An(n,ie))??[],closeDialog:()=>{jt.current?.close()},addVendorToBooth:async n=>{z(!0);const e=j.map(a=>a.name===A?new O({...a,booths:a.booths.map(i=>i.id===yt.id?new je({...i,user:n,initialElement:i.initialElement??void 0}):i)}):a.booths.some(i=>i.id===yt.id)?new O({...a,booths:a.booths.map(i=>i.id===yt.id?new je({...i,user:n,initialElement:i.initialElement??void 0}):i)}):a);console.log("Updated sections",e),fe(e);const s=new Pe({...ie,sections:e});await Be(U,s),window.location.reload(),z(!1)}}),ft&&t.jsx("iframe",{id:"screenshot-iframe",title:"Screenshot Iframe",src:window.location.origin+"/Preview/",width:N*M+20,height:C*M+20})]})}

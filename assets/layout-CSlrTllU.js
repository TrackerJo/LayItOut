import{r as d,j as t,c as On}from"./index-BNCXs9B3.js";import{A as Xt,S as Fn,D as Gn,B as Vn}from"./booth_item-BAf2Q2gR.js";import{I,E as qe,G as ue,z as Zn,H as f,V as Qt,J as O,K as q,T as xe,D as At,L as Nt,B as ke,M as je,N as De,k as Jn,n as Yn,O as Un,P as ct,Q as Hn,R as Xn,U as Qn,W as zn,A as qn,X as $n}from"./firestore-DnikGjYO.js";import{F as rt}from"./forward-An_qFV6V.js";import{I as Kn,L as _n,T as el}from"./inventory_item_tile-dj6osfPl.js";const zt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE02lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTE2PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmRiZTM1YTM5LWE0MDUtNDM2MC04YzRjLWI3NmJmMTY3Mjc1YjwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5hZGQtaXRlbSAtIDc8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOnBkZj0naHR0cDovL25zLmFkb2JlLmNvbS9wZGYvMS4zLyc+CiAgPHBkZjpBdXRob3I+U2FyYWggS2VtbWVOYXNoPC9wZGY6QXV0aG9yPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczp4bXA9J2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8nPgogIDx4bXA6Q3JlYXRvclRvb2w+Q2FudmEgKFJlbmRlcmVyKSBkb2M9REFHdTJ5dUVOWkEgdXNlcj1VQUZqR1c2eHRDUSBicmFuZD1bQVJDSElWRURdIEZvcnQgV2F5bmUgQ29tbXVuaXR5IFNjaG9vbHMgdGVtcGxhdGU9PC94bXA6Q3JlYXRvclRvb2w+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0ncic/PupmVZwAAAT8SURBVHic7d1PaBxVHMDxX41Wh6DsE1FcweGltiAUpE7Vanm9BGzGqvGgJ9e/bRSliHrwkIueiif/gShkVFRGLCbR4p8ulSBMEEul7+rJF6jgXqQTFSEiK15m4yTZze7MvJn3m5nf95p9+xv4MLOZycxmB1Co2mF6A6iNEQiyCARZBIIsAkEWgSCLQJBFIMgiEGQRCLIIBFkEgiwCGVCDi7GJydnjbOLQEQC4AQBUqAJfeu6nec4lkD41uLjcmWl/AQBTm38WquAd6bnP5jV7LK83LmsRxucA4Pb7ucXs2xgX13ek/1Ue8wkk1jCMXhaz9zMurutI/2vd20AgUQ0udkaHqW0xekV7yrUd6X+jczsIBNYxFgDgSJJ1Eco1Hemf1rUttQeJYdybZr3F7NsZF1d3pN/WsT21BmlwcZkz016ElBi9LGbfwbhgOlBqDXLwpZ8WAeB+He9lMfsA4+KqjvTPZHmfWoMwLpoWsw/rej+L2XcyLq7MglJrkI70f2Bc/KkZ5S7GxXhH+t+mWV9rEIB1lD80oxxkXFzsSP9c0rW1BwEA6Ej/LOPid4vZWy6VpM1i9oFQLb+2tnrh3yTrLtG1AZhrcLFz8sRfLze4sAa9RnruG6EKXtQ4lrEJsTfposqDROcZ8wDwijPT/rLBxRWDXis99/VQBc9rHP930gWVvto74KTvzPm5qenVleW1QetuPXb6OTZx6M2M439Zmh2/Memiyu4hsT1j80nf3c5M+9SQPeWtUAUvZJmf9vBXyQ/12J5x34CX7Go6rf2hWp5fW73Q7feC6IP+osXskS42xgtV8LT03I+TrgOoIEiCa1M3NZ2WMwTlHOPiN4vZ94w6P1TBU9Jz55Jsc7xKgaS4ULh7BJQfR0UJVXBUeu57SbZ5c5UByXDVdnfTae3LihKq4EnpuR8knL2lSoBkvYQOAHsilIUUKN1QBY9Jz/0o5ewNlR5EA0avNCjdUAWPSs/1M85er9QgGjF67Wk6rVsilL6XPGIoh0MVPKz7tqDSnhjGzjMG/WqbpVPn56YeWl1Z/mfQC/jk7K6VpRM/6x5cSpAc9ox+DUXJo9KdqReEAQAw7cy0Tza4uDTnORsq1WdIgRi9bm46rb2hWl5Mehk9baU5ZEU3JMyDpr+BJ2xhaXb8wSIGleKQFWF8BmYwIFTBd0XNQr+HxDCmTcwPVXBceu7bRc1DDVI3DADEIHXEAEAKUlcMAIQgdcYAQAZSdwwARCAIMJ6RnvuuidnxUIAQxv8ZByGMjRkFIYytGQMhjP4ZASGMwRUOQhjbVygIAoxMN7EVUWEghDFahYAQxujlDkIYycoVhDCSlxsIYaQrFxDCSJ92EAQYx7I+EmAyrSAIMI5Kz33fxGxdaQMhDD1pASEMfWUGIQy9ZQIhDP2lBiGMfEoFggBDywOWGEsM0uBiLLoL/YEctmdooQoel577oYnZRZT47nc2IfaBOYwnqowBAJDm6SAjjzBUfc/oVYrnQ+qCAVACkDphACAHqRsGAF6QbqiCR+qGAZDuQz3vel9X8YnpDTERtj2k1hgAuEBqjwGAB4QwojCAEEYs0yCEsSmTv2V1QxW08v43dGXLFEg3+vKvk4bmo83EIYswtinNHvIrALyadmCogu+l5+byPwCrkPGHPqmNEQiyCARZBIIsAkEWgSCLQJBFIMgiEGQRCLIIBFkEgqz/ADvdpRk/dmKqAAAAAElFTkSuQmCC";function tl({inventoryItem:c,addDraggingItem:P,removeItem:Z,setSelectedItem:v,tapAndPlaceMode:b,canEditItem:C,onEditItem:M}){const L=d.useRef(null),R=d.useRef(null),[S,k]=d.useState(12),[D,F]=d.useState(c.item),[w,H]=d.useState(!1);function V(B){const le=R.current,E=window.getComputedStyle(le),J=document.createElement("span");J.style.font=E.font,J.style.fontSize=B+"px",J.style.fontFamily=E.fontFamily,J.style.fontWeight=E.fontWeight,J.style.position="absolute",J.style.visibility="hidden",J.style.whiteSpace="nowrap",J.textContent=le.textContent,document.body.appendChild(J);const $=J.offsetWidth;return document.body.removeChild(J),$}function A(B){if(R.current){const le=R.current;return V(B-1)>le.offsetWidth&&B-1>8?A(B-1):B-1}return B}d.useEffect(()=>{setTimeout(()=>{R.current&&k(A(S))},100)},[]);const x=d.useCallback(()=>{if(console.log("MOUSE MOVE",w),w){if(H(!1),b)return;c.item.initialElement=L.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",c.item.id,"to initialElement",c.item.initialElement),F(new I({...c.item})),P(c.item),window.removeEventListener("mousemove",x),window.removeEventListener("touchmove",x)}},[w,b]);return d.useEffect(()=>(w?(window.addEventListener("touchmove",x),window.addEventListener("mousemove",x)):(window.removeEventListener("touchmove",x),window.removeEventListener("mousemove",x)),()=>{window.removeEventListener("touchmove",x),window.removeEventListener("mousemove",x)}),[w,x]),t.jsxs("div",{className:"display",children:[t.jsx("div",{ref:L,id:c.item.id,className:c.item.isSectionItem?"display-section":`display-item ${c.item.isSectionModifier?c.item.sectionModifierType.toString():""}`,style:{width:`${c.item.cellsLong*10}px`,height:`${c.item.cellsTall*10}px`},onMouseDown:B=>{H(!0)},onMouseUp:()=>{console.log("MOUSE UP"),H(!1)},onClick:B=>{if(!b){B.preventDefault(),B.stopPropagation();return}console.log("CLICKED ON ITEM",c.item.id,"with tap and place mode"),B.preventDefault(),B.stopPropagation(),c.item.initialElement=L.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),v(c.item)},onTouchStart:B=>{b||(B.preventDefault(),B.stopPropagation(),c.item.initialElement=L.current,c.item.id=c.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",c.item.id,"to initialElement",c.item.initialElement),F(new I({...c.item})),P(c.item))},children:c.item.isSectionModifier?c.item.sectionModifierType==="LeftDoor"||c.item.sectionModifierType==="RightDoor"?t.jsx("img",{src:c.item.icon,alt:"icon"}):null:c.item.icon.includes("custom-")?t.jsx("div",{className:c.item.isSectionItem?"custom-section":"custom-icon",children:t.jsx("div",{children:t.jsx("p",{ref:R,style:{fontSize:`${S}px`},children:c.item.icon.split("custom-")[1]})})}):t.jsx("img",{src:c.item.icon,alt:"icon"})}),t.jsx("p",{children:c.item.name}),c.quantity>0&&t.jsxs("p",{className:"quantity",children:["x",c.quantity]}),C&&t.jsx("img",{src:zt,alt:"Edit",className:"edit-icon",onClick:()=>M(c)})]})}const qt="/assets/plus.circle-Ce3xm00a.png";function nl({inventoryItems:c,addDraggingItem:P,maxHeight:Z,removeItem:v,showAddCustomItem:b,isCreatingTemplate:C,isEditingTemplate:M,isViewingDesign:L,tapAndPlaceMode:R,setSelectedItem:S,isModifyingSections:k,canEditItem:D,onEditItem:F}){return t.jsxs("div",{className:"toolbox",style:{maxHeight:Z?`${Z}px`:"200px"},children:[c.map(w=>t.jsx(tl,{canEditItem:D,onEditItem:F,setSelectedItem:S,tapAndPlaceMode:R,inventoryItem:w,addDraggingItem:P,removeItem:v})),!(C||M||L||k)&&t.jsx("div",{className:"add-item",onClick:()=>{b()},children:t.jsx("img",{src:qt,alt:"Add Item"})})]})}function ll({dialogRef:c,closeDialog:P,areaPreview:Z}){return t.jsx("dialog",{ref:c,className:"layout-dialog",children:t.jsxs("div",{className:"layout-dialog-div",children:[t.jsx("h2",{children:"Layout"}),t.jsx("img",{src:Z,alt:"Layout preview",className:"layout-dialog-preview"}),t.jsx("br",{}),t.jsx("button",{className:"layout-dialog-close",onClick:P,children:"Close"})]})})}const ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE2mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTAzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmE2MmM1Y2UxLTIzNTYtNGE3Ny1hNTAwLTViNWJjMjE1MDU3NzwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5VbnRpdGxlZCBkZXNpZ24gLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogIDxwZGY6QXV0aG9yPlNhcmFoIEtlbW1lTmFzaDwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcikgZG9jPURBR3UyeXVFTlpBIHVzZXI9VUFGakdXNnh0Q1EgYnJhbmQ9W0FSQ0hJVkVEXSBGb3J0IFdheW5lIENvbW11bml0eSBTY2hvb2xzIHRlbXBsYXRlPTwveG1wOkNyZWF0b3JUb29sPgogPC9yZGY6RGVzY3JpcHRpb24+CjwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9J3InPz7fMgZvAAADaElEQVR4nO3dO2gTAQDG8e8ujz6k6FBbUeOjKILV4CAiDgWxLqK4KM4dCuLiIIg6OQgibi5OgjgoDhZB7NIiIr6gCFFThIotaSsVtSJtadI87hykiKSNd/Uu9yX3/cZwyV3yv0fukYth27YNoWEGPQHyNwUhoyBkFISMgpBREDIKQkZByCgImajTAa88XMDTDyU/p8VXjTHg0vEGHNgeCXpSKnK8hNRyDADIFYCXI/zvwfESsujInig6N/i7prv+OO/puO6/LmB82kYtHLRzHSSZMNG9y/XTXFkMsjth4rAH4xpIFzE+XQs5tFGnoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMvwelVujU/iiGJy3s3cp9qNwPlEF6D8aDnoTAaJVFRkHIKAgZBSGjIGQUhIyCkFEQMgpCRkHIKAgZymNZfvkxZ+NtpsqXkxrAtnYTqxoMR4OHKsjQaAlDo9W/vndzq4FbvU2Ohg3FKqtzY7CH8TPfnV/GGoolpKcrhp6uWNXHO5Au4tqjvKvnhGIJqSUKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByFAGsSwgm6+N35V7jTLIubs5nLyRxdg3K+hJqTrKIOlJC7kCMDKlIBQW7yRsUk6dv0L4lrkpCBkFIeP6FO67CQslq1j2+I71Jra0qu//ch2kP1VEf6r88XgU6DvbhMa4s8tdZGmezdJrWwxEwvcbTc+5XkIuHIv7fke5MNNKn4yCkFEQMgpCRkHIUH9dujmYx+1nhbLHkwkT5482wKjDXR7qIDNZYCZbfqLqyWwJZ7pttDTVXxHqIMvdanzdGqMuYwDkQby61Xgt0UadTLhmv2XM5Wxc7lvA1E9vL6xYyYUaCgLg4xcLqQzH+XsFAZDcFMHpQzHML3j7up++Wnjh8k9kFARAxARO7PP+N4gD6aLrINqokwlsCUllSrj3qoBihRmoxLFar6rAgjwYKuLNWOVPfHaJvfR6F1iQnq4Ytrcvvca88/z38avVzfW5N15JYEE62kx0tFUOUo8HD/9FG3UyCkJGQcgoCBnPLiX1w/sJC1aVxuWH4c/ud6QM27Ydfdnvvjrv+sXlj8GLzY6Gc7zK2unzHxLXs2TC+WfneAmR6tBsT0ZByCgIGQUhoyBkFISMgpBREDIKQuYX+jTA4JQOFzkAAAAASUVORK5CYII=",sl="/assets/template-Cjj8EPhc.png";function il({dialogRef:c,closeDialog:P,templates:Z,isOpen:v,isViewingArea:b,selectTemplate:C,duplicateTemplate:M}){const[L,R]=d.useState(/Mobi|Android/i.test(navigator.userAgent)),[S,k]=d.useState([]),[D,F]=d.useState(!1),[w,H]=d.useState([]);return d.useEffect(()=>{H(Z)},[Z]),d.useEffect(()=>{if(v&&(console.log("Layout dialog opened, generating cells and sections",w),w.length!==0)){if(w.length==1){k([w[0].name]);return}k(L?[w[0].name]:[w[0].name,w[1].name])}},[v,w]),d.useEffect(()=>{const V=w.filter(A=>S.includes(A.name));console.log("Viewing templates:",S),V.sort((A,x)=>S.indexOf(A.name)-S.indexOf(x.name)),console.log("Generating templates for",V.map(A=>A.name))},[S,w]),t.jsx(t.Fragment,{children:t.jsx("dialog",{ref:c,className:"template-dialog",children:t.jsxs("div",{className:"template-dialog-div",children:[t.jsx("h2",{children:"Templates"}),t.jsxs("div",{className:"templates",children:[w.length>1&&w.filter(V=>!S.includes(V.name)).length>0&&t.jsx("img",{src:rt,onClick:()=>{if(L){const A=(w.findIndex(x=>x.name===S[0])-1+w.length)%w.length;k([w[A].name])}else k(V=>{const x=(w.findIndex(B=>B.name===V[0])-1+w.length)%w.length;return[w[x].name,V[0]]})},className:"back-mobile-areas"}),S.length===0&&t.jsx("div",{className:"no-templates",children:"No templates available"}),S.map(V=>t.jsxs("div",{className:"template",children:[t.jsx("img",{src:w.find(A=>A.name===V).previewImage,alt:V,className:"template-preview"}),t.jsx("h3",{children:V}),t.jsxs("div",{className:"template-actions",children:[t.jsx("button",{className:"template-select-btn",onClick:()=>{if(b){const A=new URLSearchParams(window.location.search),x=A.get("companyId"),B=A.get("areaId");window.location.href=`/Layout/?companyId=${x}&areaId=${B}&type=edit-template&templateId=${w.find(le=>le.name==V).id}`}else P(),C&&C(w.find(A=>A.name===V))},children:b?"Edit":"Select"}),b&&t.jsx("button",{className:"action-btn",onClick:()=>{D||(F(!0),M&&M(w.find(A=>A.name===V)))},children:"Duplicate"}),b&&t.jsx("button",{className:"action-btn",onClick:()=>{if(D)return;F(!0);const A=w.filter(E=>E.name!==V);H(A),A.length==1?k([A[0].name]):A.length==0?k([]):k(L?[A[0].name]:[A[0].name,A[1].name]);const x=new URLSearchParams(window.location.search),B=x.get("companyId"),le=x.get("areaId");qe(B,le,A).then(()=>{F(!1)})},children:"Delete"})]})]})),w.length>1&&w.filter(V=>!S.includes(V.name)).length>0&&t.jsx("img",{src:rt,onClick:()=>{if(L){const A=(w.findIndex(x=>x.name===S[0])+1)%w.length;k([w[A].name])}else k(V=>{const x=(w.findIndex(B=>B.name===V[V.length-1])+1)%w.length;return[V[1],w[x].name]})},className:"forward-mobile-areas"})]}),b&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"action-btn",onClick:()=>{const V=new URLSearchParams(window.location.search),A=V.get("companyId"),x=V.get("areaId");window.location.href=`/Layout/?companyId=${A}&areaId=${x}&type=create-template`},children:"Create new Template"})," ",t.jsx("br",{})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:P,children:"Close"}),D&&v&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})})})}function al({dialogRef:c,closeDialog:P,addInventoryItem:Z,canBeBooth:v}){const[b,C]=d.useState(""),[M,L]=d.useState(1),[R,S]=d.useState(1),[k,D]=d.useState(1),[F,w]=d.useState(!1);return t.jsx("dialog",{ref:c,className:"custom-item-dialog",children:t.jsxs("div",{className:"custom-item-dialog-div",children:[t.jsx("h2",{children:"Add Custom Item"}),t.jsxs("div",{className:"custom-item-row",children:[t.jsx("label",{htmlFor:"item-name",children:"Name:"}),t.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:H=>C(H.target.value??""),value:b})]}),t.jsxs("div",{className:"custom-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:M,onChange:H=>L(parseInt(H.target.value)??1)})]}),t.jsxs("div",{className:"custom-item-row custom-item-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:R,onChange:H=>S(parseFloat(H.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:k,onChange:H=>D(parseFloat(H.target.value)??1)})]}),v?t.jsxs("div",{className:"custom-item-row",children:[t.jsx("label",{htmlFor:"is-booth",children:"Is Booth:"}),t.jsx("input",{type:"checkbox",id:"is-booth",name:"is-booth",checked:F,onChange:H=>w(H.target.checked)})]}):null,t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(b.trim()===""){alert("Item name cannot be empty");return}const H=new ue({quantity:M,item:new I({id:b+(Math.random()*1e4).toString(),name:b,icon:`custom-${b}`,cellsLong:Math.ceil(R),cellsTall:Math.ceil(k),moveable:!0,starterItem:!1,displayItem:!0,isBooth:F})});Z(H),C(""),L(1),S(1),D(1),w(!1),P()},children:"Add Item"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{P(),C(""),L(1),S(1),D(1),w(!1)},children:"Close"})]})})}function cl({dialogRef:c,closeDialog:P,addSection:Z}){const[v,b]=d.useState(""),[C,M]=d.useState(1),[L,R]=d.useState(1);return t.jsx("dialog",{ref:c,className:"section-dialog",children:t.jsxs("div",{className:"section-dialog-div",children:[t.jsx("h2",{children:"Add Section"}),t.jsxs("div",{className:"section-row",children:[t.jsx("label",{htmlFor:"section-name",children:"Name:"}),t.jsx("input",{type:"text",id:"section-name",name:"section-name",onChange:S=>b(S.target.value??""),value:v})]}),t.jsxs("div",{className:"section-row section-size",children:[t.jsx("label",{htmlFor:"section-width",children:"Size (in feet):"}),t.jsx("input",{type:"number",id:"section-width",name:"section-width",min:"1",value:C,onChange:S=>M(parseFloat(S.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"section-height",name:"section-height",min:"1",value:L,onChange:S=>R(parseFloat(S.target.value)??1)})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(v.trim()===""){alert("Section name cannot be empty");return}const S=new ue({quantity:1,item:new I({id:v+(Math.random()*1e4).toString(),name:v,icon:`custom-${v}`,cellsLong:Math.ceil(C),cellsTall:Math.ceil(L),moveable:!0,starterItem:!1,displayItem:!0,isSectionItem:!0})});Z(S),b(""),M(1),R(1),P()},children:"Add Section"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:P,children:"Close"})]})})}function rl({dialogRef:c,closeDialog:P,addInventoryItem:Z}){const[v,b]=d.useState(null),[C,M]=d.useState(""),[L,R]=d.useState(1),[S,k]=d.useState(1),[D,F]=d.useState(1),[w,H]=d.useState(!0),[V,A]=d.useState([]);return d.useEffect(()=>{Zn(localStorage.getItem("companyId")||"").then(x=>{A(x)})},[]),t.jsx("dialog",{ref:c,className:"inventory-item-dialog",children:t.jsxs("div",{className:"inventory-item-dialog-div",children:[t.jsx("h2",{children:"Add Inventory Item"}),v==null?t.jsxs(t.Fragment,{children:["  ",t.jsx("label",{htmlFor:"",children:"Premade Items:"}),t.jsx("div",{className:"inventory-item-list",children:V.map(x=>t.jsx(Kn,{item:x,onSelect:()=>{const B=new ue({quantity:1,item:new I({id:x.name+(Math.random()*1e4).toString(),name:x.name,icon:x.icon,cellsLong:x.cellsLong,cellsTall:x.cellsTall,moveable:!0,starterItem:!1,displayItem:!0})});b(B)}},x.id))}),t.jsx("label",{htmlFor:"",children:"Or:"}),t.jsx("label",{htmlFor:"",children:"Custom Item:"}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-name",children:"Name:"}),t.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:x=>M(x.target.value??""),value:C})]}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:L,onChange:x=>R(parseInt(x.target.value)??1)})]}),t.jsxs("div",{className:"inventory-item-row inventory-item-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:S,onChange:x=>k(parseFloat(x.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:D,onChange:x=>F(parseFloat(x.target.value)??1)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),t.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:w,onChange:x=>H(x.target.checked)})]}),t.jsx("br",{})]}):t.jsxs(t.Fragment,{children:[t.jsxs("label",{htmlFor:"",children:["Item: ",v.item.name]}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:L,onChange:x=>R(parseInt(x.target.value)??1)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),t.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:w,onChange:x=>H(x.target.checked)})]})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(C.trim()===""&&v==null){alert("Item name cannot be empty");return}if(L<=0){alert("Item count must be greater than zero");return}let x=v;x==null?x=new ue({quantity:L,item:new I({id:C+(Math.random()*1e4).toString(),name:C,icon:`inventory-${C}`,cellsLong:Math.ceil(S),cellsTall:Math.ceil(D),moveable:w,starterItem:!1,displayItem:!0})}):(x.quantity=L,x.item.moveable=w),Z(x),H(!0),b(null),M(""),R(1),k(1),F(1),P()},children:"Add Item"}),t.jsx("button",{className:"action-btn",onClick:()=>{H(!0),b(null),M(""),R(1),k(1),F(1),P()},children:"Close"})]})})}function dl({item:c,setSelectingItem:P,addHighlightedCell:Z,canPlaceItem:v,placeItem:b,highlightCells:C,unHighlightCells:M,cellSize:L,placeMultiItem:R}){const[S,k]=d.useState(0),[D,F]=d.useState(0),w=d.useRef(null),[H,V]=d.useState(0),[A,x]=d.useState(0),[B,le]=d.useState(!1),[E,J]=d.useState(0),[$,Ne]=d.useState(null),[Mt,he]=d.useState(!0),[Te,$e]=d.useState(12),[Me,Ke]=d.useState(null),_e=d.useRef(null),[Ze,Et]=d.useState(!0),[Je,K]=d.useState(!1),[re,j]=d.useState(!1),ce=d.useCallback(N=>{const y=N%2===1;return{width:y?c.cellsTall*L:c.cellsLong*L,height:y?c.cellsLong*L:c.cellsTall*L,cellsWide:y?c.cellsTall:c.cellsLong,cellsTall:y?c.cellsLong:c.cellsTall}},[c,L]);function dt(N){const y=w.current,oe=window.getComputedStyle(y),G=document.createElement("span");G.style.font=oe.font,G.style.fontSize=N+"px",G.style.fontFamily=oe.fontFamily,G.style.fontWeight=oe.fontWeight,G.style.position="absolute",G.style.visibility="hidden",G.style.whiteSpace="nowrap",G.textContent=y.textContent,document.body.appendChild(G);const de=G.offsetWidth;return document.body.removeChild(G),de}function Ye(N){if(w.current){const y=w.current;return dt(N-1)>y.offsetWidth&&N-1>8?Ye(N-1):N-1}return N}const ve=()=>{K(!0)},Pe=()=>{K(!1)};d.useEffect(()=>(setTimeout(()=>{w.current&&$e(Ye(Te))},100),window.addEventListener("mousedown",ve),window.addEventListener("mouseup",Pe),()=>{window.removeEventListener("mousedown",ve),window.removeEventListener("mouseup",Pe)}),[]),d.useEffect(()=>{if(c){le(!0);const N=_e.current?.getBoundingClientRect();Ke({x:N?N.left-S:0,y:N?N.top-D:0})}else console.log("No item to place, stopping dragging"),le(!1),Ke(null),k(0),F(0),V(0),x(0),J(0),Ne(null),he(!0),$e(12),Et(!0)},[c]);const Le=N=>{N.preventDefault()},Ae=d.useCallback((N,y,oe)=>{if(c==null||!B||!Me)return;console.log("PLACING MOVE",c);const G=oe.target,de=ce(E),Q=I.fromDoc(c.toDoc());Q.cellsLong=de.cellsWide,Q.cellsTall=de.cellsTall,Q.initialElement=c.initialElement,Q.rotation=E,Q.hasMoved=c.hasMoved,Q.id=c.id;let ye=G;if(!ye||!ye.classList?.contains("cell")){const pe=document.elementFromPoint(N,y);pe?.classList?.contains("cell")&&(ye=pe)}ye?.classList?.contains("cell")&&!re?C(f.fromString(ye.id),Q):ye?.classList?.contains("section-modifier")&&!re?C(f.fromString(ye.dataset.cell),Q):re||M(),k(N-Me.x),F(y-Me.y+(c.sectionModifierType?.includes("Door")?10:5)),Je&&(re||M(),j(!0),Z(f.fromString(ye.id)))},[c,B,S,D,re,Je,Me,v,b,ce,E,C,M,_e]),Ie=d.useCallback(N=>{if(c==null)return;const y=N.clientX,oe=N.clientY;console.log("Drag ended"),M(),document.body.removeEventListener("touchmove",Le);const G=document.elementFromPoint(y,oe);if(!G?.classList?.contains("cell")&&!G?.classList?.contains("section-modifier")){const de=ce(E),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};re?(j(!1),R(Q)):P()}else if(G?.classList?.contains("section-modifier")){if(console.log("Placing item on section modifier cell"),console.log("Target element:",G.dataset.cell),G.dataset.cell=="")return;const de=ce(E),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};if(re)j(!1),R(Q);else{if(!v(f.fromString(G.dataset.cell),Q))return;b(f.fromString(G.dataset.cell),Q,$!=null?f.fromString($.id):null)}console.log("Placed item at cell:",G)}else{const de=ce(E),Q={...c,cellsLong:de.cellsWide,cellsTall:de.cellsTall};if(re)j(!1),R(Q);else{if(!v(f.fromString(G.id),Q))return;b(f.fromString(G.id),Q,$!=null?f.fromString($.id):null)}console.log("Placed item at cell:",G)}},[c,E,P,re,v,b,$,M,H,A]),Ue=d.useCallback(N=>{const y=N.clientX,oe=N.clientY;Ae(y,oe,N)},[Ae]),He=d.useCallback(N=>{const y=N.touches[0],oe=y.clientX,G=y.clientY;Ae(oe,G,N)},[Ae]),U=d.useCallback(N=>{const y=N.changedTouches[0],oe=y.clientX,G=y.clientY;Ie({clientX:oe,clientY:G}),document.body.removeEventListener("touchmove",Le)},[Ie,Le]);return d.useEffect(()=>{if(B)return document.body.addEventListener("touchmove",Le,{passive:!1}),document.addEventListener("mousemove",Ue),document.addEventListener("mouseup",Ie),document.addEventListener("touchmove",He),document.addEventListener("touchend",U),()=>{document.body.removeEventListener("touchmove",Le),document.removeEventListener("mousemove",Ue),document.removeEventListener("mouseup",Ie),document.removeEventListener("touchmove",He),document.removeEventListener("touchend",U)}},[B,Ue,Ie,He,U,Le]),S==0||D==0||!Ze||c==null?t.jsx(t.Fragment,{}):t.jsx(t.Fragment,{children:t.jsx("div",{id:c.id,ref:_e,className:`draggable-item ${c.isSectionModifier&&!c.moveable?"placed-modifier":""} ${c.isSectionModifier?c.sectionModifierType?.toString():""} ${B?"dragging":""} ${c.moveable?"":"not-moveable"}`,style:{top:`${D}px`,left:`${S}px`,width:`${c.cellsLong*(c.isDisplayItem&&!B&&!c.hasMoved?10:L)-(c.sectionModifierType=="LeftWall"||c.sectionModifierType=="RightWall"||c.sectionModifierType?.includes("Corner")?1:0)}px`,height:`${c.cellsTall*(c.isDisplayItem&&!B&&!c.hasMoved?10:L)-(c.sectionModifierType=="TopWall"||c.sectionModifierType=="BottomWall"||c.sectionModifierType?.includes("Corner")?1:0)}px`,rotate:`${E*90}deg`,transformOrigin:"center center",fontSize:`${Te}px`,zIndex:B?1e3:1},children:c.isSectionModifier?null:c.icon.includes("custom-")?t.jsx("div",{className:c.isSectionItem?"custom-section":"custom-icon",children:t.jsx("div",{children:t.jsx("p",{ref:w,children:c.icon.split("custom-")[1]})})}):t.jsx("img",{src:c.icon,alt:"icon"})})})}function ml({vendor:c,onDelete:P,onEdit:Z,boothMap:v}){return t.jsxs("div",{className:"vendor-display-tile",children:[t.jsxs("div",{className:"vendor-info",children:[t.jsx("h3",{className:"vendor-business-name",children:c.businessName}),t.jsxs("p",{className:"vendor-plot-size",children:[c.plotWidth,"ft x ",c.plotHeight,"ft"]})]}),t.jsxs("div",{className:"vendor-actions",children:[t.jsx("img",{src:_n,alt:"Share",className:"vendor-link",onClick:async b=>{b.stopPropagation();const C=localStorage.getItem("companyId"),M=window.location.origin+`/Layout/?companyId=${C}&areaId=${v.areaId}&type=pick-booth&boothMapId=${v.id}&boothMapName=${v.name}&vendorId=${c.id}`;await navigator.clipboard.writeText(M),alert("BoothMap link copied to clipboard!")}}),t.jsx("img",{src:zt,alt:"Edit",className:"vendor-edit",onClick:b=>{b.stopPropagation(),Z(c.id)}}),t.jsx("img",{src:el,alt:"Delete",className:"vendor-delete",onClick:b=>{b.stopPropagation(),window.confirm("Are you sure you want to delete this vendor?")&&P(c.id)}})]})]})}function gl({maxHeight:c,vendors:P,onAddVendor:Z,boothMap:v,onDeleteVendor:b,onEditVendor:C}){return t.jsxs("div",{className:"vendors-tile",style:{maxHeight:c?`${c}px`:"200px"},children:[t.jsx("h2",{children:"Vendors"}),t.jsx("div",{className:"vendors-divider"}),t.jsxs("div",{className:"vendors-tile-content",children:[P.map(M=>t.jsx(ml,{vendor:M,boothMap:v,onDelete:L=>{b(L)},onEdit:L=>{C(M)}},M.id)),t.jsx("div",{className:"add-vendor",onClick:Z,children:t.jsx("img",{src:qt,alt:"Add vendor"})})]})]})}function ul({dialogRef:c,closeDialog:P,addVendor:Z}){const[v,b]=d.useState(""),[C,M]=d.useState(1),[L,R]=d.useState(1),[S,k]=d.useState(!1);return t.jsxs("dialog",{ref:c,className:"add-vendor-dialog",children:[t.jsxs("div",{className:"add-vendor-dialog-div",children:[t.jsx("h2",{children:"Add Vendor"}),t.jsxs("div",{className:"add-vendor-row",children:[t.jsx("label",{htmlFor:"business-name",children:"Business Name:"}),t.jsx("input",{type:"text",id:"business-name",name:"business-name",onChange:D=>b(D.target.value??""),value:v})]}),t.jsxs("div",{className:"add-vendor-row add-vendor-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Booth Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:C,onChange:D=>M(parseFloat(D.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:L,onChange:D=>R(parseFloat(D.target.value)??1)})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:async()=>{if(v.trim()===""){alert("Business name cannot be empty");return}const D=new Qt({id:v+(Math.random()*1e4).toString(),businessName:v,plotWidth:Math.ceil(C),plotHeight:Math.ceil(L)});k(!0),await Z(D),b(""),M(1),R(1),k(!1),P()},children:"Add Vendor"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{P(),b(""),M(1),R(1)},children:"Close"})]}),S&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})}function fl({dialogRef:c,closeDialog:P,editVendor:Z,oldVendor:v}){const[b,C]=d.useState(""),[M,L]=d.useState(1),[R,S]=d.useState(1),[k,D]=d.useState(!1);return d.useEffect(()=>{v&&(C(v.businessName),L(v.plotWidth),S(v.plotHeight))},[v]),t.jsxs("dialog",{ref:c,className:"edit-vendor-dialog",children:[t.jsxs("div",{className:"edit-vendor-dialog-div",children:[t.jsx("h2",{children:"Edit Vendor"}),t.jsxs("div",{className:"edit-vendor-row",children:[t.jsx("label",{htmlFor:"business-name",children:"Business Name:"}),t.jsx("input",{type:"text",id:"business-name",name:"business-name",onChange:F=>C(F.target.value??""),value:b})]}),t.jsxs("div",{className:"edit-vendor-row edit-vendor-size",children:[t.jsx("label",{htmlFor:"item-width",children:"Booth Size (in feet):"}),t.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:M,onChange:F=>L(parseFloat(F.target.value)??1)}),t.jsx("span",{children:" x "}),t.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:R,onChange:F=>S(parseFloat(F.target.value)??1)})]}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:async()=>{if(b.trim()===""){alert("Business name cannot be empty");return}const F=new Qt({id:v.id,businessName:b,plotWidth:Math.ceil(M),plotHeight:Math.ceil(R)});D(!0),await Z(F),C(""),L(1),S(1),D(!1),P()},children:"Save Vendor"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{P(),C(v.businessName),L(v.plotWidth),S(v.plotHeight)},children:"Close"})]}),k&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})}function hl({maxHeight:c}){return t.jsxs("div",{className:"key-tile",children:[t.jsx("h2",{children:"Key"}),t.jsx("div",{className:"key-divider"}),t.jsxs("div",{className:"key-tile-content",children:[t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"cell cell-border"}),t.jsx("p",{children:"1ft x 1ft"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"container",children:t.jsx("div",{className:"wall"})}),t.jsx("p",{children:"Wall"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"window-container",children:t.jsx("div",{className:"window"})}),t.jsx("p",{children:"Window"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"container",children:t.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fright_door.png?alt=media&token=8c6f3b4d-5e7a-4b9c-8d2f-0a3b5e6f7c8d",alt:"",className:"door"})}),t.jsx("p",{children:"Door"})]}),t.jsxs("div",{className:"key-item",children:[t.jsx("div",{className:"window-container",children:t.jsx("div",{className:"section-divider"})}),t.jsx("p",{children:"Section Divider"})]})]})]})}function pl({dialogRef:c,closeDialog:P,vendors:Z,addVendorToBooth:v}){const[b,C]=d.useState(!1),[M,L]=d.useState(null);return t.jsxs("dialog",{ref:c,className:"add-vendor-dialog",children:[t.jsxs("div",{className:"add-vendor-dialog-div",children:[t.jsx("h2",{children:"Select Vendor"}),t.jsxs("div",{className:"add-vendor-row",children:[t.jsx("label",{htmlFor:"boothMap-area",children:"Vendor:"}),t.jsxs("select",{id:"boothMap-area",name:"boothMap-area",onChange:R=>{const S=R.target.value,k=Z.find(D=>D.id===S)||null;L(k)},value:M?.id||"",children:[t.jsx("option",{value:"",children:"Select a Vendor"}),Z.map(R=>t.jsx("option",{value:R.id,children:R.businessName},R.id))]})]}),t.jsx("button",{className:"action-btn",onClick:()=>{if(!M){alert("Please select a vendor");return}C(!0),v(M)},children:"Select"}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{P(),L(null)},children:"Close"})]}),b&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader"})})]})}function Il({dialogRef:c,closeDialog:P,editInventoryItem:Z,selectedItem:v,deleteInventoryItem:b}){const[C,M]=d.useState(1),[L,R]=d.useState(!0);return d.useEffect(()=>{v&&(M(v.quantity),R(v.item.moveable))},[v]),t.jsx("dialog",{ref:c,className:"inventory-item-dialog",children:t.jsxs("div",{className:"inventory-item-dialog-div",children:[t.jsx("h2",{children:"Edit Inventory Item"}),t.jsxs("label",{htmlFor:"",children:["Item: ",v?.item.name]}),t.jsxs("div",{className:"inventory-item-row",children:[t.jsx("label",{htmlFor:"item-icon",children:"Count:"}),t.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:C,onChange:S=>M(parseInt(S.target.value)??1)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"item-moveable",children:"Moveable:"}),t.jsx("input",{type:"checkbox",id:"item-moveable",name:"item-moveable",checked:L,onChange:S=>R(S.target.checked)})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{className:"action-btn",onClick:()=>{if(C<=0){alert("Item count must be greater than zero");return}if(v){const S=v;S.quantity=C,S.item.moveable=L,Z(S),R(!0),P()}},children:"Save"}),t.jsx("button",{className:"action-btn",onClick:()=>{b(v),P()},children:"Delete"}),t.jsx("button",{className:"action-btn",onClick:()=>{P()},children:"Close"})]})})}On.createRoot(document.getElementById("root")).render(t.jsx(yl,{}));function yl(){const[c,P]=d.useState(/Mobi|Android/i.test(navigator.userAgent)),[Z,v]=d.useState(0),[b,C]=d.useState(0),[M,L]=d.useState(0),[R,S]=d.useState(0),[k,D]=d.useState([]),[F,w]=d.useState([]),[H,V]=d.useState(0),[A,x]=d.useState(null),[B,le]=d.useState([]),E=/Mobi|Android/i.test(navigator.userAgent)?5:10,[J,$]=d.useState([]),[Ne,Mt]=d.useState(!1),[he,Te]=d.useState(null),[$e,Me]=d.useState(null),[Ke,_e]=d.useState([new I({id:"left-wall",name:"Left Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftWall"}),new I({id:"right-wall",name:"Right Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightWall"}),new I({id:"top-wall",name:"Top Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"TopWall"}),new I({id:"bottom-wall",name:"Bottom Wall",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"BottomWall"}),new I({id:"left-door",name:"Left Door",cellsLong:1,cellsTall:1,icon:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fleft_door.png?alt=media&token=91fde31c-ebc6-4807-9670-f846c8d75cb6",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftDoor"}),new I({id:"right-door",name:"Right Door",cellsLong:1,cellsTall:1,icon:"https://firebasestorage.googleapis.com/v0/b/kazoom-layitout.firebasestorage.app/o/public%2Fright_door.png?alt=media&token=8c6f3b4d-5e7a-4b9c-8d2f-0a3b5e6f7c8d",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightDoor"}),new I({id:"left-window",name:"Left Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"LeftWindow"}),new I({id:"right-window",name:"Right Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"RightWindow"}),new I({id:"top-window",name:"Top Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"TopWindow"}),new I({id:"bottom-window",name:"Bottom Window",cellsLong:1,cellsTall:1,icon:"",moveable:!0,starterItem:!1,displayItem:!0,isSectionModifier:!0,sectionModifierType:"BottomWindow"})]),Ze=d.useRef(null),[Et,Je]=d.useState(!1),[K,re]=d.useState([]),[j,ce]=d.useState([]),[dt,Ye]=d.useState([]),[ve,Pe]=d.useState([]),[Le,Ae]=d.useState(!1),Ie=d.useRef(null),[Ue,He]=d.useState([]),[U,N]=d.useState([]),[y,oe]=d.useState(null),[G,de]=d.useState(!1),[Q,ye]=d.useState(!1),[pe,$t]=d.useState(!1),[Xe,Kt]=d.useState(!1),[te,_t]=d.useState(!1),[_,mt]=d.useState("placing-sections"),[wl,en]=d.useState(!1),[et,tn]=d.useState(!1),[be,nn]=d.useState(!1),[tt,ln]=d.useState(!1),[Qe,on]=d.useState(!1),[Be,sn]=d.useState(!1),[We,Ct]=d.useState(!1),[Oe,ze]=d.useState(""),[nt,an]=d.useState(null),[Fe,Rt]=d.useState(""),[Y,cn]=d.useState(""),[rn,dn]=d.useState(null),[z,mn]=d.useState(""),[lt,gn]=d.useState(null),[ot,st]=d.useState(""),[kt,it]=d.useState(""),[se,Ee]=d.useState(null),[gt,X]=d.useState(!0),[Dt,un]=d.useState(null),[ut,fe]=d.useState(!1),[fn,hn]=d.useState(null),[ft,ht]=d.useState([]),[pn,Ce]=d.useState(!1),[Se,In]=d.useState(null),[pt,yn]=d.useState(!1),[wn,xn]=d.useState(null),[It,vn]=d.useState(null),[Pt,Bt]=d.useState(null),[Re,Wt]=d.useState(!1),[bn,Sn]=d.useState(null),yt=d.useRef(null),wt=d.useRef(null),xt=d.useRef(null),vt=d.useRef(null),bt=d.useRef(null),St=d.useRef(null),jt=d.useRef(null);function we(n,e){for(const s of e)if(n.x>=s.cellId.x&&n.x<s.cellId.x+s.cellsLong&&n.y>=s.cellId.y&&n.y<s.cellId.y+s.cellsTall)return s;return null}function jn(n,e,s,a){re([...n.map(o=>new O({name:o.name,cellId:new f({x:o.cellId.x,y:o.cellId.y}),cellsLong:o.cellsLong,cellsTall:o.cellsTall,modifierItems:o.modifierItems.map(l=>new q({cell:new f({x:l.cell.x,y:l.cell.y}),item:new I({...l.item,starterItem:!0})})),startingItems:[]}))]);let i=Z,r=b;if(c){for(const u of n)console.log("Generating cells for section",u.name,"at",u.cellId,"with size",u.cellsLong,"x",u.cellsTall),console.log("Needed section Width:",(u.cellsLong+u.cellId.x)*E,"Current width:",i),(u.cellsLong+u.cellId.x)*E>i&&(console.log("Added section Width:",u.cellsLong*E+u.cellId.x),i+=(u.cellsLong+u.cellId.x)*E-i),console.log("Needed section Height:",(u.cellsTall+u.cellId.y)*E,"Current height:",r),(u.cellsTall+u.cellId.y)*E>r&&(console.log("Added section Height:",u.cellsTall*E+u.cellId.y),r+=(u.cellsTall+u.cellId.y)*E-r);S(r/E*2),L(i/E*2);let o=0;const l=[],g=[];for(const u of n){const h=[],T={width:u.cellsLong*E,height:u.cellsTall*E,sectionName:u.name};T.height>o&&(o=T.height),He(W=>[...W,T]),u.cellId.x=0,u.cellId.y=0,[...Array(T.height/E).keys()].map(W=>{const me=[];[...Array(T.width/E).keys()].map(ie=>{me.push({id:new f({x:ie,y:W}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:!0,size:E})}),h.push(me)}),l.push({sectionName:u.name,cells:[...h]}),g.push(u)}N(l),ce(g),V(o),oe(n[0]?n[0].name:null),setTimeout(()=>{X(!1)},500)}else{const o=[];for(const l of n)console.log("Generating cells for section",l.name,"at",l.cellId,"with size",l.cellsLong,"x",l.cellsTall),console.log("Needed section Width:",l.cellsLong+l.cellId.x,"Current width:",i),l.cellsLong+l.cellId.x>i&&(console.log("Added section Width:",l.cellsLong+l.cellId.x),i+=l.cellsLong+l.cellId.x-i),console.log("Needed section Height:",l.cellsTall+l.cellId.y,"Current height:",r),l.cellsTall+l.cellId.y>r&&(console.log("Added section Height:",l.cellsTall+l.cellId.y),r+=l.cellsTall+l.cellId.y-r);v(e.width),C(e.height),L(e.width),S(e.height),console.log("Final width:",i,"Final height:",r),[...Array(e.height).keys()].map(l=>{const g=[];[...Array(e.width).keys()].map(u=>{console.log("Creating cell at",u,l,"with size",E,s),g.push({id:new f({x:u,y:l}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:s&&a=="placing-sections"?!0:we(new f({x:u,y:l}),n)!=null,size:E})}),o.push(g)}),D([...o]),setTimeout(()=>{const l=[],g=[...n],u=[];for(const h of g)h.cellElement=document.querySelector(`.App #${h.cellId.toId()}.cell:not(.cell-border)`),l.push(...h.startingItems.map(T=>new q({cell:new f({x:h.cellId.x+T.cell.x,y:h.cellId.y+T.cell.y}),item:new I({...T.item,initialElement:document.querySelector(`.App #${T.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,hasMoved:!0})}))),l.push(...h.modifierItems.map(T=>new q({cell:new f({x:h.cellId.x+T.cell.x,y:h.cellId.y+T.cell.y}),item:new I({...T.item,initialElement:document.querySelector(`.App #${T.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1})}))),u.push(...h.booths.map(T=>new je({...T,cell:new f({x:h.cellId.x+T.cell.x,y:h.cellId.y+T.cell.y}),initialElement:document.querySelector(`.App #${T.cell.toId()}.cell:not(.cell-border)`)})));ce([...g]);for(const h of l){const T=ie=>{const ge=ie%2===1;return{cellsLong:ge?h.item.cellsTall:h.item.cellsLong,cellsTall:ge?h.item.cellsLong:h.item.cellsTall}},W=h.item.rotation||0,me=T(W);for(let ie=0;ie<me.cellsTall;ie++)for(let ge=0;ge<me.cellsLong;ge++)o[h.cell.y+ie][h.cell.x+ge].hasItem=!0,o[h.cell.y+ie][h.cell.x+ge].itemId=h.item.id;h.item.initialElement=document.querySelector(`.App #${h.cell.toId()}.cell:not(.cell-border)`),w(ie=>[...ie,h.item])}for(const h of u){for(let T=0;T<h.cellsTall;T++)for(let W=0;W<h.cellsLong;W++)o[h.cell.y+T][h.cell.x+W].hasItem=!0,o[h.cell.y+T][h.cell.x+W].itemId=h.id;h.initialElement=document.querySelector(`.App #${h.cell.toId()}.cell:not(.cell-border)`),Ye(T=>[...T,h])}D([...o]),setTimeout(()=>{X(!1)},500)},100)}}async function Tn(){const n=new URLSearchParams(window.location.search),e=n.get("companyId"),s=n.get("areaId"),a=n.get("areaId")||"",i=n.get("companyId")||"",r=n.get("templateId")||"",o=await Un(i,a);if(o===null){window.location.href="/DNF/";return}gn(o),hn(o.previewImage||null);const l=n.get("type")||"";let g=!1,u=!1,h="modify-sections",T=!1,W=null;if(l==="public-preview"){Ct(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="create-template")de(!0);else if(l==="edit-area")tn(!0);else if(l==="edit-template"){ye(!0);const m=o.templates.find(p=>p.id===r);m&&(un(m),Rt(m.name))}else if(l==="view-design"){g=!0,$t(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="view-area")Kt(!0);else if(l==="edit-design"){g=!0,en(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="client-edit-design"){g=!0,sn(!0);const m=n.get("designName")||"";ze(m);const p=n.get("designId")||"";st(p)}else if(l==="create-area"){u=!0,_t(!0);const m=n.get("stage");m==="placing-sections"?(h="placing-sections",mt("placing-sections")):m==="modify-sections"?(mt("modify-sections"),h="modify-sections",$(Ke.map(p=>new ue({item:new I({...p,displayItem:!0}),quantity:-1})))):m==="placing-items"&&(mt("placing-items"),h="placing-items",$(o.inventoryItems.map(p=>new ue({item:new I({...p.item,displayItem:!0}),quantity:p.quantity}))))}else if(l==="view-boothMap"){T=!0,nn(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Ee(p),W=p}else if(l==="pick-booth"){T=!0,on(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Ee(p),W=p;const ae=n.get("vendorId")||"";if(ae!==""){const ne=p.vendors.find(ee=>ee.id===ae);if(ne){In(ne),console.log("Vendor found",ne);let ee=!1;W.sections.forEach(Bn=>{Bn.booths.forEach(Wn=>{Wn.user?.id===ne.id&&(ee=!0)})}),yn(ee);const Ht=await Hn(i);if(Ht===null){window.location.href="/DNF/";return}dn(Ht)}else{window.location.href="/DNF/";return}}}else if(l==="create-boothMap"){T=!0,ln(!0);const m=n.get("boothMapId")||"";it(m);const p=await ct(i,a,m);if(p===null){window.location.href="/DNF/";return}Ee(p),W=p}else if(l==="public-preview-boothMap"){T=!0,Ct(!0);const m=n.get("boothMapId")||"";it(m);const p=n.get("designName")||"";ze(p);const ae=await ct(i,a,m);if(ae===null){window.location.href="/DNF/";return}Ee(ae),W=ae}e&&cn(e),s&&mn(s),u||$(o.inventoryItems.map(m=>new ue({item:new I({...m.item,displayItem:!0}),quantity:m.quantity})));const me=[],ie=[];for(const m of o.templates){const p=[],ae=[];for(const ne of m.sections)p.push(new O({name:ne.name,cellId:new f({x:ne.cellId.x,y:ne.cellId.y}),cellsLong:ne.cellsLong,cellsTall:ne.cellsTall,modifierItems:ne.modifierItems.map(ee=>new q({cell:new f({x:ee.cell.x,y:ee.cell.y}),item:new I({...ee.item,starterItem:!0})})),startingItems:ne.startingItems.map(ee=>new q({cell:new f({x:ee.cell.x,y:ee.cell.y}),item:new I({...ee.item,starterItem:!0})}))})),ae.push(new O({name:ne.name,cellId:new f({x:ne.cellId.x,y:ne.cellId.y}),cellsLong:ne.cellsLong,cellsTall:ne.cellsTall,modifierItems:ne.modifierItems.map(ee=>new q({cell:new f({x:ee.cell.x,y:ee.cell.y}),item:new I({...ee.item,starterItem:!0})})),startingItems:ne.startingItems.map(ee=>new q({cell:new f({x:ee.cell.x,y:ee.cell.y}),item:new I({...ee.item,starterItem:!0})}))}));me.push(new xe({name:m.name,sections:p,inventoryItems:m.inventoryItems,id:m.id,previewImage:m.previewImage})),ie.push(new xe({name:m.name,sections:ae,id:m.id,previewImage:m.previewImage,inventoryItems:m.inventoryItems}))}Pe([...me]);const ge=[],Ve=r===""?void 0:ie.find(m=>m.id===r);if(console.log("TEMPLATE",Ve,"AREA",o),T&&W)$(W.inventoryItems.map(m=>new ue({item:new I({...m.item,displayItem:!0}),quantity:m.quantity}))),re([...W.sections]),ce([...W.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,booths:m.booths,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ge.push(...W.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,booths:m.booths,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))})));else if(g){const m=await Xn(i,a,n.get("designId")||"");if(m===null){window.location.href="/DNF/";return}Wt(m.submitted),Bt(m.dateSubmitted?new Date(m.dateSubmitted):null),an(m),$(m.inventoryItems.map(p=>new ue({item:new I({...p.item,displayItem:!0}),quantity:p.quantity}))),re([...m.sections]),ce([...m.sections.map(p=>new O({name:p.name,cellId:new f({x:p.cellId.x,y:p.cellId.y}),cellsLong:p.cellsLong,cellsTall:p.cellsTall,startingItems:p.startingItems,modifierItems:p.modifierItems,items:p.startingItems.map(ae=>new I({...ae.item,sectionCell:new f({x:ae.cell.x,y:ae.cell.y})}))}))]),ge.push(...m.sections.map(p=>new O({name:p.name,cellId:new f({x:p.cellId.x,y:p.cellId.y}),cellsLong:p.cellsLong,cellsTall:p.cellsTall,startingItems:p.startingItems,modifierItems:p.modifierItems,items:p.startingItems.map(ae=>new I({...ae.item,sectionCell:new f({x:ae.cell.x,y:ae.cell.y})}))})))}else Ve!==void 0?($(Ve.inventoryItems.map(m=>new ue({item:new I({...m.item,displayItem:!0}),quantity:m.quantity}))),re([...Ve.sections]),ce([...Ve.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ge.push(...Ve.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,modifierItems:m.modifierItems,startingItems:m.startingItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))})))):(re([...o.sections]),ce([...o.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,modifierItems:m.modifierItems,startingItems:m.startingItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))]),ge.push(...o.sections.map(m=>new O({name:m.name,cellId:new f({x:m.cellId.x,y:m.cellId.y}),cellsLong:m.cellsLong,cellsTall:m.cellsTall,startingItems:m.startingItems,modifierItems:m.modifierItems,items:m.startingItems.map(p=>new I({...p.item,sectionCell:new f({x:p.cell.x,y:p.cell.y})}))}))));console.log("SECTIONS TO GENERATE",ge),jn(ge,o,l==="create-area",h)}d.useEffect(()=>{Tn()},[]);function Ln(n,e,s){if(!c||n==null)return;const a=[...s],i=[],r=[],o=s.find(l=>l.name==n);console.log("NEW SECTION",o),console.log("Adding section",o.name,o.cellId),console.log("MOBILE CELLS",e),o.cellElement=document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${o.cellId.toId()}.cell:not(.cell-border)`),console.log("Section element found",o.cellElement);for(const l of o.startingItems){console.log("Placing starting item",l.item.name,l.cell);const g=T=>{const W=T%2===1;return{cellsLong:W?l.item.cellsTall:l.item.cellsLong,cellsTall:W?l.item.cellsLong:l.item.cellsTall}},u=l.item.rotation||0,h=g(u);for(let T=0;T<h.cellsTall;T++)for(let W=0;W<h.cellsLong;W++){const me=e.find(ie=>ie.sectionName===o.name);me.cells[l.cell.y+T][l.cell.x+W].hasItem=!0,me.cells[l.cell.y+T][l.cell.x+W].itemId=l.item.id}l.item.initialElement=document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),console.log("Adding item to items",l.item.initialElement),i.push(new I({...l.item,hasMoved:!0}))}for(const l of o.modifierItems){console.log("Placing starting item",l.item.name,l.cell);const g=T=>{const W=T%2===1;return{cellsLong:W?l.item.cellsTall:l.item.cellsLong,cellsTall:W?l.item.cellsLong:l.item.cellsTall}},u=l.item.rotation||0,h=g(u);for(let T=0;T<h.cellsTall;T++)for(let W=0;W<h.cellsLong;W++){const me=e.find(ie=>ie.sectionName===o.name);me.cells[l.cell.y+T][l.cell.x+W].hasItem=!0,me.cells[l.cell.y+T][l.cell.x+W].itemId=l.item.id}console.log("Adding item to items",document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`)),i.push(new I({...l.item,initialElement:document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1}))}console.log("Setting sections",a),ce([...a]),console.log("ITEMS",i),w(l=>[...l.filter(u=>!i.some(h=>h.id===u.id)),...i.map(u=>new I({...u,starterItem:!0}))]),r.push(...o.booths.map(l=>new je({...l,initialElement:document.querySelector(`.App #${o.name.split(" ").join("-")} #${o.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`)})));for(const l of r){for(let g=0;g<l.cellsTall;g++)for(let u=0;u<l.cellsLong;u++){const h=e.find(T=>T.sectionName===o.name);h.cells[l.cell.y+g][l.cell.x+u].hasItem=!0,h.cells[l.cell.y+g][l.cell.x+u].itemId=l.id}Ye(g=>[...g,l])}}function Ot(n){let e=[];return n.map(s=>e=[...e,...s]),e}function An(n,e){let s=!1;return e.sections.forEach(a=>{a.booths.forEach(i=>{i.user?.id===n.id&&(s=!0)})}),s}function Tt(n,e){console.log(n);const s=c?U.find(o=>o.sectionName===y).cells:k,a=s[n.y].length,i=s.length;if(console.log(a,i),n.x+e.cellsLong>a||n.y+e.cellsTall>i)return!1;const r=we(n,j);if(!r&&!c&&(_!=="placing-sections"||!te))return console.log("Item is out of bounds of any section"),!1;for(let o=0;o<e.cellsTall;o++)for(let l=0;l<e.cellsLong;l++){if(!c){const g=we(new f({x:n.x+l,y:n.y+o}),j);if(!g&&(_!=="placing-sections"||!te))return console.log("Item is out of bounds of any section"),!1;if(g?.name!=r?.name&&(_!=="placing-sections"||!te))return console.log("Item is crossing section boundaries"),!1}if(s[n.y+o][n.x+l].hasItem&&s[n.y+o][n.x+l].itemId!=e.id){console.log("Something is already here");const g=F.find(u=>u.id==s[n.y+o][n.x+l].itemId);if(g&&g.isSectionModifier){if(g.sectionModifierType==="LeftDoor"||g.sectionModifierType==="RightDoor")return console.log("Item is on door of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),!1;if(g.sectionModifierType==="RightWall"){if(console.log("Item is on left wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),l==e.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="LeftWall"){if(console.log("Item is on right wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopWall"){if(console.log("Item is on bottom wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomWall"){if(console.log("Item is on top wall of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==e.cellsTall-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopRightCornerWall"){if(console.log("Item is on bottom left corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==0&&l==e.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopLeftCornerWall"){if(console.log("Item is on bottom right corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==0&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomRightCornerWall"){if(console.log("Item is on top left corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==e.cellsTall-1&&l==e.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomLeftCornerWall"){if(console.log("Item is on top right corner of section modifier, can place item",o,l,e.cellsTall,e.cellsLong),o==e.cellsTall-1&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}}else return!1}}return!0}function Ft(n,e,s){console.log(e),console.log("CELLS",n);const a=n[e.y].length,i=n.length;if(console.log(a,i),e.x+s.cellsLong>a||e.y+s.cellsTall>i)return!1;const r=we(e,j);if(!r&&!c&&(_!=="placing-sections"||!te))return console.log("Item is out of bounds of any section"),!1;for(let o=0;o<s.cellsTall;o++)for(let l=0;l<s.cellsLong;l++){if(!c){const g=we(new f({x:e.x+l,y:e.y+o}),j);if(!g&&(_!=="placing-sections"||!te))return console.log("Item is out of bounds of any section"),!1;if(g?.name!=r?.name&&(_!=="placing-sections"||!te))return console.log("Item is crossing section boundaries"),!1}if(n[e.y+o][e.x+l].hasItem&&n[e.y+o][e.x+l].itemId!=s.id){console.log("Something is already here");const g=F.find(u=>u.id==n[e.y+o][e.x+l].itemId);if(g&&g.isSectionModifier){if(g.sectionModifierType==="LeftDoor"||g.sectionModifierType==="RightDoor")return console.log("Item is on door of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),!1;if(g.sectionModifierType==="RightWall"){if(console.log("Item is on left wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="LeftWall"){if(console.log("Item is on right wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopWall"){if(console.log("Item is on bottom wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomWall"){if(console.log("Item is on top wall of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopRightCornerWall"){if(console.log("Item is on bottom left corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0&&l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="TopLeftCornerWall"){if(console.log("Item is on bottom right corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==0&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomRightCornerWall"){if(console.log("Item is on top left corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1&&l==s.cellsLong-1)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}else if(g.sectionModifierType==="BottomLeftCornerWall"){if(console.log("Item is on top right corner of section modifier, can place item",o,l,s.cellsTall,s.cellsLong),o==s.cellsTall-1&&l==0)continue;return console.log("Item is not on edge of section modifier, cannot place item"),!1}}else return!1}console.log("Finished checking placement. Current Item ID:",s.id,"Over: ",n[e.y+o][e.x+l])}return!0}function Gt(n,e,s){const a=Array.from(c?U.find(o=>o.sectionName===y).cells:k);if(Ce(!0),s!=null){console.log("Removing item",e.id,"from cell",s.toId());const o=c?j.find(l=>l.name===y):we(s,j);o.items=o.items.filter(l=>l.id!=e.id);for(let l=0;l<e.cellsTall;l++)for(let g=0;g<e.cellsLong;g++)a[s.y+l][s.x+g].hasItem=!1,a[s.y+l][s.x+g].itemId=""}const i=e.name+Math.floor(Math.random()*1e5).toString();if(_!=="placing-sections"||!te){const o=c?j.find(g=>g.name===y):we(n,j),l=new f({x:n.x-o.cellId.x,y:n.y-o.cellId.y});e.sectionCell=l,console.log("Adding item to section",o.name,"at",l,e),o.items.push(Ne?new I({...e,id:i}):e)}else e.sectionCell=new f({x:n.x,y:n.y});for(let o=0;o<e.cellsTall;o++)for(let l=0;l<e.cellsLong;l++)a[n.y+o][n.x+l].hasItem=!0,a[n.y+o][n.x+l].itemId=e.id;if(console.log(a),c){const o=U.find(l=>l.sectionName===y);o&&(o.cells=a.map(l=>l.map(g=>({...g}))),N([...U]))}else D(a);console.log("Removing item from inventory",e.name,e.hasMoved,e.starterItem);let r=!1;if(!e.hasMoved){console.log("INVENTORY ITEMs",J);const o=J.findIndex(l=>l.item.name==e.name&&!l.item.hasMoved);if(o!==-1){const l=[...J];console.log("Found item in inventory",l[o]),l[o].quantity>0&&(l[o].quantity-=1,l[o].quantity<=0&&(r=!0,l.splice(o,1)),$(l))}else $(J)}if(w(o=>(console.log("Placing item",e),console.log("Updating item",e.id),Ne&&he&&e.id==he.id?(console.log("Updating placing item",e.id),e.hasMoved=!0,e.starterItem=!0,e.isDisplayItem=!1,e.initialElement=document.querySelector(`.App #${n.toId()}.cell:not(.cell-border)`),console.log("New item id",i),[...o,new I({...e,hasMoved:!0,id:i})]):(o.find(l=>l.id==e.id).hasMoved||(o.find(l=>l.id==e.id).hasMoved=!0,o.find(l=>l.id==e.id).sectionCell=e.sectionCell),o))),Ne&&he&&r){Te(null);return}}function Nn(n){F.find(e=>e.name==n.name&&!e.hasMoved&&!e.starterItem)||w(e=>[...e,n])}d.useEffect(()=>{he?(console.log("Adding placing item",he.id),Me(he.id)):(console.log("Removing placing item",$e),Me(""))},[he]);function Vt(n){console.log("Removing item",n.id),w(e=>e.filter(s=>s.id!=n.id))}function Mn(n,e){const s=Array.from(c?U.find(o=>o.sectionName===y).cells:k);Ce(!0);const a=o=>{const l=o%2===1;return{cellsWide:l?n.cellsTall:n.cellsLong,cellsTall:l?n.cellsLong:n.cellsTall}},i=n.rotation||0,r=a(i);for(let o=0;o<r.cellsTall;o++)for(let l=0;l<r.cellsWide;l++)s[e.y+o][e.x+l].hasItem=!1,s[e.y+o][e.x+l].itemId="";if(c){const o=U.find(l=>l.sectionName===y);o&&(o.cells=s.map(l=>l.map(g=>({...g}))),N([...U])),N(l=>l.map(g=>g.sectionName===y?{...g,cells:s}:g))}else D(s);if(_!=="placing-sections"||!te){const o=c?j.find(l=>l.name===y):we(e,j);o.items=o.items.filter(l=>l.id!=n.id),console.log("DELETING ITEM section",n.id),console.log("SECTION ITEMS AFTER DELETE",o.items)}w(o=>(console.log("Removing item new",n.id),console.log("ITEMS AFTER REMOVE",o.filter(l=>l.id!=n.id)),o.filter(l=>l.id!=n.id))),$(o=>{const l=o.findIndex(g=>g.item.name==n.name&&!g.item.hasMoved);if(l!==-1){const g=[...o];return g[l].quantity>0&&(g[l].quantity+=1),g}else return[...o,new ue({item:new I({...n,hasMoved:!1}),quantity:1})]})}function En(n,e){const s=Array.from(c?U.find(g=>g.sectionName===y).cells:k);console.log("DELETING ITEM ROTATE",n.id,n.rotation),Ce(!0);const a=g=>{const u=g%2===1;return{cellsWide:u?n.cellsTall:n.cellsLong,cellsTall:u?n.cellsLong:n.cellsTall}},i=n.rotation||0,r=a(i);for(let g=0;g<r.cellsTall;g++)for(let u=0;u<r.cellsWide;u++)console.log("Deleting cell",e.y+g,e.x+u),s[e.y+g][e.x+u].hasItem=!1,s[e.y+g][e.x+u].itemId="";if(c){const g=U.find(u=>u.sectionName===y);g&&(g.cells=s.map(u=>u.map(h=>({...h}))),N([...U])),N(u=>u.map(h=>h.sectionName===y?{...h,cells:s}:h))}else D(s);console.log("DELETING ITEM",n.id);const o=c?j.find(g=>g.name===y):we(e,j);o.items=o.items.filter(g=>g.id!=n.id);const l=new f({x:e.x-o.cellId.x,y:e.y-o.cellId.y});n.sectionCell=l,o.items.push(n)}function Zt(n,e){const s=c?U.find(r=>r.sectionName===y).cells:k,a=Array.from(s);if(s[n.y]==null){console.log("Start cell is out of bounds",n),at();return}const i=Tt(n,e);a.forEach(r=>r.forEach(o=>{o.mouseOver=!1,o.canPlaceItem=!1,o.mouseOverLocation=""}));for(let r=0;r<e.cellsTall;r++)for(let o=0;o<e.cellsLong;o++)n.y+r<a.length&&n.x+o<a[n.y+r].length&&(e.cellsLong===1&&e.cellsTall===1?a[n.y+r][n.x+o].mouseOverLocation="single":e.cellsTall===1?o===0?a[n.y+r][n.x+o].mouseOverLocation="leftFull":o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="rightFull":a[n.y+r][n.x+o].mouseOverLocation="middleFull":e.cellsLong===1?r===0?a[n.y+r][n.x+o].mouseOverLocation="topFull":r===e.cellsTall-1?a[n.y+r][n.x+o].mouseOverLocation="bottomFull":a[n.y+r][n.x+o].mouseOverLocation="middleVFull":r===0&&o===0?a[n.y+r][n.x+o].mouseOverLocation="topLeftCorner":r===0&&o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="topRightCorner":r===e.cellsTall-1&&o===0?a[n.y+r][n.x+o].mouseOverLocation="bottomLeftCorner":r===e.cellsTall-1&&o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="bottomRightCorner":r===0?a[n.y+r][n.x+o].mouseOverLocation="top":r===e.cellsTall-1?a[n.y+r][n.x+o].mouseOverLocation="bottom":o===0?a[n.y+r][n.x+o].mouseOverLocation="left":o===e.cellsLong-1?a[n.y+r][n.x+o].mouseOverLocation="right":a[n.y+r][n.x+o].mouseOverLocation="middle",a[n.y+r][n.x+o].mouseOver=!0,a[n.y+r][n.x+o].canPlaceItem=i);if(c){const r=U.find(o=>o.sectionName===y);r&&(r.cells=a.map(o=>o.map(l=>({...l}))),N([...U])),N(o=>o.map(l=>l.sectionName===y?{...l,cells:a}:l))}else D(a)}function at(){console.log("Unhighlighting cells");const n=Array.from(c?U.find(e=>e.sectionName===y).cells:k);if(n.forEach(e=>e.forEach(s=>{s.mouseOver=!1,s.canPlaceItem=!1,s.mouseOverLocation=""})),c){const e=U.find(s=>s.sectionName===y);e&&(e.cells=n.map(s=>s.map(a=>({...a}))),N([...U])),N(s=>s.map(a=>a.sectionName===y?{...a,cells:n}:a))}else D(n)}d.useEffect(()=>{Ln(y,U,j)},[y]),d.useEffect(()=>{const n=()=>{const e=F.find(s=>s.id===A);console.log("Unselecting item",A),x(null),e&&(le(s=>[...s,e.id]),console.log("Unselecting item",e.id),setTimeout(()=>{le(s=>s.filter(a=>a!==e.id))},300))};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[A,F]);function Jt(n){x(null),le(e=>[...e,n]),console.log("Unselecting item",n),setTimeout(()=>{le(e=>e.filter(s=>s!==n))},300)}function Yt(n){const e=F.find(s=>s.id===A);console.log("Unselecting item",A),x(n),e&&(le(s=>[...s,e.id]),console.log("Unselecting item",e.id),setTimeout(()=>{le(s=>s.filter(a=>a!==e.id))},300))}function Lt(n){$(e=>[...e,n])}const Ge=n=>{console.log("Preventing scroll"),n.preventDefault(),n.stopPropagation(),window.scrollTo(0,0)};d.useEffect(()=>(ut?(window.addEventListener("scroll",Ge),window.addEventListener("touchmove",Ge,{passive:!1})):(window.removeEventListener("scroll",Ge),window.removeEventListener("touchmove",Ge)),()=>{window.removeEventListener("scroll",Ge),window.removeEventListener("touchmove",Ge)}),[ut]);async function Cn(n){const e=[];X(!0);for(const i of n){const r=i.name,o=new f({x:i.sectionCell.x,y:i.sectionCell.y}),l=new O({name:r,cellId:o,cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:[],startingItems:[],items:[]});e.push(l)}let s=0,a=0;for(const i of e)console.log("Generating cells for section",i.name,"at",i.cellId,"with size",i.cellsLong,"x",i.cellsTall),console.log("Needed section Width:",i.cellsLong+i.cellId.x,"Current width:",s),i.cellsLong+i.cellId.x>s&&(console.log("Added section Width:",i.cellsLong+i.cellId.x),s+=i.cellsLong+i.cellId.x-s),console.log("Needed section Height:",i.cellsTall+i.cellId.y,"Current height:",a),i.cellsTall+i.cellId.y>a&&(console.log("Added section Height:",i.cellsTall+i.cellId.y),a+=i.cellsTall+i.cellId.y-a);await Qn(Y,z,e,s,a),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=create-area&stage=modify-sections`}async function Rn(n,e){const s=[];X(!0);for(const a of e){const i=a.name,r=new f({x:a.cellId.x,y:a.cellId.y});console.log("Saving section modifier items for section",i,a.items.map(l=>l.name),"at cell",r);const o=new O({name:i,cellId:r,cellsLong:a.cellsLong,cellsTall:a.cellsTall,startingItems:[],items:[],modifierItems:a.items.map(l=>new q({cell:new f({x:l.sectionCell.x,y:l.sectionCell.y}),item:new I({...l,isSectionModifier:!0})}))});s.push(o)}console.log("Saving section modifier items",s),await zn(Y,z,s),console.log("Section modifier items saved successfully"),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=create-area&stage=placing-items`}async function Ut(n,e){X(!0);const s=[];for(const a of n){const i=a.name,r=new f({x:a.cellId.x,y:a.cellId.y}),o=new O({name:i,cellId:r,cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(l=>new q({cell:new f({x:l.sectionCell.x,y:l.sectionCell.y}),item:new I({...l,starterItem:!0})})),items:[]});s.push(o)}console.log("Saving area sections",s),localStorage.setItem("screenshotSections",s.map(a=>JSON.stringify(a.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",s.map(a=>JSON.stringify(a.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async a=>{if(console.log("Storage event",a),a.key==="screenshot"){const i=new qn({id:z,name:lt.name,sections:s,templates:lt?.templates||[],previewImage:a.newValue,width:lt.width,height:lt.height,inventoryItems:e.map(r=>new ue({item:new I({...r.item,starterItem:!0}),quantity:r.quantity}))});await $n(Y,i),console.log("Area saved successfully"),X(!1),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=view-area`}})}function kn(n){const e=Array.from(c?U.find(s=>s.sectionName===y).cells:k);if(e[n.y]!=null)if(e[n.y][n.x].mouseOver=!0,e[n.y][n.x].canPlaceItem=!0,e[n.y][n.x].mouseOverLocation="single",ht(s=>[...s,n]),c){const s=U.find(a=>a.sectionName===y);s&&(s.cells=e.map(a=>a.map(i=>({...i}))),N([...U])),N(a=>a.map(i=>i.sectionName===y?{...i,cells:e}:i))}else console.log("Adding highlighted cell",n.toId()),D(e)}function Dn(n){const e=Array.from(c?U.find(o=>o.sectionName===y).cells:k);Ce(!0);const s=[];ft.forEach(o=>{s.some(l=>l.toId()===o.toId())||s.push(o)}),ht([]);const a=[],i=J.findIndex(o=>o.item.name==n.name&&!o.item.hasMoved);let r=i!==-1?J[i].quantity:0;s.forEach(o=>{const l=new I({...n});if(l.id=l.name+Math.floor(Math.random()*1e5).toString(),console.log("Placing item",l.name,"at",o.toId(),"CAN PLACE?",Ft(e,o,l)),Ft(e,o,l)&&r!=0){if(i!==-1&&(r-=1),_!=="placing-sections"||!te){const u=c?j.find(T=>T.name===y):we(o,j);console.log("Adding item to section",u.name,"at",u.cellId,"with cell",o.toId(),o.x-u.cellId.x,o.y-u.cellId.y);const h=new f({x:o.x-u.cellId.x,y:o.y-u.cellId.y});l.sectionCell=h,console.log("Adding item to section",u.name,"at",h,l),u.items.push(l),console.log("SECTION ITEMS",u.items.map(T=>T.name))}else l.sectionCell=new f({x:o.x,y:o.y});for(let u=0;u<n.cellsTall;u++)for(let h=0;h<n.cellsLong;h++)e[o.y+u][o.x+h].hasItem=!0,e[o.y+u][o.x+h].itemId=l.id;l.hasMoved=!0,l.starterItem=!0,l.isDisplayItem=!1,l.initialElement=document.querySelector(`.App #${o.toId()}.cell:not(.cell-border)`);const g=new I({...l});a.push(g)}});for(const o of a)console.log("Adding item to items",o.id),w(l=>[...l,o]);if(i!==-1&&$(o=>{const l=[...o];return l[i].quantity>0&&(l[i].quantity=r,l[i].quantity==0&&l.splice(i,1)),l}),r==0&&Te(null),c){const o=U.find(l=>l.sectionName===y);o&&(o.cells=e.map(l=>l.map(g=>({...g}))),N([...U])),N(l=>l.map(g=>g.sectionName===y?{...g,cells:e}:g))}else D(e);ce(j)}function Pn(n,e,s){X(!0);const a=[];for(const i of n){const r=i.name,o=new f({x:i.cellId.x,y:i.cellId.y}),l=i.items.filter(h=>h.isBooth),g=i.items.filter(h=>!h.isBooth),u=new O({name:r,cellId:o,cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:g.map(h=>new q({cell:new f({x:h.sectionCell.x,y:h.sectionCell.y}),item:new I({...h,displayItem:!0})})),booths:l.map(h=>new je({id:h.name+Math.floor(Math.random()*1e5).toString(),name:h.name,cell:new f({x:h.sectionCell.x,y:h.sectionCell.y}),cellsLong:h.cellsLong,cellsTall:h.cellsTall,user:h.boothUser})),items:[]});a.push(u)}console.log("Saving area sections",a),localStorage.setItem("screenshotSections",a.map(i=>JSON.stringify(i.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",a.map(i=>JSON.stringify(i.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async i=>{if(console.log("Storage event",i),i.key==="screenshot"){const r=new ke({id:s.id,name:s.name,sections:a,areaId:z,previewImage:i.newValue,inventoryItems:e.map(o=>new ue({item:new I({...o.item,starterItem:!0}),quantity:o.quantity}))});await De(Y,r),console.log("Booth Map saved successfully"),X(!1),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=view-boothMap&boothMapId=${kt}`}})}return d.useEffect(()=>{const n=e=>{e.key==="Escape"&&(console.log("Escape key pressed"),ft.length>0?(console.log("There are highlighted cells"),ht([]),at()):Te(null))};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[ft]),console.log("RENDERING APP",!(te&&_!="placing-items")),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"App",children:[t.jsx("h1",{className:"title",children:"LayItOut"}),t.jsx("br",{}),Qe&&t.jsxs("div",{className:"area-creation",children:[pt?t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"area-creation-title",children:"You have already picked a booth"}),t.jsxs("label",{htmlFor:"",children:["Contact ",rn?.supportEmail," to change booths"]})]}):t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"area-creation-title",children:"Picking Booth"}),t.jsx("label",{htmlFor:"",children:"Tap on an open booth then click on the checkmark to pick a booth"})," "]}),t.jsxs("label",{htmlFor:"",children:["Booth Size: ",Se?.plotWidth,"ft x ",Se?.plotHeight,"ft"]}),t.jsx("br",{})]}),tt&&t.jsxs("div",{className:"area-creation",children:[t.jsx("h2",{className:"area-creation-title",children:"Create Booth Map"}),t.jsx("label",{htmlFor:"",children:"Create a booth map by placing items and then creating and placing booths, same way you create and place items"})]}),te&&t.jsxs("div",{className:"area-creation",children:[t.jsx("h2",{className:"area-creation-title",children:"Create Area"}),t.jsx("label",{htmlFor:"",children:_=="placing-sections"?"Create new sections and place them":_=="modify-sections"?"Add walls and doors to sections":"Add items to the inventory and place items"})]}),(G||Q)&&t.jsxs("div",{className:"template-name-row",children:[t.jsx("label",{htmlFor:"template-name",children:"Template Name:"}),t.jsx("input",{type:"text",id:"template-name",name:"template-name",onChange:n=>Rt(n.target.value),value:Fe})]}),(pe||We)&&t.jsxs("div",{className:"design-name-row",children:[t.jsxs("label",{htmlFor:"design-name",children:["Design Name: ",Oe]}),pe&&Re&&t.jsxs("p",{children:["Design was submitted on ",Pt?.toLocaleDateString()]})]}),(G||Q)&&t.jsxs("div",{className:"template-creation",children:[t.jsxs("button",{className:"action-btn",onClick:()=>{if(Fe.trim()==""){alert("Please enter a template name");return}if(ve.some(n=>n.name===Fe&&(Q?n.id!==Dt.id:!0))){alert("Template with this name already exists");return}Q?(X(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new q({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){fe(!1);const s=ve.map(a=>a.id===Dt.id?(console.log("SECTION",j),new xe({name:Fe,inventoryItems:J,previewImage:e.newValue,sections:j.map(i=>new O({name:i.name,cellId:new f({x:a.sections.find(r=>r.name==i.name).cellId.x,y:a.sections.find(r=>r.name==i.name).cellId.y}),cellsLong:i.cellsLong,modifierItems:i.modifierItems,cellsTall:i.cellsTall,startingItems:i.items.map(r=>new q({cell:new f({x:r.sectionCell.x,y:r.sectionCell.y}),item:new I({...r,starterItem:!0})}))})),id:a.id})):new xe({name:a.name,previewImage:a.previewImage,inventoryItems:a.inventoryItems,sections:a.sections.map(i=>new O({name:i.name,cellId:new f({x:i.cellId.x,y:i.cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(r=>new q({cell:new f({x:r.cell.x,y:r.cell.y}),item:new I({...r.item})}))})),id:a.id}));qe(Y,z,s).then(()=>{console.log("Template updated successfully"),X(!1);const a=new URLSearchParams(window.location.search),i=a.get("companyId"),r=a.get("areaId");window.location.href=`/Layout/?companyId=${i}&areaId=${r}&type=view-area`})}})},500)):(X(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new q({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){fe(!1);const s=new xe({name:Fe,previewImage:e.newValue,inventoryItems:J,sections:j.map(i=>new O({name:i.name,cellId:new f({x:K.find(r=>r.name==i.name).cellId.x,y:K.find(r=>r.name==i.name).cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.items.map(r=>new q({cell:new f({x:r.sectionCell.x,y:r.sectionCell.y}),item:new I({...r,starterItem:!0})}))})),id:Fe+(Math.random()*1e4).toString()}),a=[...ve.map(i=>new xe({name:i.name,previewImage:i.previewImage,inventoryItems:i.inventoryItems,sections:i.sections.map(r=>new O({name:r.name,cellId:new f({x:r.cellId.x,y:r.cellId.y}),cellsLong:r.cellsLong,cellsTall:r.cellsTall,modifierItems:r.modifierItems,startingItems:r.startingItems.map(o=>new q({cell:new f({x:o.cell.x,y:o.cell.y}),item:new I({...o.item})}))})),id:i.id})),s];qe(Y,z,a).then(()=>{console.log("Template updated successfully"),X(!1);const i=new URLSearchParams(window.location.search),r=i.get("companyId"),o=i.get("areaId");window.location.href=`/Layout/?companyId=${r}&areaId=${o}&type=view-area`})}})},500))},children:[G?"Create":"Save"," Template"]}),t.jsx("button",{className:"action-btn",onClick:()=>{const n=new URLSearchParams(window.location.search),e=n.get("companyId"),s=n.get("areaId");window.location.href=`/Layout/?companyId=${e}&areaId=${s}&type=view-area`},children:"Cancel"})]}),Be&&!Re&&t.jsxs("div",{className:"template-creation",children:[pn&&t.jsx("button",{className:"action-btn",onClick:()=>{X(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new q({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){fe(!1);const s=new At({name:Oe,previewImage:e.newValue,submitted:!1,dateSubmitted:null,areaId:z,inventoryItems:J,sections:j.map(a=>new O({name:a.name,cellId:new f({x:K.find(i=>i.name==a.name).cellId.x,y:K.find(i=>i.name==a.name).cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(i=>new q({cell:new f({x:i.sectionCell.x,y:i.sectionCell.y}),item:new I({...i,starterItem:!0})}))})),id:ot});Nt(Y,z,s).then(()=>{console.log("Design updated successfully"),Ce(!1),X(!1)})}})},500)},children:"Save"}),t.jsx("button",{className:"action-btn",onClick:()=>{X(!0),setTimeout(async()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,startingItems:e.items.map(s=>new q({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("screenshotSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async e=>{if(console.log("Storage event",e),e.key==="screenshot"){fe(!1);const s=new At({name:Oe,previewImage:e.newValue,submitted:!0,dateSubmitted:new Date,areaId:z,inventoryItems:J,sections:j.map(a=>new O({name:a.name,cellId:new f({x:K.find(i=>i.name==a.name).cellId.x,y:K.find(i=>i.name==a.name).cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.items.map(i=>new q({cell:new f({x:i.sectionCell.x,y:i.sectionCell.y}),item:new I({...i,starterItem:!0})}))})),id:ot});Nt(Y,z,s).then(()=>{console.log("Design updated successfully"),Ce(!1),X(!1),Wt(!0),Bt(new Date)})}})},500)},children:"Submit"})]}),Be&&Re&&t.jsxs("div",{className:"area-creation",children:[t.jsxs("label",{htmlFor:"",children:["Design was submitted on ",Pt?.toLocaleDateString()]}),t.jsx("br",{})]}),!pe&&!Xe&&!be&&!Qe&&!We&&!(Re&&Be)&&t.jsxs("div",{className:"place-mode-row",children:[t.jsx("label",{htmlFor:"tap-and-place-mode",children:"Place Mode: "}),t.jsxs("select",{id:"tap-and-place-mode",name:"tap-and-place-mode",value:Ne?"tap":"drag",onChange:n=>Mt(n.target.value==="tap"),className:"place-mode-select",children:[t.jsx("option",{value:"drag",children:"Drag and Drop"}),t.jsx("option",{value:"tap",children:"Tap and Place"})]})]}),gt&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"loader-backdrop",children:t.jsx("div",{className:"loader"})})})," ",t.jsxs("div",{className:"layout",children:[!pe&&!Xe&&!be&&!Qe&&!We&&!(Re&&Be)&&t.jsx(nl,{canEditItem:te&&_=="placing-items"||et,onEditItem:n=>{Sn(n),jt.current?.showModal()},setSelectedItem:Te,tapAndPlaceMode:Ne,isModifyingSections:te&&_=="modify-sections",isViewingDesign:pe,isEditingTemplate:Q,isCreatingTemplate:G,maxHeight:c?200:b*E,showAddCustomItem:()=>{_=="placing-sections"&&te?wt.current?.showModal():_=="placing-items"&&te||et?xt.current?.showModal():yt.current?.showModal()},addDraggingItem:Nn,removeItem:Vt,inventoryItems:J.map(n=>new ue({item:new I({...n.item,displayItem:!0}),quantity:n.quantity}))}),be&&se?t.jsx(gl,{onDeleteVendor:async n=>{X(!0);const e=new ke({...se,vendors:se.vendors.filter(s=>s.id!==n),sections:se.sections.map(s=>new O({...s,booths:s.booths.map(a=>a.user?.id===n?new je({...a,user:null,initialElement:a.initialElement??void 0}):a)}))});await De(Y,e),Ee(e),window.location.reload()},onEditVendor:n=>{xn(n),bt.current?.showModal()},boothMap:se,vendors:se?.vendors??[],maxHeight:c?void 0:b*E,onAddVendor:()=>{vt.current?.showModal()}}):null,c?t.jsxs("div",{className:"mobile-areas",style:{height:H+"px"},children:[j.length>1&&t.jsx("img",{src:rt,onClick:()=>{const n=j.findIndex(s=>s.name==y);if(n===-1)return;const e=(n-1+j.length)%j.length;oe(j[e].name),console.log("Changing viewing section to",j[e].name)},className:"back-mobile-areas"}),Ue.map((n,e)=>t.jsx(Xt,{width:n.width,height:n.height,cells:Ot(U.find(s=>s.sectionName==n.sectionName).cells),id:n.sectionName,visibile:y==null?!0:n.sectionName==y,section:n.sectionName},e)),j.length>1&&t.jsx("img",{src:rt,onClick:()=>{const n=j.findIndex(s=>s.name==y);if(n===-1)return;const e=(n+1)%j.length;oe(j[e].name),console.log("Changing viewing section to",j[e].name)},className:"forward-mobile-areas"})]}):t.jsx(Xt,{width:Z*E,height:b*E,cells:Ot(k)}),(_=="placing-items"||!te)&&t.jsx(hl,{maxHeight:c?void 0:b*E})]}),be&&t.jsx("div",{className:"design-view",children:t.jsx("button",{className:"action-btn",onClick:()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,booths:e.booths,startingItems:e.items.map(s=>new q({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("printSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),window.open(window.location.origin+`/Print/?companyId=${Y}&areaId=${z}&designName=${se?.name}`,"_blank")},children:"Print"})}),pe&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{const n=j.map(e=>new O({name:e.name,cellId:new f({x:K.find(s=>s.name==e.name).cellId.x,y:K.find(s=>s.name==e.name).cellId.y}),cellsLong:e.cellsLong,cellsTall:e.cellsTall,modifierItems:e.modifierItems,booths:e.booths,startingItems:e.items.map(s=>new q({cell:new f({x:s.sectionCell.x,y:s.sectionCell.y}),item:new I({...s,starterItem:!0})}))}));localStorage.setItem("printSections",n.map(e=>JSON.stringify(e.toJSON())).join("LAYOUTSEPARATOR")),window.open(window.location.origin+`/Print/?companyId=${Y}&areaId=${z}&designName=${Oe}&designId=${ot}`,"_blank")},children:"Print"}),t.jsx("button",{className:"action-btn",onClick:()=>{const n=new xe({name:Oe,previewImage:nt.previewImage,inventoryItems:nt.inventoryItems,sections:nt.sections,id:nt.name+(Math.random()*1e4).toString()}),e=[...ve.map(s=>new xe({name:s.name,previewImage:s.previewImage,inventoryItems:s.inventoryItems,sections:s.sections.map(a=>new O({name:a.name,cellId:new f({x:a.cellId.x,y:a.cellId.y}),cellsLong:a.cellsLong,cellsTall:a.cellsTall,modifierItems:a.modifierItems,startingItems:a.startingItems.map(i=>new q({cell:new f({x:i.cell.x,y:i.cell.y}),item:new I({...i.item})}))})),id:s.id})),n];qe(Y,z,e).then(()=>{console.log("Template updated successfully"),Pe(e),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=edit-template&templateId=${n.id}`})},children:"Turn into a Template"}),t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=desings"},children:"Back"})]}),be&&t.jsx("div",{className:"design-view",children:t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=boothmaps"},children:"Back"})}),Xe&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=edit-area`},children:"Edit Area"}),t.jsx("button",{className:"action-btn",onClick:()=>{window.location.href="/?view=areas"},children:"Back"})]}),et&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:async()=>{await Ut(j,J)},children:"Save Area"}),t.jsx("button",{className:"action-btn",onClick:async()=>{X(!0),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=view-area`},children:"Back"})]}),te&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{_=="placing-sections"?Cn(F.filter(n=>n.isSectionItem)):_=="modify-sections"?Rn(F.filter(n=>n.isSectionModifier),j):_=="placing-items"&&Ut(j,J)},children:_=="placing-items"?"Create Area":"Next"}),t.jsx("button",{className:"action-btn",onClick:async()=>{X(!0),await Jn(Y,z),window.location.href="/"},children:"Cancel"})]}),tt&&t.jsxs("div",{className:"design-view",children:[t.jsx("button",{className:"action-btn",onClick:()=>{console.log("Creating booth map with sections",j,"and inventory items",J,"and boothMap",se),Pn(j,J,se)},children:"Create Booth Map"}),t.jsx("button",{className:"action-btn",onClick:async()=>{X(!0),await Yn(Y,z,kt),window.location.href="/?view=boothmaps"},children:"Cancel"})]})]}),t.jsxs("div",{children:[j.map(n=>t.jsx(Fn,{takingPhoto:!1,section:n,visible:y==null?!0:n.name==y,cellSize:E},n.cellId.toId())),F.map(n=>t.jsx(Gn,{isPlacingItem:he!=null,isCreatingArea:te,isCreatingTemplate:G||Q,cellSize:E,isViewingDesign:pe||Xe||be||Qe||We||Re&&Be,removeItem:Vt,visible:c?!n.hasMoved&&!n.starterItem?!0:y==null?!1:n.isSectionModifier?j.find(e=>e.name==y)?.modifierItems.some(e=>e.item.id===n.id):n.starterItem?j.find(e=>e.name==y)?.startingItems.some(e=>e.item.id===n.id):j.find(e=>e.name==y)?.items.some(e=>e.id===n.id):!0,item:n,canPlaceItem:Tt,placeItem:Gt,deleteItemRotate:En,highlightCells:Zt,unHighlightCells:at,deleteItem:Mn,isSelected:A===n.id,onSelect:Yt,isUnselecting:B.includes(n.id),onDeselect:()=>Jt(n.id)},n.id)),dt.map(n=>(console.log("CAN PICK BOOTH",n.cellsLong==Se?.plotWidth&&n.cellsTall==Se.plotHeight,"BOOTH",n,"VENDOR",Se),t.jsx(Vn,{canPick:be||pt||n.cellsLong==Se?.plotWidth&&n.cellsTall==Se.plotHeight,visible:c?y==null?!1:j.find(e=>e.name==y)?.booths.some(e=>e.id===n.id)??!1:!0,booth:n,isViewingBooth:be,isPublicViewingBooth:We,hasPickedBooth:pt,isSelected:A==n.id,cellSize:E,onSelect:Yt,isUnselecting:B.includes(n.id),onDeselect:()=>Jt(n.id),onPickBooth:async e=>{X(!0);const s=j.map(i=>i.name===y?new O({...i,booths:i.booths.map(r=>r.id===e?new je({...r,user:Se,initialElement:r.initialElement??void 0}):r)}):i.booths.some(r=>r.id===e)?new O({...i,booths:i.booths.map(r=>r.id===e?new je({...r,user:Se,initialElement:r.initialElement??void 0}):r)}):i);console.log("Updated sections",s),ce(s);const a=new ke({...se,sections:s});await De(Y,a),window.location.reload(),X(!1)},onRemoveVendorFromBooth:()=>{X(!0);const e=j.map(a=>new O({...a,booths:a.booths.map(i=>i.user?.id===n.user?.id?new je({...i,user:null,initialElement:i.initialElement??void 0}):i)})),s=new ke({...se,sections:e});De(Y,s).then(()=>{window.location.reload()})},onAddVendorToBooth:()=>{vn(n),St.current?.showModal()}},n.id)))]}),c&&!gt&&t.jsx("div",{className:"layout-icon",onClick:()=>{Ze.current?.showModal(),Je(!0),console.log("Showing layout dialog")},children:t.jsx("img",{src:ol,alt:""})}),!gt&&!(G||et||Q||pe||tt||te||be||Qe||We||Re&&Be)&&t.jsx("div",{className:"template-icon",onClick:()=>{Ie.current?.showModal(),Ae(!0),console.log("Showing template dialog")},children:t.jsx("img",{src:sl,alt:""})}),t.jsx(il,{isViewingArea:Xe,dialogRef:Ie,isOpen:Le,closeDialog:()=>{Ie.current?.close(),Ae(!1)},duplicateTemplate:n=>{const e=new xe({name:n.name+" Copy",previewImage:n.previewImage,inventoryItems:n.inventoryItems,sections:n.sections,id:n.name+"Copy"+(Math.random()*1e4).toString()}),s=[...ve.map(a=>new xe({name:a.name,previewImage:a.previewImage,inventoryItems:a.inventoryItems,sections:a.sections.map(i=>new O({name:i.name,cellId:new f({x:i.cellId.x,y:i.cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(r=>new q({cell:new f({x:r.cell.x,y:r.cell.y}),item:new I({...r.item})}))})),id:a.id})),e];qe(Y,z,s).then(()=>{Ie.current?.close(),console.log("Template updated successfully"),Pe(s),Ae(!1),window.location.href=`/Layout/?companyId=${Y}&areaId=${z}&type=edit-template&templateId=${e.id}`})},templates:ve,selectTemplate:n=>{X(!0),setTimeout(async()=>{const e=n.sections.map(s=>new O({name:s.name,cellId:new f({x:n.sections.find(a=>a.name==s.name).cellId.x,y:n.sections.find(a=>a.name==s.name).cellId.y}),cellsLong:s.cellsLong,cellsTall:s.cellsTall,modifierItems:s.modifierItems,startingItems:s.startingItems.map(a=>new q({cell:new f({x:a.cell.x,y:a.cell.y}),item:new I({...a.item,starterItem:!0})}))}));localStorage.setItem("screenshotSections",e.map(s=>JSON.stringify(s.toJSON())).join("LAYOUTSEPARATOR")),console.log("Screenshot sections saved to localStorage",e.map(s=>JSON.stringify(s.toJSON())).join("LAYOUTSEPARATOR")),localStorage.setItem("screenshot",""),fe(!0),window.addEventListener("storage",async s=>{if(console.log("Storage event",s),s.key==="screenshot"){fe(!1);const a=new At({name:Oe,previewImage:s.newValue,areaId:z,submitted:!1,dateSubmitted:null,inventoryItems:n.inventoryItems,sections:n.sections.map(i=>new O({name:i.name,cellId:new f({x:n.sections.find(r=>r.name==i.name).cellId.x,y:n.sections.find(r=>r.name==i.name).cellId.y}),cellsLong:i.cellsLong,cellsTall:i.cellsTall,modifierItems:i.modifierItems,startingItems:i.startingItems.map(r=>new q({cell:new f({x:r.cell.x,y:r.cell.y}),item:new I({...r.item,starterItem:!0})}))})),id:ot});console.log("UPDATED DESIGN",a),Nt(Y,z,a).then(()=>{console.log("Design updated successfully"),Ce(!1),X(!1),window.location.reload()})}})},500)}}),t.jsx(ll,{dialogRef:Ze,closeDialog:()=>{Ze.current?.close(),Je(!1)},areaPreview:fn||""}),t.jsx(al,{canBeBooth:tt,dialogRef:yt,addInventoryItem:Lt,closeDialog:()=>{yt.current?.close()}}),t.jsx(cl,{dialogRef:wt,closeDialog:()=>{wt.current?.close()},addSection:Lt}),t.jsx(rl,{dialogRef:xt,closeDialog:()=>{xt.current?.close()},addInventoryItem:Lt}),t.jsx(dl,{placeMultiItem:Dn,addHighlightedCell:kn,item:he,setSelectingItem:()=>{Te(null)},canPlaceItem:Tt,placeItem:Gt,highlightCells:Zt,unHighlightCells:at,cellSize:E}),t.jsx(ul,{dialogRef:vt,closeDialog:()=>{vt.current?.close()},addVendor:async n=>{const e=new ke({...se,vendors:[...se.vendors,n]});Ee(e),await De(Y,e)}}),t.jsx(fl,{oldVendor:wn,dialogRef:bt,closeDialog:()=>{bt.current?.close()},editVendor:async n=>{const e=new ke({...se,vendors:se.vendors.map(s=>s.id===n.id?n:s)});Ee(e),await De(Y,e)}}),t.jsx(Il,{dialogRef:jt,closeDialog:()=>{jt.current?.close()},deleteInventoryItem:n=>{$(e=>e.filter(s=>s.item.id!==n.item.id))},editInventoryItem:n=>{$(e=>e.map(s=>s.item.id===n.item.id?n:s))},selectedItem:bn}),t.jsx(pl,{dialogRef:St,vendors:se?.vendors.filter(n=>!An(n,se))??[],closeDialog:()=>{St.current?.close()},addVendorToBooth:async n=>{X(!0);const e=j.map(a=>a.name===y?new O({...a,booths:a.booths.map(i=>i.id===It.id?new je({...i,user:n,initialElement:i.initialElement??void 0}):i)}):a.booths.some(i=>i.id===It.id)?new O({...a,booths:a.booths.map(i=>i.id===It.id?new je({...i,user:n,initialElement:i.initialElement??void 0}):i)}):a);console.log("Updated sections",e),ce(e);const s=new ke({...se,sections:e});await De(Y,s),window.location.reload(),X(!1)}}),ut&&t.jsx("iframe",{id:"screenshot-iframe",title:"Screenshot Iframe",src:window.location.origin+"/Preview/",width:M*E+20,height:R*E+20})]})}

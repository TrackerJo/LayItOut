import{c as Be,j as m,r}from"./index-QIV6qY6h.js";import{A as ge,S as Ve,D as ze}from"./section-B7tSJiIr.js";import{T as C,S as L,l as f,m as R,I as h,s as ue,D as Ce,n as Je,o as fe}from"./firestore-DkNIo3aX.js";import{T as Ye,F as Ie,L as Ge,a as Ke,b as Qe,c as Xe,A as Ze}from"./add_custom_item_dialog-C5K1_xfi.js";Be.createRoot(document.getElementById("root")).render(m.jsx(_e,{}));function _e(){const[i,el]=r.useState(!1),[ee,ye]=r.useState(0),[J,pe]=r.useState(0),[v,b]=r.useState([]),[P,E]=r.useState([]),[he,xe]=r.useState(0),[N,Y]=r.useState(null),[we,j]=r.useState([]),I=10,[W,H]=r.useState([]),G=r.useRef(null),[Te,le]=r.useState(!1),[M,K]=r.useState([]),[g,k]=r.useState([]),[B,Le]=r.useState([]),[Se,ne]=r.useState(!1),Q=r.useRef(null),[ve,te]=r.useState([]),[x,$]=r.useState([]),[u,V]=r.useState(null),[U,be]=r.useState(!1),[D,ll]=r.useState(!1),[O,nl]=r.useState(!1),[Ee,tl]=r.useState(!1),[ol,sl]=r.useState(!1),[Ne,al]=r.useState(!1),[X,cl]=r.useState(""),[A,je]=r.useState(""),[z,il]=r.useState(""),[F,ml]=r.useState(""),[oe,rl]=r.useState(""),[Z,T]=r.useState(!0),[se,dl]=r.useState(null),[ae,S]=r.useState(!1),_=r.useRef(null);function q(e,t){for(const c of t)if(e.x>=c.cellId.x&&e.x<c.cellId.x+c.cellsLong&&e.y>=c.cellId.y&&e.y<c.cellId.y+c.cellsTall)return c;return null}function De(e){K([...e.map(s=>new L({name:s.name,cellId:new f({x:s.cellId.x/2,y:s.cellId.y/2}),cellsLong:s.cellsLong/2,cellsTall:s.cellsTall/2,startingItems:[]}))]);let t=ee,c=J;if(i){let s=0;const o=[],n=[];for(const l of e){const a=[],d={width:l.cellsLong*I,height:l.cellsTall*I,sectionName:l.name};d.height>s&&(s=d.height),te(w=>[...w,d]),l.cellId.x=0,l.cellId.y=0,[...Array(d.height/I).keys()].map(w=>{const y=[];[...Array(d.width/I).keys()].map(p=>{y.push({id:new f({x:p,y:w}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:!0,size:I})}),a.push(y)}),o.push({sectionName:l.name,cells:[...a]}),n.push(l)}$(o),k(n),xe(s),V(e[0]?e[0].name:null),setTimeout(()=>{T(!1)},500)}else{const s=[];for(const o of e)console.log("Generating cells for section",o.name,"at",o.cellId,"with size",o.cellsLong,"x",o.cellsTall),console.log("Needed section Width:",(o.cellsLong+o.cellId.x)*I,"Current width:",t),(o.cellsLong+o.cellId.x)*I>t&&(console.log("Added section Width:",o.cellsLong*I+o.cellId.x),t+=(o.cellsLong+o.cellId.x)*I-t),console.log("Needed section Height:",(o.cellsTall+o.cellId.y)*I,"Current height:",c),(o.cellsTall+o.cellId.y)*I>c&&(console.log("Added section Height:",o.cellsTall*I+o.cellId.y),c+=(o.cellsTall+o.cellId.y)*I-c);ye(t),pe(c),[...Array(c/I).keys()].map(o=>{const n=[];[...Array(t/I).keys()].map(l=>{n.push({id:new f({x:l,y:o}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:q(new f({x:l,y:o}),e)!=null,size:I})}),s.push(n)}),b([...s]),setTimeout(()=>{const o=[],n=[...e];for(const l of n)l.cellElement=document.querySelector(`.App #${l.cellId.toId()}.cell:not(.cell-border)`),o.push(...l.startingItems.map(a=>new R({cell:new f({x:l.cellId.x+a.cell.x,y:l.cellId.y+a.cell.y}),item:new h({id:a.item.id,name:a.item.name,cellsLong:a.item.cellsLong,cellsTall:a.item.cellsTall,icon:a.item.icon,initialElement:document.querySelector(`.App #${a.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:a.item.moveable,rotation:a.item.rotation||0})})));k([...n]);for(const l of o){const a=y=>{const p=y%2===1;return{cellsLong:p?l.item.cellsTall:l.item.cellsLong,cellsTall:p?l.item.cellsLong:l.item.cellsTall}},d=l.item.rotation||0,w=a(d);for(let y=0;y<w.cellsTall;y++)for(let p=0;p<w.cellsLong;p++)s[l.cell.y+y][l.cell.x+p].hasItem=!0,s[l.cell.y+y][l.cell.x+p].itemId=l.item.id;l.item.initialElement=document.querySelector(`.App #${l.cell.toId()}.cell:not(.cell-border)`),E(y=>[...y,l.item])}b([...s]),setTimeout(()=>{T(!1),Oe()},500)},100)}}async function Oe(e,t){T(!0),S(!0),setTimeout(async()=>{const c=document.getElementById("capture"),s=await domtoimage.toPng(c);S(!1),localStorage.setItem("screenshot",s)},500)}async function Ae(){new URLSearchParams(window.location.search);const e=[];let t=localStorage.getItem("screenshotSections");console.log("Screenshot sections from localStorage",t),t=t?.split("LAYOUTSEPARATOR")||"";const c=[];for(const s of t)console.log("Section string",s),c.push(L.fromJSON(s));K([...c]),k([...c.map(s=>new L({name:s.name,cellId:new f({x:s.cellId.x/10,y:s.cellId.y/10}),cellsLong:s.cellsLong/10,cellsTall:s.cellsTall/10,startingItems:s.startingItems,items:s.startingItems.map(o=>new h({id:o.item.id,name:o.item.name,sectionCell:o.cell,cellsLong:o.item.cellsLong,cellsTall:o.item.cellsTall,icon:o.item.icon,moveable:o.item.moveable,starterItem:o.item.starterItem,rotation:o.item.rotation}))}))]),e.push(...c.map(s=>new L({name:s.name,cellId:new f({x:s.cellId.x/10,y:s.cellId.y/10}),cellsLong:s.cellsLong/10,cellsTall:s.cellsTall/10,startingItems:s.startingItems,items:s.startingItems.map(o=>new h({id:o.item.id,name:o.item.name,sectionCell:o.cell,cellsLong:o.item.cellsLong,cellsTall:o.item.cellsTall,icon:o.item.icon,moveable:o.item.moveable,starterItem:o.item.starterItem,rotation:o.item.rotation}))}))),console.log("SECTIONS TO GENERATE",e),De(e)}r.useEffect(()=>{Ae()},[]);function Re(e,t,c){if(!i||e==null)return;const s=[...c],o=[],n=c.find(l=>l.name==e);console.log("NEW SECTION",n),console.log("Adding section",n.name,n.cellId),console.log("MOBILE CELLS",t),n.cellElement=document.querySelector(`.App #${n.name.split(" ").join("-")} #${n.name.split(" ").join("")}${n.cellId.toId()}.cell:not(.cell-border)`),console.log("Section element found",n.cellElement);for(const l of n.startingItems){console.log("Placing starting item",l.item.name,l.cell);const a=y=>{const p=y%2===1;return{cellsLong:p?l.item.cellsTall:l.item.cellsLong,cellsTall:p?l.item.cellsLong:l.item.cellsTall}},d=l.item.rotation||0,w=a(d);for(let y=0;y<w.cellsTall;y++)for(let p=0;p<w.cellsLong;p++){const de=t.find(He=>He.sectionName===n.name);de.cells[l.cell.y+y][l.cell.x+p].hasItem=!0,de.cells[l.cell.y+y][l.cell.x+p].itemId=l.item.id}l.item.initialElement=document.querySelector(`.App #${n.name.split(" ").join("-")} #${n.name.split(" ").join("")}${l.cell.toId()}.cell:not(.cell-border)`),console.log("Adding item to items",l.item.initialElement),o.push(new h({id:l.item.id,name:l.item.name,cellsLong:l.item.cellsLong,cellsTall:l.item.cellsTall,icon:l.item.icon,initialElement:l.item.initialElement,starterItem:!0,moveable:l.item.moveable,rotation:l.item.rotation}))}console.log("Setting sections",s),k([...s]),console.log("ITEMS",o),E(l=>[...l.filter(d=>!o.some(w=>w.id===d.id)),...o.map(d=>new h({id:d.id,name:d.name,cellsLong:d.cellsLong,cellsTall:d.cellsTall,icon:d.icon,initialElement:d.initialElement,starterItem:!0,moveable:d.moveable,rotation:d.rotation}))])}function ce(e){let t=[];return e.map(c=>t=[...t,...c]),t}function ie(e,t){console.log(e);const c=i?x.find(l=>l.sectionName===u).cells:v,s=c[e.y].length,o=c.length;if(console.log(s,o),e.x+t.cellsLong>s||e.y+t.cellsTall>o)return!1;const n=q(e,g);if(!n&&!i)return console.log("Item is out of bounds of any section"),!1;for(let l=0;l<t.cellsTall;l++)for(let a=0;a<t.cellsLong;a++){if(!i){const d=q(new f({x:e.x+a,y:e.y+l}),g);if(!d)return console.log("Item is out of bounds of any section"),!1;if(d.name!=n.name)return console.log("Item is crossing section boundaries"),!1}if(c[e.y+l][e.x+a].hasItem&&c[e.y+l][e.x+a].itemId!=t.id)return console.log("Something is already here"),!1}return!0}function Pe(e,t,c){const s=Array.from(i?x.find(l=>l.sectionName===u).cells:v);if(c!=null){console.log("Removing item");const l=i?g.find(a=>a.name===u):q(c,g);l.items=l.items.filter(a=>a.id!=t.id);for(let a=0;a<t.cellsTall;a++)for(let d=0;d<t.cellsLong;d++)s[c.y+a][c.x+d].hasItem=!1,s[c.y+a][c.x+d].itemId=""}const o=i?g.find(l=>l.name===u):q(e,g),n=new f({x:e.x-o.cellId.x,y:e.y-o.cellId.y});t.sectionCell=n,o.items.push(t);for(let l=0;l<t.cellsTall;l++)for(let a=0;a<t.cellsLong;a++)s[e.y+l][e.x+a].hasItem=!0,s[e.y+l][e.x+a].itemId=t.id;if(console.log(s),i){const l=x.find(a=>a.sectionName===u);l&&(l.cells=s.map(a=>a.map(d=>({...d}))),$([...x]))}else b(s);if(console.log("Removing item from inventory",t.name),!t.hasMoved){const l=W.findIndex(a=>a.item.name==t.name&&!a.item.hasMoved);if(l!==-1){const a=[...W];a[l].quantity-=1,a[l].quantity<=0&&a.splice(l,1),H(a)}else H(W)}E(l=>(console.log("Placing item",t.id),console.log("Updating item",t.id),l.find(a=>a.id==t.id).hasMoved||(l.find(a=>a.id==t.id).hasMoved=!0),l))}function Me(e){P.find(t=>t.name==e.name&&!t.hasMoved&&!t.starterItem)||E(t=>[...t,e])}function me(e){console.log("Removing item",e.id),E(t=>t.filter(c=>c.id!=e.id))}function ke(e,t){const c=Array.from(v),s=l=>{const a=l%2===1;return{cellsWide:a?e.cellsTall:e.cellsLong,cellsTall:a?e.cellsLong:e.cellsTall}},o=e.rotation||0,n=s(o);for(let l=0;l<n.cellsTall;l++)for(let a=0;a<n.cellsWide;a++)c[t.y+l][t.x+a].hasItem=!1,c[t.y+l][t.x+a].itemId="";b(c),console.log("DELETING ITEM",e.id),E(l=>(console.log(),l.filter(a=>a.id!=e.id))),H(l=>{const a=l.findIndex(d=>d.item.name==e.name&&!d.item.hasMoved);if(a!==-1){const d=[...l];return d[a].quantity+=1,d}else return[...l,new fe({item:new h({id:e.id,name:e.name,cellsLong:n.cellsWide,cellsTall:n.cellsTall,icon:e.icon}),quantity:1})]})}function $e(e,t){const c=Array.from(i?x.find(l=>l.sectionName===u).cells:v);console.log("DELETING ITEM ROTATE",e.id,e.rotation);const s=l=>{const a=l%2===1;return{cellsWide:a?e.cellsTall:e.cellsLong,cellsTall:a?e.cellsLong:e.cellsTall}},o=e.rotation||0,n=s(o);for(let l=0;l<n.cellsTall;l++)for(let a=0;a<n.cellsWide;a++)console.log("Deleting cell",t.y+l,t.x+a),c[t.y+l][t.x+a].hasItem=!1,c[t.y+l][t.x+a].itemId="";b([...c]),console.log("DELETING ITEM",e.id)}function Ue(e,t){const c=i?x.find(n=>n.sectionName===u).cells:v,s=Array.from(c);if(c[e.y]==null){re();return}const o=ie(e,t);s.forEach(n=>n.forEach(l=>{l.mouseOver=!1,l.canPlaceItem=!1,l.mouseOverLocation=""}));for(let n=0;n<t.cellsTall;n++)for(let l=0;l<t.cellsLong;l++)e.y+n<s.length&&e.x+l<s[e.y+n].length&&(t.cellsLong===1&&t.cellsTall===1?s[e.y+n][e.x+l].mouseOverLocation="single":t.cellsTall===1?l===0?s[e.y+n][e.x+l].mouseOverLocation="leftFull":l===t.cellsLong-1?s[e.y+n][e.x+l].mouseOverLocation="rightFull":s[e.y+n][e.x+l].mouseOverLocation="middleFull":t.cellsLong===1?n===0?s[e.y+n][e.x+l].mouseOverLocation="topFull":n===t.cellsTall-1?s[e.y+n][e.x+l].mouseOverLocation="bottomFull":s[e.y+n][e.x+l].mouseOverLocation="middleVFull":n===0&&l===0?s[e.y+n][e.x+l].mouseOverLocation="topLeftCorner":n===0&&l===t.cellsLong-1?s[e.y+n][e.x+l].mouseOverLocation="topRightCorner":n===t.cellsTall-1&&l===0?s[e.y+n][e.x+l].mouseOverLocation="bottomLeftCorner":n===t.cellsTall-1&&l===t.cellsLong-1?s[e.y+n][e.x+l].mouseOverLocation="bottomRightCorner":n===0?s[e.y+n][e.x+l].mouseOverLocation="top":n===t.cellsTall-1?s[e.y+n][e.x+l].mouseOverLocation="bottom":l===0?s[e.y+n][e.x+l].mouseOverLocation="left":l===t.cellsLong-1?s[e.y+n][e.x+l].mouseOverLocation="right":s[e.y+n][e.x+l].mouseOverLocation="middle",s[e.y+n][e.x+l].mouseOver=!0,s[e.y+n][e.x+l].canPlaceItem=o);if(i){const n=x.find(l=>l.sectionName===u);n&&(n.cells=s.map(l=>l.map(a=>({...a}))),$([...x])),$(l=>l.map(a=>a.sectionName===u?{...a,cells:s}:a))}else b(s)}function re(){const e=Array.from(i?x.find(t=>t.sectionName===u).cells:v);e.forEach(t=>t.forEach(c=>{c.mouseOver=!1,c.canPlaceItem=!1,c.mouseOverLocation=""})),b(e)}r.useEffect(()=>{Re(u,x,g)},[u]),r.useEffect(()=>{const e=()=>{const t=P.find(c=>c.id===N);console.log("Unselecting item",N),Y(null),t&&(j(c=>[...c,t.id]),console.log("Unselecting item",t.id),setTimeout(()=>{j(c=>c.filter(s=>s!==t.id))},300))};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[N,P]);function Fe(e){Y(null),j(t=>[...t,e]),console.log("Unselecting item",e),setTimeout(()=>{j(t=>t.filter(c=>c!==e))},300)}function qe(e){const t=P.find(c=>c.id===N);console.log("Unselecting item",N),Y(e),t&&(j(c=>[...c,t.id]),console.log("Unselecting item",t.id),setTimeout(()=>{j(c=>c.filter(s=>s!==t.id))},300))}function We(e){H(t=>[...t,e])}return m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"App",children:[m.jsx("h1",{className:"title",children:"LayItOut"}),m.jsx("br",{}),(U||D)&&m.jsxs("div",{className:"template-name-row",children:[m.jsx("label",{htmlFor:"template-name",children:"Template Name:"}),m.jsx("input",{type:"text",id:"template-name",name:"template-name",onChange:e=>je(e.target.value),value:A})]}),O&&m.jsx("div",{className:"design-name-row",children:m.jsxs("label",{htmlFor:"design-name",children:["Design Name: ",X]})}),(U||D)&&m.jsxs("div",{className:"template-creation",children:[m.jsxs("button",{className:"action-btn",onClick:()=>{if(A.trim()==""){alert("Please enter a template name");return}if(B.some(e=>e.name===A&&(D?e.id!==se.id:!0))){alert("Template with this name already exists");return}D?(T(!0),S(!0),setTimeout(async()=>{const e=document.getElementById("capture"),t=await domtoimage.toPng(e);S(!1);const c=B.map(s=>s.id===se.id?(console.log("SECTION",g),new C({name:A,previewImage:t,sections:g.map(o=>new L({name:o.name,cellId:new f({x:s.sections.find(n=>n.name==o.name).cellId.x*(i?20:10),y:s.sections.find(n=>n.name==o.name).cellId.y*(i?20:10)}),cellsLong:o.cellsLong*10,cellsTall:o.cellsTall*10,startingItems:o.items.map(n=>new R({cell:new f({x:n.sectionCell.x,y:n.sectionCell.y}),item:new h({id:n.id,name:n.name,cellsLong:n.cellsLong,cellsTall:n.cellsTall,icon:n.icon,starterItem:!0,moveable:n.moveable,rotation:n.rotation})}))})),id:s.id})):new C({name:s.name,previewImage:s.previewImage,sections:s.sections.map(o=>new L({name:o.name,cellId:new f({x:o.cellId.x*(i?20:10),y:o.cellId.y*(i?20:10)}),cellsLong:o.cellsLong*(i?20:10),cellsTall:o.cellsTall*(i?20:10),startingItems:o.startingItems.map(n=>new R({cell:new f({x:n.cell.x*(i?2:1),y:n.cell.y*(i?2:1)}),item:new h({id:n.item.id,name:n.item.name,cellsLong:n.item.cellsLong*2,cellsTall:n.item.cellsTall*2,icon:n.item.icon,starterItem:n.item.starterItem,moveable:n.item.moveable,rotation:n.item.rotation})}))})),id:s.id}));ue(z,F,c).then(()=>{console.log("Template updated successfully"),T(!1);const s=new URLSearchParams(window.location.search),o=s.get("companyId"),n=s.get("areaId");window.location.href=`/LayItOut/Layout/?companyId=${o}&areaId=${n}&type=view-area`})})):(T(!0),S(!0),setTimeout(async()=>{const e=document.getElementById("capture"),t=await domtoimage.toPng(e);S(!1);const c=new C({name:A,previewImage:t,sections:g.map(o=>new L({name:o.name,cellId:new f({x:M.find(n=>n.name==o.name).cellId.x*20,y:M.find(n=>n.name==o.name).cellId.y*20}),cellsLong:o.cellsLong*10,cellsTall:o.cellsTall*10,startingItems:o.items.map(n=>new R({cell:new f({x:n.sectionCell.x,y:n.sectionCell.y}),item:new h({id:n.id,name:n.name,cellsLong:n.cellsLong,cellsTall:n.cellsTall,icon:n.icon,starterItem:!0,moveable:n.moveable,rotation:n.rotation})}))})),id:A+(Math.random()*1e4).toString()}),s=[...B.map(o=>new C({name:o.name,previewImage:o.previewImage,sections:o.sections.map(n=>new L({name:n.name,cellId:new f({x:n.cellId.x*(i?20:10),y:n.cellId.y*(i?20:10)}),cellsLong:n.cellsLong*(i?20:10),cellsTall:n.cellsTall*(i?20:10),startingItems:n.startingItems.map(l=>new R({cell:new f({x:l.cell.x*(i?2:1),y:l.cell.y*(i?2:1)}),item:new h({id:l.item.id,name:l.item.name,cellsLong:l.item.cellsLong*2,cellsTall:l.item.cellsTall*2,icon:l.item.icon,starterItem:l.item.starterItem,moveable:l.item.moveable,rotation:l.item.rotation})}))})),id:o.id})),c];ue(z,F,s).then(()=>{console.log("Template updated successfully"),T(!1);const o=new URLSearchParams(window.location.search),n=o.get("companyId"),l=o.get("areaId");window.location.href=`/LayItOut/Layout/?companyId=${n}&areaId=${l}&type=view-area`})},500))},children:[U?"Create":"Save"," Template"]}),m.jsx("button",{className:"action-btn",onClick:()=>{be(!1),Le([]),K([]),k([]),$([]),te([]),V(null)},children:"Cancel"})]}),Ne&&m.jsxs("div",{className:"template-creation",children:[m.jsx("button",{className:"action-btn",onClick:()=>{T(!0),S(!0),setTimeout(async()=>{const e=document.getElementById("capture"),t=await domtoimage.toPng(e);S(!1);const c=new Ce({name:X,previewImage:t,areaId:F,sections:g.map(s=>new L({name:s.name,cellId:new f({x:M.find(o=>o.name==s.name).cellId.x*20,y:M.find(o=>o.name==s.name).cellId.y*20}),cellsLong:s.cellsLong*10,cellsTall:s.cellsTall*10,startingItems:s.items.map(o=>new R({cell:new f({x:o.sectionCell.x,y:o.sectionCell.y}),item:new h({id:o.id,name:o.name,cellsLong:o.cellsLong,cellsTall:o.cellsTall,icon:o.icon,starterItem:!0,moveable:o.moveable,rotation:o.rotation})}))})),id:oe});Je(z,F,c).then(()=>{console.log("Design updated successfully"),T(!1)})},500)},children:"Save"}),m.jsx("button",{className:"action-btn",onClick:()=>{},children:"Submit"})]}),Z&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"loader-backdrop"}),m.jsx("div",{className:"loader"})]})," ",m.jsxs("div",{className:"layout",children:[!O&&m.jsx(Ye,{isViewingDesign:O,isEditingTemplate:D,isCreatingTemplate:U,maxHeight:i?200:J,showAddCustomItem:()=>{_.current?.showModal()},addDraggingItem:Me,removeItem:me,inventoryItems:W.map(e=>new fe({item:new h({id:e.item.id,name:e.item.name,cellsLong:e.item.cellsLong,cellsTall:e.item.cellsTall,icon:e.item.icon,displayItem:!0}),quantity:e.quantity}))}),i?m.jsxs("div",{className:"mobile-areas",style:{height:he+"px"},children:[m.jsx("img",{src:Ie,onClick:()=>{const e=g.findIndex(c=>c.name==u);if(e===-1)return;const t=(e-1+g.length)%g.length;V(g[t].name),console.log("Changing viewing section to",g[t].name)},className:"back-mobile-areas"}),ve.map((e,t)=>m.jsx(ge,{width:e.width,height:e.height,cells:ce(x.find(c=>c.sectionName==e.sectionName).cells),id:e.sectionName,visibile:u==null?!0:e.sectionName==u,section:e.sectionName},t)),m.jsx("img",{src:Ie,onClick:()=>{const e=g.findIndex(c=>c.name==u);if(e===-1)return;const t=(e+1)%g.length;V(g[t].name),console.log("Changing viewing section to",g[t].name)},className:"forward-mobile-areas"})]}):m.jsx(ge,{width:ee,height:J,cells:ce(v)})]}),O&&m.jsx("div",{className:"design-view",children:m.jsx("button",{className:"action-btn",onClick:()=>{window.location.href=`/LayItOut/Print/?companyId=${z}&areaId=${F}&designName=${X}&designId=${oe}`},children:"Print"})})]}),m.jsxs("div",{id:ae?"capture":"",children:[g.map(e=>m.jsx(Ve,{takingPhoto:ae,section:e,visible:u==null?!0:e.name==u,cellSize:I},e.cellId.toId())),P.map(e=>m.jsx(ze,{cellSize:I,isViewingDesign:O,removeItem:me,visible:i?!e.hasMoved&&!e.starterItem?!0:u==null?!1:e.starterItem?g.find(t=>t.name==u)?.startingItems.some(t=>t.item.id===e.id):g.find(t=>t.name==u)?.items.some(t=>t.id===e.id):!0,item:e,canPlaceItem:ie,placeItem:Pe,deleteItemRotate:$e,highlightCells:Ue,unHighlightCells:re,deleteItem:ke,isSelected:N===e.id,onSelect:qe,isUnselecting:we.includes(e.id),onDeselect:()=>Fe(e.id)},e.id))]}),i&&!Z&&m.jsx("div",{className:"layout-icon",onClick:()=>{G.current?.showModal(),le(!0),console.log("Showing layout dialog")},children:m.jsx("img",{src:Ge,alt:""})}),!Z&&!(U||D||O)&&m.jsx("div",{className:"template-icon",onClick:()=>{Q.current?.showModal(),ne(!0),console.log("Showing template dialog")},children:m.jsx("img",{src:Ke,alt:""})}),m.jsx(Qe,{isViewingArea:Ee,dialogRef:Q,isOpen:Se,closeDialog:()=>{Q.current?.close(),ne(!1)},templates:B}),m.jsx(Xe,{dialogRef:G,isOpen:Te,closeDialog:()=>{G.current?.close(),le(!1)},layoutSections:M}),m.jsx(Ze,{dialogRef:_,addInventoryItem:We,closeDialog:()=>{_.current?.close()}})]})}

import{c as H,j as c,r as d}from"./index-_mSZXrjJ.js";import{A as U,S as V,D as W,B as z}from"./booth_item-JaGj03SR.js";import{S as x,C as m,I as f,m as T,n as F}from"./firestore-e7Y9lgJc.js";H.createRoot(document.getElementById("root")).render(c.jsx(M,{}));function M(){const[G,J]=d.useState(/Mobi|Android/i.test(navigator.userAgent)),[p,L]=d.useState(0),[y,b]=d.useState(0),[j,S]=d.useState([]),[C,E]=d.useState([]),I=10,[N,w]=d.useState([]),[v,P]=d.useState(""),[B,Y]=d.useState(!0),[D,R]=d.useState([]);function O(o,r){for(const n of r)if(o.x>=n.cellId.x&&o.x<n.cellId.x+n.cellsLong&&o.y>=n.cellId.y&&o.y<n.cellId.y+n.cellsTall)return n;return null}function k(o){let r=p,n=y;const a=[];for(const l of o)console.log("Generating cells for section",l.name,"at",l.cellId,"with size",l.cellsLong,"x",l.cellsTall),console.log("Needed section Width:",l.cellsLong+l.cellId.x,"Current width:",r),l.cellsLong+l.cellId.x>r&&(console.log("Added section Width:",l.cellsLong+l.cellId.x),r+=l.cellsLong+l.cellId.x-r),console.log("Needed section Height:",l.cellsTall+l.cellId.y,"Current height:",n),l.cellsTall+l.cellId.y>n&&(console.log("Added section Height:",l.cellsTall+l.cellId.y),n+=l.cellsTall+l.cellId.y-n);L(r),b(n),[...Array(n).keys()].map(l=>{const t=[];[...Array(r).keys()].map(i=>{t.push({id:new m({x:i,y:l}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:O(new m({x:i,y:l}),o)!=null,size:I})}),a.push(t)}),S([...a]),setTimeout(()=>{const l=[],t=[...o],i=[];for(const e of t)e.cellElement=document.querySelector(`.App #${e.cellId.toId()}.cell:not(.cell-border)`),l.push(...e.startingItems.map(s=>new T({cell:new m({x:e.cellId.x+s.cell.x,y:e.cellId.y+s.cell.y}),item:new f({...s.item,initialElement:document.querySelector(`.App #${s.cell.toId()}.cell:not(.cell-border)`),starterItem:!0})}))),l.push(...e.modifierItems.map(s=>new T({cell:new m({x:e.cellId.x+s.cell.x,y:e.cellId.y+s.cell.y}),item:new f({...s.item,initialElement:document.querySelector(`.App #${s.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:!1})}))),i.push(...e.booths.map(s=>new F({...s,cell:new m({x:e.cellId.x+s.cell.x,y:e.cellId.y+s.cell.y}),initialElement:document.querySelector(`.App #${s.cell.toId()}.cell:not(.cell-border)`)})));w([...t]);for(const e of l){const s=g=>{const u=g%2===1;return{cellsLong:u?e.item.cellsTall:e.item.cellsLong,cellsTall:u?e.item.cellsLong:e.item.cellsTall}},h=e.item.rotation||0,A=s(h);for(let g=0;g<A.cellsTall;g++)for(let u=0;u<A.cellsLong;u++)a[e.cell.y+g][e.cell.x+u].hasItem=!0,a[e.cell.y+g][e.cell.x+u].itemId=e.item.id;e.item.initialElement=document.querySelector(`.App #${e.cell.toId()}.cell:not(.cell-border)`),E(g=>[...g,e.item])}for(const e of i){for(let s=0;s<e.cellsTall;s++)for(let h=0;h<e.cellsLong;h++)a[e.cell.y+s][e.cell.x+h].hasItem=!0,a[e.cell.y+s][e.cell.x+h].itemId=e.id;e.initialElement=document.querySelector(`.App #${e.cell.toId()}.cell:not(.cell-border)`),R(s=>[...s,e])}S([...a]),setTimeout(()=>{window.print(),window.close()},500)},100)}async function q(){const r=new URLSearchParams(window.location.search).get("designName")||"";P(r);const n=[];let a=localStorage.getItem("printSections");console.log("Screenshot sections from localStorage",a),a=a?.split("LAYOUTSEPARATOR")||"";const l=[];for(const t of a)console.log("Section string",t),l.push(x.fromJSON(t));w([...l.map(t=>new x({name:t.name,cellId:new m({x:t.cellId.x,y:t.cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,startingItems:t.startingItems,modifierItems:t.modifierItems,booths:t.booths,items:t.startingItems.map(i=>new f({...i.item,sectionCell:new m({x:i.cell.x,y:i.cell.y})}))}))]),n.push(...l.map(t=>new x({name:t.name,cellId:new m({x:t.cellId.x,y:t.cellId.y}),cellsLong:t.cellsLong,cellsTall:t.cellsTall,startingItems:t.startingItems,modifierItems:t.modifierItems,booths:t.booths,items:t.startingItems.map(i=>new f({...i.item,sectionCell:new m({x:i.cell.x,y:i.cell.y})}))}))),console.log("SECTIONS TO GENERATE",n),k(n)}d.useEffect(()=>{q()},[]);function $(o){let r=[];return o.map(n=>r=[...r,...n]),r}return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"App",children:[B&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"loader-backdrop"}),c.jsx("div",{className:"loader"})]}),c.jsx("div",{className:"layout",children:c.jsx(U,{width:p*I,height:y*I,cells:$(j)})})]}),N.map(o=>c.jsx(V,{takingPhoto:!1,section:o,visible:!0,cellSize:I},o.cellId.toId())),C.map(o=>c.jsx(W,{isPlacingItem:!1,isCreatingArea:!1,isCreatingTemplate:!1,cellSize:I,isViewingDesign:!0,removeItem:()=>{},visible:!0,item:o,canPlaceItem:()=>!1,placeItem:()=>{},deleteItemRotate:()=>{},highlightCells:()=>{},unHighlightCells:()=>{},deleteItem:()=>{},isSelected:!1,onSelect:()=>{},isUnselecting:!1,onDeselect:()=>{}},o.id)),D.map(o=>c.jsx(z,{onAddVendorToBooth:()=>{},canPick:!0,visible:!0,booth:o,isViewingBooth:!1,isSelected:!1,cellSize:I,onSelect:()=>{},isUnselecting:!1,hasPickedBooth:!1,onRemoveVendorFromBooth:()=>{},onDeselect:()=>{},onPickBooth:async r=>{}},o.id)),c.jsxs("div",{className:"print-footer",children:[c.jsx("p",{children:"Printed Layout from LayItOut.com"}),c.jsxs("p",{children:["Design Name: ",v]}),c.jsxs("p",{children:["Generated on: ",new Date().toLocaleString()]})]})]})}

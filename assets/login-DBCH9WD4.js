import{c as F,j as e,r as t}from"./firebase-DaY5S35e.js";import{e as L,u as k}from"./firestore-CkrFhD-A.js";import{l as E,r as U}from"./auth-Dx55bPrE.js";F.createRoot(document.getElementById("root")).render(e.jsx(R,{}));function R(){const[p,l]=t.useState("select"),[r,g]=t.useState(""),[n,h]=t.useState(""),[x,j]=t.useState(""),[c,y]=t.useState(""),[w,v]=t.useState([]),[f,C]=t.useState(!0),[b,d]=t.useState(!1),[P,o]=t.useState(!1);t.useEffect(()=>{async function a(){const s=await L();v(s),console.log(s),C(!1)}a()},[]);async function S(){if(r.trim()===""){alert("Please enter an email address");return}if(n.trim()===""){alert("Please enter a password");return}if(o(!0),!await E(r,n)){alert("Invalid email or password. Please try again."),o(!1);return}const s=w.find(i=>i.users.includes(localStorage.getItem("userId")));if(!s){alert("You are not part of any company. Please contact your administrator."),o(!1);return}localStorage.setItem("companyId",s.id),o(!1);const u=new URLSearchParams(window.location.search).get("redirect");u?window.location.href=u.replace(/~/g,"&"):window.location.href="/"}async function N(){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)){alert("Please enter a valid email address");return}if(n.length<6){alert("Password must be at least 6 characters long");return}if(n!==x){alert("Passwords do not match");return}if(c.trim()===""){alert("Please enter a company code");return}const s=w.find(I=>I.code===c);if(!s){alert("Invalid company code");return}d(!0);const m=await U(r,n);if(m===!1){alert("Error registering user. Please try again."),d(!1);return}s.users.push(m),await k(s),localStorage.setItem("companyId",s.id),d(!1);const i=new URLSearchParams(window.location.search).get("redirect");i?window.location.href=i.replace(/~/g,"&"):window.location.href="/"}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"App",children:[e.jsx("h1",{className:"title",children:"LayItOut"}),e.jsx("div",{className:"login-container",children:p=="select"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Welcome to LayItOut"}),e.jsx("p",{children:"Please select an option to continue"}),e.jsx("button",{className:"action-btn",onClick:()=>l("login"),children:"Login"}),e.jsx("button",{className:"action-btn",onClick:()=>l("signup"),children:"Sign Up"})]}):p=="login"?f?e.jsx("div",{className:"loader"}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Welcome back!"}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"text",id:"email",name:"email",value:r,onChange:a=>g(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"password",children:"Password:"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n,onChange:a=>h(a.target.value)})]}),P?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"action-btn",onClick:S,children:"Login"}),e.jsx("label",{className:"label-btn",onClick:()=>l("select"),children:"Back"})]}):f?e.jsx("div",{className:"loader"}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Sign Up"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"text",id:"email",name:"email",value:r,onChange:a=>g(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"password",children:"Password:"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n,onChange:a=>h(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"confirm-password",children:"Confirm Password:"}),e.jsx("input",{type:"password",id:"confirm-password",name:"confirm-password",value:x,onChange:a=>j(a.target.value)})]}),e.jsxs("div",{className:"login-item-row",children:[e.jsx("label",{htmlFor:"company-code",children:"Company Code:"}),e.jsx("input",{type:"text",id:"company-code",name:"company-code",value:c,onChange:a=>y(a.target.value)})]}),b?e.jsx("div",{className:"loader",children:" "}):e.jsx("button",{className:"action-btn",onClick:N,children:"Sign Up"}),e.jsx("label",{className:"label-btn",onClick:()=>l("select"),children:"Back"})]})})]})})}

import{c as U,j as r,r as i}from"./index-QIV6qY6h.js";import{A as k,S as M,D as q}from"./section-T5K6jlVY.js";import{S as p,C as h,I as f,V as z,W as F,e as $}from"./firestore-Cstgsan0.js";U.createRoot(document.getElementById("root")).render(r.jsx(B,{}));function B(){const[G,V]=i.useState(/Mobi|Android/i.test(navigator.userAgent)),[S,L]=i.useState(0),[x,T]=i.useState(0),[A,y]=i.useState([]),[v,j]=i.useState([]),u=10,[C,w]=i.useState([]),[J,b]=i.useState(""),[X,N]=i.useState(""),[E,R]=i.useState(""),[D,Y]=i.useState(!0);function O(t,c){for(const o of c)if(t.x>=o.cellId.x&&t.x<o.cellId.x+o.cellsLong&&t.y>=o.cellId.y&&t.y<o.cellId.y+o.cellsTall)return o;return null}function P(t){let c=S,o=x;const d=[];for(const e of t)console.log("Generating cells for section",e.name,"at",e.cellId,"with size",e.cellsLong,"x",e.cellsTall),console.log("Needed section Width:",e.cellsLong+e.cellId.x,"Current width:",c),e.cellsLong+e.cellId.x>c&&(console.log("Added section Width:",e.cellsLong+e.cellId.x),c+=e.cellsLong+e.cellId.x-c),console.log("Needed section Height:",e.cellsTall+e.cellId.y,"Current height:",o),e.cellsTall+e.cellId.y>o&&(console.log("Added section Height:",e.cellsTall+e.cellId.y),o+=e.cellsTall+e.cellId.y-o);L(c),T(o),[...Array(o).keys()].map(e=>{const m=[];[...Array(c).keys()].map(l=>{m.push({id:new h({x:l,y:e}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:O(new h({x:l,y:e}),t)!=null,size:u})}),d.push(m)}),y([...d]),setTimeout(()=>{const e=[],m=[...t];for(const l of m)l.cellElement=document.querySelector(`.App #${l.cellId.toId()}.cell:not(.cell-border)`),e.push(...l.startingItems.map(a=>new $({cell:new h({x:l.cellId.x+a.cell.x,y:l.cellId.y+a.cell.y}),item:new f({id:a.item.id,name:a.item.name,cellsLong:a.item.cellsLong,cellsTall:a.item.cellsTall,icon:a.item.icon,initialElement:document.querySelector(`.App #${a.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:a.item.moveable,rotation:a.item.rotation||0})})));w([...m]);for(const l of e){const a=g=>{const I=g%2===1;return{cellsLong:I?l.item.cellsTall:l.item.cellsLong,cellsTall:I?l.item.cellsLong:l.item.cellsTall}},n=l.item.rotation||0,s=a(n);for(let g=0;g<s.cellsTall;g++)for(let I=0;I<s.cellsLong;I++)d[l.cell.y+g][l.cell.x+I].hasItem=!0,d[l.cell.y+g][l.cell.x+I].itemId=l.item.id;l.item.initialElement=document.querySelector(`.App #${l.cell.toId()}.cell:not(.cell-border)`),j(g=>[...g,l.item])}y([...d]),setTimeout(()=>{window.print(),window.close()},500)},100)}async function H(){const t=new URLSearchParams(window.location.search),c=t.get("companyId"),o=t.get("areaId"),d=t.get("designName"),e=t.get("designId");if(!c||!o||!d||!e){alert("Invalid URL parameters");return}b(c),N(o),R(d);const m=[];let l=localStorage.getItem("printSections");console.log("Screenshot sections from localStorage",l),l=l?.split("LAYOUTSEPARATOR")||"";const a=[];for(const n of l)console.log("Section string",n),a.push(p.fromJSON(n));w([...a.map(n=>new p({name:n.name,cellId:new h({x:n.cellId.x,y:n.cellId.y}),cellsLong:n.cellsLong,cellsTall:n.cellsTall,startingItems:n.startingItems,items:n.startingItems.map(s=>new f({id:s.item.id,name:s.item.name,sectionCell:s.cell,cellsLong:s.item.cellsLong,cellsTall:s.item.cellsTall,icon:s.item.icon,moveable:s.item.moveable,starterItem:s.item.starterItem,rotation:s.item.rotation}))}))]),m.push(...a.map(n=>new p({name:n.name,cellId:new h({x:n.cellId.x,y:n.cellId.y}),cellsLong:n.cellsLong,cellsTall:n.cellsTall,startingItems:n.startingItems,items:n.startingItems.map(s=>new f({id:s.item.id,name:s.item.name,sectionCell:s.cell,cellsLong:s.item.cellsLong,cellsTall:s.item.cellsTall,icon:s.item.icon,moveable:s.item.moveable,starterItem:s.item.starterItem,rotation:s.item.rotation}))}))),console.log("SECTIONS TO GENERATE",m),P(m)}i.useEffect(()=>{H();async function t(){const c=z();F("dMjfwNN0XFes0WxUH8h1",c)}t()},[]);function W(t){let c=[];return t.map(o=>c=[...c,...o]),c}return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"App",children:[D&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loader-backdrop"}),r.jsx("div",{className:"loader"})]}),r.jsx("div",{className:"layout",children:r.jsx(k,{width:S*u,height:x*u,cells:W(A)})})]}),C.map(t=>r.jsx(M,{takingPhoto:!1,section:t,visible:!0,cellSize:u},t.cellId.toId())),v.map(t=>r.jsx(q,{cellSize:u,isViewingDesign:!0,removeItem:()=>{},visible:!0,item:t,canPlaceItem:()=>!1,placeItem:()=>{},deleteItemRotate:()=>{},highlightCells:()=>{},unHighlightCells:()=>{},deleteItem:()=>{},isSelected:!1,onSelect:()=>{},isUnselecting:!1,onDeselect:()=>{}},t.id)),r.jsxs("div",{className:"print-footer",children:[r.jsx("p",{children:"Printed Layout from LayItOut.com"}),r.jsxs("p",{children:["Design Name: ",E]}),r.jsxs("p",{children:["Generated on: ",new Date().toLocaleString()]})]})]})}

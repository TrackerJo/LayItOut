import{r as o,j as e}from"./index-QIV6qY6h.js";import{I as k,C as G,T as R,S as L,b as T,s as S,e as v}from"./firestore-FyM7zbDZ.js";import{A as Z,S as P}from"./section-Bs7d8TSU.js";function D({inventoryItem:l,addDraggingItem:p,removeItem:n}){const d=o.useRef(null),u=o.useRef(null),[y,A]=o.useState(12),[b,j]=o.useState(l.item);function w(s){const h=u.current,r=window.getComputedStyle(h),c=document.createElement("span");c.style.font=r.font,c.style.fontSize=s+"px",c.style.fontFamily=r.fontFamily,c.style.fontWeight=r.fontWeight,c.style.position="absolute",c.style.visibility="hidden",c.style.whiteSpace="nowrap",c.textContent=h.textContent,document.body.appendChild(c);const g=c.offsetWidth;return document.body.removeChild(c),g}function C(s){if(u.current){const h=u.current;return w(s-1)>h.offsetWidth&&s-1>8?C(s-1):s-1}return s}return o.useEffect(()=>{setTimeout(()=>{u.current&&A(C(y))},100)},[]),e.jsxs("div",{className:"display",children:[e.jsx("div",{ref:d,id:l.item.id,className:"display-item",style:{width:`${l.item.cellsLong*10}px`,height:`${l.item.cellsTall*10}px`},onMouseDown:s=>{s.preventDefault(),s.stopPropagation(),l.item.initialElement=d.current,l.item.id=l.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",l.item.id,"to initialElement",l.item.initialElement),j(new k({id:l.item.id,cellsLong:l.item.cellsLong,cellsTall:l.item.cellsTall,name:l.item.name,icon:l.item.icon,moveable:l.item.moveable,starterItem:l.item.starterItem,displayItem:l.item.isDisplayItem})),p(l.item)},onTouchStart:s=>{s.preventDefault(),s.stopPropagation(),l.item.initialElement=d.current,l.item.id=l.item.name+(Math.random()*1e4).toString(),console.log("ADDING ITEM",l.item.id,"to initialElement",l.item.initialElement),j(new k({id:l.item.id,cellsLong:l.item.cellsLong,cellsTall:l.item.cellsTall,name:l.item.name,icon:l.item.icon,moveable:l.item.moveable,starterItem:l.item.starterItem,displayItem:l.item.isDisplayItem})),p(l.item)},children:l.item.icon.includes("custom-")?e.jsx("div",{className:"custom-icon",children:e.jsx("div",{children:e.jsx("p",{ref:u,style:{fontSize:`${y}px`},children:l.item.icon.split("custom-")[1]})})}):e.jsx("img",{src:l.item.icon,alt:"icon"})}),e.jsx("p",{children:l.item.name}),e.jsxs("p",{className:"quantity",children:["x",l.quantity]})]})}const W="/LayItOut/assets/plus.circle-Ce3xm00a.png";function H({inventoryItems:l,addDraggingItem:p,maxHeight:n,removeItem:d,showAddCustomItem:u,isCreatingTemplate:y,isEditingTemplate:A,isViewingDesign:b}){return e.jsxs("div",{className:"toolbox",style:{maxHeight:n?`${n}px`:"200px"},children:[l.map(j=>e.jsx(D,{inventoryItem:j,addDraggingItem:p,removeItem:d})),!(y||A||b)&&e.jsx("div",{className:"add-item",onClick:()=>{u()},children:e.jsx("img",{src:W,alt:"Add Item"})})]})}const N="/LayItOut/assets/forward-Drovs4r6.png";function B({dialogRef:l,closeDialog:p,layoutSections:n,isOpen:d}){const[u,y]=o.useState(0),[A,b]=o.useState(0),[j,w]=o.useState([]),[C,s]=o.useState([...n]),h=/Mobi|Android/i.test(navigator.userAgent)?5:10;function r(g){for(const m of C)if(g.x>=m.cellId.x&&g.x<m.cellId.x+m.cellsLong&&g.y>=m.cellId.y&&g.y<m.cellId.y+m.cellsTall)return m;return null}o.useEffect(()=>{if(!d)return;console.log("Layout dialog opened, generating cells and sections",n);const g=[];let m=0,a=0;for(const t of n)console.log("Generating cells for section",t.name,"at",t.cellId,"with size",t.cellsLong,"x",t.cellsTall),console.log("Added section Length:",t.cellsLong*h+t.cellId.x),(t.cellsLong+t.cellId.x)*h>m&&(m+=t.cellsLong*h),(t.cellsTall+t.cellId.y)*h>a&&(a+=t.cellsTall*h);console.log("Current width:",m,"Current height:",a),y(m),b(a),[...Array(a/h).keys()].map(t=>{const i=[];[...Array(m/h).keys()].map(x=>{console.log(r(new G({x,y:t}))!=null?"In section":"Outside section"),i.push({id:new G({x,y:t}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:!1,size:h})}),g.push(i)}),w([...g]),setTimeout(()=>{const t=[...n];for(const i of t)console.log("Adding section",i.name,i.cellId),i.cellElement=document.querySelector(`.layout-dialog #${i.cellId.toId()}.cell:not(.cell-border)`),console.log("Section element found",i.cellElement);console.log("Setting sections",t),s([...t]),w([...g])},100)},[d,n]);function c(g){let m=[];return g.map(a=>m=[...m,...a]),m}return e.jsxs("dialog",{ref:l,className:"layout-dialog",children:[e.jsxs("div",{className:"layout-dialog-div",children:[e.jsx("h2",{children:"Layout"}),e.jsx(Z,{width:u,height:A,cells:c(j)}),e.jsx("br",{}),e.jsx("button",{className:"layout-dialog-close",onClick:p,children:"Close"})]}),C.map(g=>e.jsx(P,{takingPhoto:!1,section:g,visible:!0,cellSize:h},g.cellId.toId()))]})}const M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE2mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTAzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmE2MmM1Y2UxLTIzNTYtNGE3Ny1hNTAwLTViNWJjMjE1MDU3NzwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5VbnRpdGxlZCBkZXNpZ24gLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogIDxwZGY6QXV0aG9yPlNhcmFoIEtlbW1lTmFzaDwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcikgZG9jPURBR3UyeXVFTlpBIHVzZXI9VUFGakdXNnh0Q1EgYnJhbmQ9W0FSQ0hJVkVEXSBGb3J0IFdheW5lIENvbW11bml0eSBTY2hvb2xzIHRlbXBsYXRlPTwveG1wOkNyZWF0b3JUb29sPgogPC9yZGY6RGVzY3JpcHRpb24+CjwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9J3InPz7fMgZvAAADaElEQVR4nO3dO2gTAQDG8e8ujz6k6FBbUeOjKILV4CAiDgWxLqK4KM4dCuLiIIg6OQgibi5OgjgoDhZB7NIiIr6gCFFThIotaSsVtSJtadI87hykiKSNd/Uu9yX3/cZwyV3yv0fukYth27YNoWEGPQHyNwUhoyBkFISMgpBREDIKQkZByCgImajTAa88XMDTDyU/p8VXjTHg0vEGHNgeCXpSKnK8hNRyDADIFYCXI/zvwfESsujInig6N/i7prv+OO/puO6/LmB82kYtHLRzHSSZMNG9y/XTXFkMsjth4rAH4xpIFzE+XQs5tFGnoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMvwelVujU/iiGJy3s3cp9qNwPlEF6D8aDnoTAaJVFRkHIKAgZBSGjIGQUhIyCkFEQMgpCRkHIKAgZymNZfvkxZ+NtpsqXkxrAtnYTqxoMR4OHKsjQaAlDo9W/vndzq4FbvU2Ohg3FKqtzY7CH8TPfnV/GGoolpKcrhp6uWNXHO5Au4tqjvKvnhGIJqSUKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByFAGsSwgm6+N35V7jTLIubs5nLyRxdg3K+hJqTrKIOlJC7kCMDKlIBQW7yRsUk6dv0L4lrkpCBkFIeP6FO67CQslq1j2+I71Jra0qu//ch2kP1VEf6r88XgU6DvbhMa4s8tdZGmezdJrWwxEwvcbTc+5XkIuHIv7fke5MNNKn4yCkFEQMgpCRkHIUH9dujmYx+1nhbLHkwkT5482wKjDXR7qIDNZYCZbfqLqyWwJZ7pttDTVXxHqIMvdanzdGqMuYwDkQby61Xgt0UadTLhmv2XM5Wxc7lvA1E9vL6xYyYUaCgLg4xcLqQzH+XsFAZDcFMHpQzHML3j7up++Wnjh8k9kFARAxARO7PP+N4gD6aLrINqokwlsCUllSrj3qoBihRmoxLFar6rAgjwYKuLNWOVPfHaJvfR6F1iQnq4Ytrcvvca88/z38avVzfW5N15JYEE62kx0tFUOUo8HD/9FG3UyCkJGQcgoCBnPLiX1w/sJC1aVxuWH4c/ud6QM27Ydfdnvvjrv+sXlj8GLzY6Gc7zK2unzHxLXs2TC+WfneAmR6tBsT0ZByCgIGQUhoyBkFISMgpBREDIKQuYX+jTA4JQOFzkAAAAASUVORK5CYII=",J="/LayItOut/assets/template-Cjj8EPhc.png";function z({dialogRef:l,closeDialog:p,templates:n,isOpen:d,isViewingArea:u}){const[y,A]=o.useState([]),[b,j]=o.useState([]),[w,C]=o.useState([]),[s,h]=o.useState(/Mobi|Android/i.test(navigator.userAgent)),[r,c]=o.useState([]),[g,m]=o.useState(!1);return o.useEffect(()=>{if(d&&(console.log("Layout dialog opened, generating cells and sections",n),n.length!==0)){if(n.length==1){c([n[0].name]);return}c(s?[n[0].name]:[n[0].name,n[1].name])}},[d,n]),o.useEffect(()=>{const a=n.filter(t=>r.includes(t.name));console.log("Viewing templates:",r),a.sort((t,i)=>r.indexOf(t.name)-r.indexOf(i.name)),console.log("Generating templates for",a.map(t=>t.name))},[r]),e.jsx(e.Fragment,{children:e.jsx("dialog",{ref:l,className:"template-dialog",children:e.jsxs("div",{className:"template-dialog-div",children:[e.jsx("h2",{children:"Templates"}),e.jsxs("div",{className:"templates",children:[n.length>1&&n.filter(a=>!r.includes(a.name)).length>0&&e.jsx("img",{src:N,onClick:()=>{if(s){const t=(n.findIndex(i=>i.name===r[0])-1+n.length)%n.length;c([n[t].name])}else c(a=>{const i=(n.findIndex(x=>x.name===a[0])-1+n.length)%n.length;return[n[i].name,a[0]]})},className:"back-mobile-areas"}),r.length===0&&e.jsx("div",{className:"no-templates",children:"No templates available"}),r.map(a=>e.jsxs("div",{className:"template",children:[e.jsx("img",{src:n.find(t=>t.name===a).previewImage,alt:a,className:"template-preview"}),e.jsx("h3",{children:a}),e.jsxs("div",{className:"template-actions",children:[e.jsx("button",{className:"template-select-btn",onClick:()=>{if(u){const t=new URLSearchParams(window.location.search),i=t.get("companyId"),x=t.get("areaId");window.location.href=`/LayItOut/Layout/?companyId=${i}&areaId=${x}&type=edit-template&templateId=${n.find(I=>I.name==a).id}`}else{const t=n.find(I=>I.name===a),i=new R({name:t.name,id:t.id,previewImage:t.previewImage,sections:t.sections.map(I=>new L({name:I.name,cellId:new G({x:I.cellId.x*(s?20:10),y:I.cellId.y*(s?20:10)}),cellsLong:I.cellsLong*(s?20:10),cellsTall:I.cellsTall*(s?20:10),startingItems:I.startingItems.map(f=>new T({cell:new G({x:f.cell.x*(s?2:1),y:f.cell.y*(s?2:1)}),item:new k({id:f.item.id,name:f.item.name,icon:f.item.icon,cellsLong:f.item.cellsLong*2,cellsTall:f.item.cellsTall*2,starterItem:f.item.starterItem,moveable:f.item.moveable})}))}))}),x=new URLSearchParams(window.location.search);x.set("templateName",i.name),window.location.search=x.toString()}},children:u?"Edit":"Select"}),u&&e.jsx("button",{className:"action-btn",onClick:()=>{if(g)return;m(!0);const t=n.filter(f=>f.name!==a);t.length==1?c([t[0].name]):t.length==0?c([]):t.length==2&&c(s?[t[0].name]:[t[0].name,t[1].name]);const i=new URLSearchParams(window.location.search),x=i.get("companyId"),I=i.get("areaId");S(x,I,t).then(()=>{m(!1)})},children:"Delete"})]})]})),n.length>1&&n.filter(a=>!r.includes(a.name)).length>0&&e.jsx("img",{src:N,onClick:()=>{if(s){const t=(n.findIndex(i=>i.name===r[0])+1)%n.length;c([n[t].name])}else c(a=>{const i=(n.findIndex(x=>x.name===a[a.length-1])+1)%n.length;return[a[1],n[i].name]})},className:"forward-mobile-areas"})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"action-btn",onClick:()=>{const a=new URLSearchParams(window.location.search),t=a.get("companyId"),i=a.get("areaId");window.location.href=`/LayItOut/Layout/?companyId=${t}&areaId=${i}&type=create-template`},children:"Create new Template"})," ",e.jsx("br",{})]}),e.jsx("br",{}),e.jsx("button",{className:"action-btn",onClick:p,children:"Close"}),g&&d&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"loader"})})]})})})}function U({dialogRef:l,closeDialog:p,addInventoryItem:n}){const[d,u]=o.useState(""),[y,A]=o.useState(1),[b,j]=o.useState(1),[w,C]=o.useState(1);return e.jsx("dialog",{ref:l,className:"custom-item-dialog",children:e.jsxs("div",{className:"custom-item-dialog-div",children:[e.jsx("h2",{children:"Add Custom Item"}),e.jsxs("div",{className:"custom-item-row",children:[e.jsx("label",{htmlFor:"item-name",children:"Name:"}),e.jsx("input",{type:"text",id:"item-name",name:"item-name",onChange:s=>u(s.target.value??""),value:d})]}),e.jsxs("div",{className:"custom-item-row",children:[e.jsx("label",{htmlFor:"item-icon",children:"Count:"}),e.jsx("input",{type:"number",id:"item-count",name:"item-count",min:"1",value:y,onChange:s=>A(parseInt(s.target.value)??1)})]}),e.jsxs("div",{className:"custom-item-row custom-item-size",children:[e.jsx("label",{htmlFor:"item-width",children:"Size (in feet):"}),e.jsx("input",{type:"number",id:"item-width",name:"item-width",min:"1",value:b,onChange:s=>j(parseFloat(s.target.value)??1)}),e.jsx("span",{children:" x "}),e.jsx("input",{type:"number",id:"item-height",name:"item-height",min:"1",value:w,onChange:s=>C(parseFloat(s.target.value)??1)})]}),e.jsx("br",{}),e.jsx("button",{className:"custom-item-dialog-add",onClick:()=>{if(d.trim()===""){alert("Item name cannot be empty");return}const s=new v({quantity:y,item:new k({id:d+(Math.random()*1e4).toString(),name:d,icon:`custom-${d}`,cellsLong:Math.ceil(b),cellsTall:Math.ceil(w),moveable:!0,starterItem:!1,displayItem:!0})});n(s),u(""),A(1),j(1),C(1),p()},children:"Add Item"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"custom-item-dialog-close",onClick:p,children:"Close"})]})})}export{U as A,N as F,M as L,H as T,J as a,z as b,B as c};

import{c as $,j as c,r as g,d as B,S as h,C as I,a as L,I as f,T as A,Q as G,R as Q}from"./firestore-DhivQkY_.js";import{A as V,S as X,D as J}from"./section-DHnegUv1.js";$.createRoot(document.getElementById("root")).render(c.jsx(K,{}));function K(){const[y,Y]=g.useState(/Mobi|Android/i.test(navigator.userAgent)),[T,C]=g.useState(0),[S,N]=g.useState(0),[E,v]=g.useState([]),[D,P]=g.useState([]),m=10,[R,b]=g.useState([]),[Z,H]=g.useState(""),[_,O]=g.useState(""),[W,M]=g.useState(""),[U,ee]=g.useState(!0);function k(n,o){for(const a of o)if(n.x>=a.cellId.x&&n.x<a.cellId.x+a.cellsLong&&n.y>=a.cellId.y&&n.y<a.cellId.y+a.cellsTall)return a;return null}function q(n){let o=T,a=S;const u=[];for(const t of n)console.log("Generating cells for section",t.name,"at",t.cellId,"with size",t.cellsLong,"x",t.cellsTall),console.log("Needed section Width:",(t.cellsLong+t.cellId.x)*m,"Current width:",o),(t.cellsLong+t.cellId.x)*m>o&&(console.log("Added section Width:",t.cellsLong*m+t.cellId.x),o+=(t.cellsLong+t.cellId.x)*m-o),console.log("Needed section Height:",(t.cellsTall+t.cellId.y)*m,"Current height:",a),(t.cellsTall+t.cellId.y)*m>a&&(console.log("Added section Height:",t.cellsTall*m+t.cellId.y),a+=(t.cellsTall+t.cellId.y)*m-a);C(o),N(a),[...Array(a/m).keys()].map(t=>{const p=[];[...Array(o/m).keys()].map(s=>{p.push({id:new I({x:s,y:t}),hasItem:!1,itemId:"",mouseOver:!1,canPlaceItem:!1,mouseOverLocation:"",inSection:k(new I({x:s,y:t}),n)!=null,size:m})}),u.push(p)}),v([...u]),setTimeout(()=>{const t=[],p=[...n];for(const s of p)s.cellElement=document.querySelector(`.App #${s.cellId.toId()}.cell:not(.cell-border)`),t.push(...s.startingItems.map(r=>new L({cell:new I({x:s.cellId.x+r.cell.x,y:s.cellId.y+r.cell.y}),item:new f({id:r.item.id,name:r.item.name,cellsLong:r.item.cellsLong,cellsTall:r.item.cellsTall,icon:r.item.icon,initialElement:document.querySelector(`.App #${r.cell.toId()}.cell:not(.cell-border)`),starterItem:!0,moveable:r.item.moveable,rotation:r.item.rotation||0})})));b([...p]);for(const s of t){const r=e=>{const l=e%2===1;return{cellsLong:l?s.item.cellsTall:s.item.cellsLong,cellsTall:l?s.item.cellsLong:s.item.cellsTall}},w=s.item.rotation||0,x=r(w);for(let e=0;e<x.cellsTall;e++)for(let l=0;l<x.cellsLong;l++)u[s.cell.y+e][s.cell.x+l].hasItem=!0,u[s.cell.y+e][s.cell.x+l].itemId=s.item.id;s.item.initialElement=document.querySelector(`.App #${s.cell.toId()}.cell:not(.cell-border)`),P(e=>[...e,s.item])}v([...u]),setTimeout(()=>{window.print()},500)},100)}async function z(){const n=new URLSearchParams(window.location.search),o=n.get("companyId"),a=n.get("areaId"),u=n.get("areaId")||"",t=n.get("companyId")||"",p=n.get("designName")||"Layout",s=await B(t,u);o&&H(o),a&&O(a),M(p);const r=[],w=[];for(const e of s.templates){const l=[],j=[];for(const d of e.sections)l.push(new h({name:d.name,cellId:new I({x:d.cellId.x/(y?20:10),y:d.cellId.y/(y?20:10)}),cellsLong:d.cellsLong/(y?20:10),cellsTall:d.cellsTall/(y?20:10),startingItems:d.startingItems.map(i=>new L({cell:new I({x:i.cell.x/(y?2:1),y:i.cell.y/(y?2:1)}),item:new f({id:i.item.id,name:i.item.name,cellsLong:i.item.cellsLong/2,cellsTall:i.item.cellsTall/2,icon:i.item.icon,starterItem:!0,moveable:i.item.moveable})}))})),j.push(new h({name:d.name,cellId:new I({x:d.cellId.x,y:d.cellId.y}),cellsLong:d.cellsLong,cellsTall:d.cellsTall,startingItems:d.startingItems.map(i=>new L({cell:new I({x:i.cell.x,y:i.cell.y}),item:new f({id:i.item.id,name:i.item.name,cellsLong:i.item.cellsLong,cellsTall:i.item.cellsTall,icon:i.item.icon,starterItem:!0,moveable:i.item.moveable})}))}));r.push(new A({name:e.name,sections:l,id:e.id})),w.push(new A({name:e.name,sections:j,id:e.id}))}const x=[];b([...s.sections.map(e=>new h({name:e.name,cellId:new I({x:e.cellId.x/10,y:e.cellId.y/10}),cellsLong:e.cellsLong/10,cellsTall:e.cellsTall/10,startingItems:e.startingItems,items:e.startingItems.map(l=>new f({id:l.item.id,name:l.item.name,sectionCell:l.cell,cellsLong:l.item.cellsLong,cellsTall:l.item.cellsTall,icon:l.item.icon,moveable:l.item.moveable,starterItem:l.item.starterItem,rotation:l.item.rotation}))}))]),x.push(...s.sections.map(e=>new h({name:e.name,cellId:new I({x:e.cellId.x/10,y:e.cellId.y/10}),cellsLong:e.cellsLong/10,cellsTall:e.cellsTall/10,startingItems:e.startingItems,items:e.startingItems.map(l=>new f({id:l.item.id,name:l.item.name,sectionCell:l.cell,cellsLong:l.item.cellsLong,cellsTall:l.item.cellsTall,icon:l.item.icon,moveable:l.item.moveable,starterItem:l.item.starterItem,rotation:l.item.rotation}))}))),console.log("SECTIONS TO GENERATE",x),q(x)}g.useEffect(()=>{z();async function n(){const o=G();Q("dMjfwNN0XFes0WxUH8h1",o)}n()},[]);function F(n){let o=[];return n.map(a=>o=[...o,...a]),o}return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"App",children:[c.jsx("h1",{className:"title",children:"LayItOut"}),c.jsx("br",{}),U&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"loader-backdrop"}),c.jsx("div",{className:"loader"})]})," ",c.jsx("div",{className:"layout",children:c.jsx(V,{width:T,height:S,cells:F(E)})})]}),R.map(n=>c.jsx(X,{section:n,visible:!0,cellSize:m},n.cellId.toId())),D.map(n=>c.jsx(J,{cellSize:m,isViewingDesign:!0,removeItem:()=>{},visible:!0,item:n,canPlaceItem:()=>!1,placeItem:()=>{},deleteItemRotate:()=>{},highlightCells:()=>{},unHighlightCells:()=>{},deleteItem:()=>{},isSelected:!1,onSelect:()=>{},isUnselecting:!1,onDeselect:()=>{}},n.id)),c.jsxs("div",{className:"print-footer",children:[c.jsx("p",{children:"Printed Layout from LayItOut.com"}),c.jsxs("p",{children:["Design Name: ",W]}),c.jsxs("p",{children:["Generated on: ",new Date().toLocaleString()]})]})]})}
